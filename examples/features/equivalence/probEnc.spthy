theory probEnc 
begin

/*
 * Protocol:	Probabilistic encryption
 * Modeler: 	Jannik Dreier, Ralf Sasse
 * Date: 	April 2015
 *
 * Status: 	working
 */

functions: penc/3, pdec/2, pk/1

equations: pdec(penc(m,pk(k),r), k) = m

rule gen:
  [ Fr(~k) ]
--[ ]->
  [ !Key(~k), Out(pk(~k)) ]

rule enc:
  [ !Key(k), Fr(~r1), Fr(~r2), In(x) ]
--[ ]->
  [ Out(diff(~r1, penc(x, pk(k), ~r2))) ]

end

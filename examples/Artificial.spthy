theory Example_for_CSF_12
begin

rule Step1:
  [ Fr(~x), Fr(~k) ] 
  --> 
  [ St(~x, ~k), Out(senc{~x}~k), Key(~k) ]

rule Step2:
  [ St(x, k), In(<x,x>) ] 
  --[ Fin(x, k) ]-> 
  [ ]

rule Reveal_key:
    [ Key(k) ]
  --[ Rev(k) ]->
    [ Out(k) ]

lemma Characterize_Fin:
  "not( Ex k S #i.  Fin(S, k) @ i )
  "

end

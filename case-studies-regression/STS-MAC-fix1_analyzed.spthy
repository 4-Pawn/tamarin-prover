theory STS_MAC_FIX1 begin

 builtin: diffie-hellman

section{* Finite Variants of the Intruder Rules *}

 rule (modulo AC) isend:
    [ !KU( f_, x ) ] --[ K( x ) ]-> [ In( x ) ]
 
 rule (modulo AC) fst:
    [ !KD( f_.3, <x.1, x.2> ) ] --> [ !KD( f_.4, x.1 ) ]
 
 rule (modulo AC) snd:
    [ !KD( f_.3, <x.1, x.2> ) ] --> [ !KD( f_.4, x.2 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^x.4 ), !KU( f_.2, x.1 ) ]
   -->
    [ !KD( 'exp', x.3^(x.1*x.4) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^x.3 ), !KU( f_.2, inv(x.3) ) ]
   -->
    [ !KD( 'exp', x.4 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^inv(x.3) ), !KU( f_.2, x.3 ) ]
   -->
    [ !KD( 'exp', x.4 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^inv(x.5) ), !KU( f_.2, inv(x.3) ) ]
   -->
    [ !KD( 'exp', x.4^inv((x.3*x.5)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^inv((x.3*x.5)) ), !KU( f_.2, x.3 ) ]
   -->
    [ !KD( 'exp', x.4^inv(x.5) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^(x.3*x.5) ), !KU( f_.2, inv(x.3) ) ]
   -->
    [ !KD( 'exp', x.4^x.5 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^(x.5*inv(x.3)) ), !KU( f_.2, x.3 ) ]
   -->
    [ !KD( 'exp', x.4^x.5 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^x.4 ), !KU( f_.2, inv((x.4*x.5)) ) ]
   -->
    [ !KD( 'exp', x.3^inv(x.5) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^x.4 ), !KU( f_.2, (x.5*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.3^x.5 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^inv(x.4) ), !KU( f_.2, (x.3*x.4) ) ]
   -->
    [ !KD( 'exp', x.5^x.3 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^(x.5*inv(x.6)) ), !KU( f_.2, inv(x.3) ) ]
   -->
    [ !KD( 'exp', x.4^(x.5*inv((x.3*x.6))) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^inv(x.4) ), !KU( f_.2, (x.5*inv(x.6)) ) ]
   -->
    [ !KD( 'exp', x.3^(x.5*inv((x.4*x.6))) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.4^(x.5*inv((x.3*x.6))) ), !KU( f_.2, x.3 ) ]
   -->
    [ !KD( 'exp', x.4^(x.5*inv(x.6)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^inv((x.4*x.6)) ), !KU( f_.2, (x.3*x.4) ) ]
   -->
    [ !KD( 'exp', x.5^(x.3*inv(x.6)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.4*x.6) ), !KU( f_.2, inv((x.3*x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^(x.6*inv(x.3)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.4*x.6) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^(x.3*x.6) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.6*inv(x.4)) ), !KU( f_.2, (x.3*x.4) ) ]
   -->
    [ !KD( 'exp', x.5^(x.3*x.6) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^x.4 ), !KU( f_.2, (x.5*inv((x.4*x.6))) ) ]
   -->
    [ !KD( 'exp', x.3^(x.5*inv(x.6)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.6*inv(x.7)) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^((x.3*x.6)*inv((x.4*x.7))) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.4*inv(x.3)) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.4*inv(x.6)) ), !KU( f_.2, inv((x.3*x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^inv((x.3*x.6)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^inv((x.3*x.6)) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^inv((x.4*x.6)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.6*inv((x.4*x.7))) ), !KU( f_.2, (x.3*x.4) ) ]
   -->
    [ !KD( 'exp', x.5^((x.3*x.6)*inv(x.7)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^(x.4*x.5) ), !KU( f_.2, (x.6*inv((x.5*x.7))) ) ]
   -->
    [ !KD( 'exp', x.3^((x.4*x.6)*inv(x.7)) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^((x.4*x.6)*inv(x.3)) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^x.6 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.6^(x.5*inv(x.4)) ), !KU( f_.2, ((x.3*x.4)*inv(x.5)) ) ]
   -->
    [ !KD( 'exp', x.6^x.3 ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^((x.4*x.6)*inv(x.7)) ), !KU( f_.2, inv((x.3*x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^(x.6*inv((x.3*x.7))) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.6^inv((x.4*x.7)) ), !KU( f_.2, ((x.3*x.4)*inv(x.5)) ) ]
   -->
    [ !KD( 'exp', x.6^(x.3*inv((x.5*x.7))) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.4*inv((x.3*x.6))) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^inv(x.6) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^(x.4*inv(x.5)) ), !KU( f_.2, (x.5*inv((x.4*x.6))) ) ]
   -->
    [ !KD( 'exp', x.3^inv(x.6) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.3^(x.4*inv(x.5)) ), !KU( f_.2, (x.6*inv((x.4*x.7))) ) ]
   -->
    [ !KD( 'exp', x.3^(x.6*inv((x.5*x.7))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^((x.5*x.7)*inv(x.4)) ),
    !KU( f_.2, ((x.3*x.4)*inv(x.5)) )
    ]
   -->
    [ !KD( 'exp', x.6^(x.3*x.7) ) ]
 
 rule (modulo AC) exp:
    [ !KD( 'noexp', x.5^(x.6*inv((x.3*x.7))) ), !KU( f_.2, (x.3*inv(x.4)) ) ]
   -->
    [ !KD( 'exp', x.5^(x.6*inv((x.4*x.7))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.3^(x.4*inv(x.5)) ),
    !KU( f_.2, ((x.5*x.6)*inv((x.4*x.7))) )
    ]
   -->
    [ !KD( 'exp', x.3^(x.6*inv(x.7)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.5^((x.4*x.6)*inv((x.3*x.7))) ),
    !KU( f_.2, (x.3*inv(x.4)) )
    ]
   -->
    [ !KD( 'exp', x.5^(x.6*inv(x.7)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^(x.5*inv((x.4*x.7))) ),
    !KU( f_.2, ((x.3*x.4)*inv(x.5)) )
    ]
   -->
    [ !KD( 'exp', x.6^(x.3*inv(x.7)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^((x.5*x.7)*inv(x.3)) ),
    !KU( f_.2, (x.3*inv((x.4*x.5))) )
    ]
   -->
    [ !KD( 'exp', x.6^(x.7*inv(x.4)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^((x.5*x.7)*inv(x.8)) ),
    !KU( f_.2, (x.3*inv((x.4*x.5))) )
    ]
   -->
    [ !KD( 'exp', x.6^((x.3*x.7)*inv((x.4*x.8))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^(x.7*inv((x.4*x.8))) ),
    !KU( f_.2, ((x.3*x.4)*inv(x.5)) )
    ]
   -->
    [ !KD( 'exp', x.6^((x.3*x.7)*inv((x.5*x.8))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^(x.5*inv((x.3*x.7))) ),
    !KU( f_.2, (x.3*inv((x.4*x.5))) )
    ]
   -->
    [ !KD( 'exp', x.6^inv((x.4*x.7)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.3^((x.4*x.5)*inv(x.6)) ),
    !KU( f_.2, ((x.6*x.7)*inv((x.5*x.8))) )
    ]
   -->
    [ !KD( 'exp', x.3^((x.4*x.7)*inv(x.8)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^((x.5*x.7)*inv((x.4*x.8))) ),
    !KU( f_.2, ((x.3*x.4)*inv(x.5)) )
    ]
   -->
    [ !KD( 'exp', x.6^((x.3*x.7)*inv(x.8)) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.7^(x.6*inv((x.4*x.8))) ),
    !KU( f_.2, ((x.3*x.4)*inv((x.5*x.6))) )
    ]
   -->
    [ !KD( 'exp', x.7^(x.3*inv((x.5*x.8))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.6^((x.5*x.7)*inv((x.3*x.8))) ),
    !KU( f_.2, (x.3*inv((x.4*x.5))) )
    ]
   -->
    [ !KD( 'exp', x.6^(x.7*inv((x.4*x.8))) ) ]
 
 rule (modulo AC) exp:
    [
    !KD( 'noexp', x.7^((x.6*x.8)*inv((x.4*x.9))) ),
    !KU( f_.2, ((x.3*x.4)*inv((x.5*x.6))) )
    ]
   -->
    [ !KD( 'exp', x.7^((x.3*x.8)*inv((x.5*x.9))) ) ]
 
 rule (modulo AC) inv:
    [ !KD( f_.1, inv(x.2) ) ] --> [ !KD( 'noexp', x.2 ) ]
 
 rule (modulo AC) fst:
    [ !KU( f_.1, x ) ] --> [ !KU( 'noexp', fst(x) ) ]
 
 rule (modulo AC) h:
    [ !KU( f_.1, x ) ] --> [ !KU( 'noexp', h(x) ) ]
 
 rule (modulo AC) mac:
    [ !KU( f_.2, x ), !KU( f_.3, x.1 ) ] --> [ !KU( 'noexp', mac(x, x.1) ) ]
 
 rule (modulo AC) pair:
    [ !KU( f_.2, x ), !KU( f_.3, x.1 ) ] --> [ !KU( 'noexp', <x, x.1> ) ]
 
 rule (modulo AC) pk:
    [ !KU( f_.1, x ) ] --> [ !KU( 'noexp', pk(x) ) ]
 
 rule (modulo AC) sign:
    [ !KU( f_.2, x ), !KU( f_.3, x.1 ) ] --> [ !KU( 'noexp', sign(x, x.1) ) ]
 
 rule (modulo AC) snd:
    [ !KU( f_.1, x ) ] --> [ !KU( 'noexp', snd(x) ) ]
 
 rule (modulo AC) true:
    [ ] --> [ !KU( 'noexp', true() ) ]
 
 rule (modulo AC) verify:
    [ !KU( f_.3, x ), !KU( f_.4, x.1 ), !KU( f_.5, x.2 ) ]
   -->
    [ !KU( 'noexp', verify(x, x.1, x.2) ) ]
 
 rule (modulo AC) coerce:
    [ !KD( f_, x ) ] --> [ !KU( f_, x ) ]
 
 rule (modulo AC) pub:
    [ ] --> [ !KU( f_, $x ) ]
 
 rule (modulo AC) fresh:
    [ Fr( ~x ) ] --> [ !KU( f_, ~x ) ]
 
 rule (modulo AC) exp:
    [ !KU( 'noexp', x ), !KU( f_.2, x.1 ) ] --> [ !KU( 'exp', x^x.1 ) ]
 
 rule (modulo AC) inv:
    [ !KU( f_.1, x ) ] --> [ !KU( 'noexp', inv(x) ) ]

section{* The Station-To-Station Protocol (MAC version, fix UKS attack with proof-of-possession of exponent) *}

rule (modulo E) Register_pk_normal:
   [ Fr( ~ltk ) ]
  -->
   [ !Ltk( $A, ~ltk ), !Pk( $A, pk(~ltk) ), Out( pk(~ltk) ) ]
  /* has exactly the trivial AC variant */

rule (modulo E) Register_pk_evil:
   [ In( ltk ) ]
  --[ Corrupt( $E ) ]->
   [ !Ltk( $E, ltk ), !Pk( $E, pk(ltk) ), Out( pk(ltk) ) ]
  /* has exactly the trivial AC variant */

rule (modulo E) Init_1:
   [ Fr( ~ekI ), !Ltk( $I, ~ltkI ) ]
  -->
   [ Init_1( $I, $R, ~ltkI, ~ekI ), Out( <$I, $R, 'g'^~ekI> ) ]
  /* has exactly the trivial AC variant */

rule (modulo E) Init_2:
   [
   Init_1( $I, $R, ~ltkI, ~ekI ), !Pk( $R, pk(~ltkR) ),
   In( <$R, $I, Y, sign(<Y, 'g'^~ekI>, ~ltkR), 
        mac(Y^~ekI, sign(<Y, 'g'^~ekI>, ~ltkR))>
   )
   ]
  --[ AcceptedI( ~ekI, $I, $R, 'g'^~ekI, Y, h(Y^~ekI) ) ]->
   [
   Out( <$I, $R, sign(<'g'^~ekI, Y>, ~ltkI), 
         mac(Y^~ekI, sign(<'g'^~ekI, Y>, ~ltkI))>
   ),
   !SessionKey( ~ekI, $I, $R, h(Y^~ekI) )
   ]
  /*
  rule (modulo AC) Init_2:
     [
     Init_1( $I.3, $R.4, ~ltkI.5, ~ekI ), !Pk( $R.4, pk(~x.6) ),
     In( <$R.4, $I.3, Y.1, sign(<Y.1, 'g'^~ekI>, ~x.6), 
          mac(x.2, sign(<Y.1, 'g'^~ekI>, ~x.6))>
     )
     ]
    --[ AcceptedI( ~ekI, $I.3, $R.4, 'g'^~ekI, Y.1, h(x.2) ) ]->
     [
     Out( <$I.3, $R.4, sign(<'g'^~ekI, Y.1>, ~ltkI.5), 
           mac(x.2, sign(<'g'^~ekI, Y.1>, ~ltkI.5))>
     ),
     !SessionKey( ~ekI, $I.3, $R.4, h(x.2) )
     ]
  
    variants (modulo AC)
    1. ~ekI  = ~ekI.74
       Y.1   = Y.75
       x.2   = Y.75^~ekI.74
    
    2. ~ekI  = ~ekI.74
       Y.1   = x.75^inv(~ekI.74)
       x.2   = x.75
    
    3. ~ekI  = ~ekI.75
       Y.1   = x.76^x.77
       x.2   = x.76^(~ekI.75*x.77)
    
    4. ~ekI  = ~ekI.75
       Y.1   = x.76^inv((~ekI.75*x.77))
       x.2   = x.76^inv(x.77)
    
    5. ~ekI  = ~ekI.75
       Y.1   = x.76^(x.77*inv(~ekI.75))
       x.2   = x.76^x.77
    
    6. ~ekI  = ~ekI.76
       Y.1   = x.77^(x.78*inv((~ekI.76*x.79)))
       x.2   = x.77^(x.78*inv(x.79))
  */

rule (modulo E) Resp_1:
   [ !Ltk( $R, ~ltkR ), Fr( ~ekR ), In( <$I, $R, X> ) ]
  -->
   [
   Resp_1( $I, $R, ~ltkR, ~ekR, X ),
   Out( <$R, $I, 'g'^~ekR, sign(<'g'^~ekR, X>, ~ltkR), 
         mac(X^~ekR, sign(<'g'^~ekR, X>, ~ltkR))>
   )
   ]
  /*
  rule (modulo AC) Resp_1:
     [ !Ltk( $R.3, ~ltkR.4 ), Fr( ~ekR ), In( <$I.5, $R.3, X.1> ) ]
    -->
     [
     Resp_1( $I.5, $R.3, ~ltkR.4, ~ekR, X.1 ),
     Out( <$R.3, $I.5, 'g'^~ekR, sign(<'g'^~ekR, X.1>, ~ltkR.4), 
           mac(x.2, sign(<'g'^~ekR, X.1>, ~ltkR.4))>
     )
     ]
  
    variants (modulo AC)
    1. ~ekR  = ~ekR.47
       X.1   = X.48
       x.2   = X.48^~ekR.47
    
    2. ~ekR  = ~ekR.47
       X.1   = x.48^inv(~ekR.47)
       x.2   = x.48
    
    3. ~ekR  = ~ekR.48
       X.1   = x.49^x.50
       x.2   = x.49^(~ekR.48*x.50)
    
    4. ~ekR  = ~ekR.48
       X.1   = x.49^inv((~ekR.48*x.50))
       x.2   = x.49^inv(x.50)
    
    5. ~ekR  = ~ekR.48
       X.1   = x.49^(x.50*inv(~ekR.48))
       x.2   = x.49^x.50
    
    6. ~ekR  = ~ekR.49
       X.1   = x.50^(x.51*inv((~ekR.49*x.52)))
       x.2   = x.50^(x.51*inv(x.52))
  */

rule (modulo E) Resp_2:
   [
   !Pk( $I, pk(~ltkI) ), Resp_1( $I, $R, ~ltkR, ~ekR, X ),
   In( <$I, $R, sign(<X, 'g'^~ekR>, ~ltkI), 
        mac(X^~ekR, sign(<X, 'g'^~ekR>, ~ltkI))>
   )
   ]
  --[ AcceptedR( ~ekR, $I, $R, X, 'g'^~ekR, h(X^~ekR) ) ]->
   [ !SessionKey( ~ekR, $I, $R, h(X^~ekR) ) ]
  /*
  rule (modulo AC) Resp_2:
     [
     !Pk( $I.3, pk(~x.4) ), Resp_1( $I.3, $R.5, ~ltkR.6, ~ekR, X.1 ),
     In( <$I.3, $R.5, sign(<X.1, 'g'^~ekR>, ~x.4), 
          mac(x.2, sign(<X.1, 'g'^~ekR>, ~x.4))>
     )
     ]
    --[ AcceptedR( ~ekR, $I.3, $R.5, X.1, 'g'^~ekR, h(x.2) ) ]->
     [ !SessionKey( ~ekR, $I.3, $R.5, h(x.2) ) ]
  
    variants (modulo AC)
    1. ~ekR  = ~ekR.45
       X.1   = X.46
       x.2   = X.46^~ekR.45
    
    2. ~ekR  = ~ekR.45
       X.1   = x.46^inv(~ekR.45)
       x.2   = x.46
    
    3. ~ekR  = ~ekR.46
       X.1   = x.47^x.48
       x.2   = x.47^(~ekR.46*x.48)
    
    4. ~ekR  = ~ekR.46
       X.1   = x.47^inv((~ekR.46*x.48))
       x.2   = x.47^inv(x.48)
    
    5. ~ekR  = ~ekR.46
       X.1   = x.47^(x.48*inv(~ekR.46))
       x.2   = x.47^x.48
    
    6. ~ekR  = ~ekR.47
       X.1   = x.48^(x.49*inv((~ekR.47*x.50)))
       x.2   = x.48^(x.49*inv(x.50))
  */

rule (modulo E) Sessionkey_Reveal:
   [ !SessionKey( ~tid, $I, $R, k ) ] --[ SesskRev( ~tid ) ]-> [ Out( k ) ]
  /* has exactly the trivial AC variant */

lemma (modulo E) KI_Perfect_Forward_Secrecy_I:
  "not(Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
        (((((AcceptedI( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
            (not(Ex #r.8. Corrupt( I.1 ) @ #r.8))) &
           (not(Ex #r.9. Corrupt( R.2 ) @ #r.9))) &
          (K( sessKey.3 ) @ #k.5)) &
         (not(Ex #i3.10. SesskRev( ttest ) @ #i3.10))) &
        (not(Ex #i3.11 #i4.12 tpartner.13 kpartner.14.
              (SesskRev( tpartner.13 ) @ #i3.11) &
              (AcceptedR( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14
               ) @ #i4.12))))"
/* proof based on the same lemma modulo AC */
/*
doubly-guarded formula characterizing all attacks:
"Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
  (AcceptedI( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
  (K( sessKey.3 ) @ #k.5)
 &
  (All #r.8. (Corrupt( I.1 ) @ #r.8) ==> F) &
  (All #r.9. (Corrupt( R.2 ) @ #r.9) ==> F) &
  (All #i3.10. (SesskRev( ttest ) @ #i3.10) ==> F) &
  (All #i3.11 #i4.12 tpartner.13 kpartner.14.
    (SesskRev( tpartner.13 ) @ #i3.11) &
    (AcceptedR( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14 ) @ #i4.12)
   ==>
    F)"
*/
/*
proof by induction possible over the formula:
"(Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
   (AcceptedI( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
   (K( sessKey.3 ) @ #k.5)
  &
   (All #r.8. (Corrupt( I.1 ) @ #r.8) ==> F) &
   (All #r.9. (Corrupt( R.2 ) @ #r.9) ==> F) &
   (All #i3.10. (SesskRev( ttest ) @ #i3.10) ==> F) &
   (All #i3.11 #i4.12 tpartner.13 kpartner.14.
     (SesskRev( tpartner.13 ) @ #i3.11) &
     (AcceptedR( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14 ) @ #i4.12)
    ==>
     F)) &
 (All ttest.15 I.16 R.17 sessKey.18 #i1.19 #k.20 hki.21 hkr.22.
   (AcceptedI( ttest.15, I.16, R.17, hki.21, hkr.22, sessKey.18
    ) @ #i1.19) &
   (K( sessKey.18 ) @ #k.20)
  ==>
   (Last(#k.20)) |
   (Last(#i1.19)) |
   (Ex #r.23. (Corrupt( I.16 ) @ #r.23) & All. (Last(#r.23)) ==> F) |
   (Ex #r.24. (Corrupt( R.17 ) @ #r.24) & All. (Last(#r.24)) ==> F) |
   (Ex #i3.25.
     (SesskRev( ttest.15 ) @ #i3.25)
    &
     All. (Last(#i3.25)) ==> F) |
   (Ex #i3.26 #i4.27 tpartner.28 kpartner.29.
     (SesskRev( tpartner.28 ) @ #i3.26) &
     (AcceptedR( tpartner.28, I.16, R.17, hki.21, hkr.22, kpartner.29
      ) @ #i4.27)
    &
     (All. (Last(#i4.27)) ==> F) & (All. (Last(#i3.26)) ==> F)))"
*/
simplify
solve( (#i1.4, 0)[Init_1( $I.11, $R.12, ~ltkI.13, ~ekI.8 )] )
  case Init_1_case_1
  solve( (#i1.4, 1)[!Pk( $R.12, pk(~x.14) )] )
    case Register_pk_evil
    by contradiction // from formulas
  next
    case Register_pk_normal
    solve( KU((#vf.15, 0), mac(x.10, sign(<hkr.7, 'g'^~ekI.8>, ~x.14))) )
      case Init_2_case_1
      solve( KU((#vf.51, 0), mac(x.86^x.87,
                                 sign(<'g'^~ekI.8, 'g'^~ekI.43>, ~x.50))) )
        case Init_2
        by contradiction // cyclic
      next
        case mac
        solve( (#vr.91, 1)[!KU( f_.93, sign(<'g'^~ekI.8, 'g'^~ekI.43>, ~x.50)
                           )] )
          case Init_2
          by contradiction // cyclic
        next
          case sign
          by solve( (#vr.99, 1)[!KU( f_.101, ~x.50 )] )
        qed
      qed
    next
      case Init_2_case_2
      by solve( (#vf.63, 0)[!KU( f_.64, ~x.14 )] )
    next
      case Init_2_case_3
      solve( (#vf.61, 0)[!KU( f_.62, ~x.50 )] )
        case fresh
        solve( KU((#vf.51, 0), mac(x.87^x.88,
                                   sign(<'g'^~ekI.8, 'g'^~ekI.43>, ~x.50))) )
          case mac
          solve( (#vr.98, 1)[!KU( f_.100, sign(<'g'^~ekI.8, 'g'^~ekI.43>, ~x.50)
                             )] )
            case sign
            solve( splitEqs(1) )
              case split
              solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekI.111*~ekI.112)) )] )
                case Sessionkey_Reveal_case_1
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.186 )] )
                next
                  case Init_1_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.185 )] )
                next
                  case exp
                  solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                              sign(<x.149^x.150, 'g'^~tid.118>, ~x.123))) )
                    case Init_2_case_1
                    by solve( KU((#vr.154, 1), ~ekI.111) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.182, 0)[!KU( f_.183, ~x.123 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                      case fresh
                      by solve( KU((#vr.154, 1), ~ekI.111) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                      case fresh
                      by solve( (#vf.183, 0)[!KU( f_.184, ~x.123 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.154, 1), ~ekI.111) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.180, 0)[!KU( f_.181, ~x.123 )] )
                  next
                    case mac
                    solve( (#vr.161, 1)[!KU( f_.163,
                                             sign(<x.149^x.150, 'g'^~tid.118>, ~x.123)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.154, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.191, 0)[!KU( f_.192, ~x.123 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                        case fresh
                        by solve( KU((#vr.154, 1), ~ekI.111) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                        case fresh
                        by solve( (#vf.192, 0)[!KU( f_.193, ~x.123 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.154, 1), ~ekI.111) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.189, 0)[!KU( f_.190, ~x.123 )] )
                    next
                      case sign
                      by solve( (#vr.169, 1)[!KU( f_.171, ~x.123 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_2
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.132, 0)[!KU( f_.133, ~ltkI.122 )] )
                    case fresh
                    by solve( (#vr.167, 1)[!KU( f_.168, ~ekI.187 )] )
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.132, 0)[!KU( f_.133, ~ltkI.122 )] )
                    case fresh
                    by solve( (#vr.167, 1)[!KU( f_.168, ~ekI.186 )] )
                  qed
                next
                  case exp
                  solve( (#vf.132, 0)[!KU( f_.133, ~ltkI.122 )] )
                    case fresh
                    solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                sign(<x.150^x.151, 'g'^~tid.118>, ~x.123))) )
                      case Init_2_case_1
                      by solve( KU((#vr.155, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.189, 0)[!KU( f_.190, ~x.123 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                        case fresh
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                        case fresh
                        by solve( (#vf.190, 0)[!KU( f_.191, ~x.123 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.155, 1), ~ekI.111) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.187, 0)[!KU( f_.188, ~x.123 )] )
                    next
                      case mac
                      solve( (#vr.168, 1)[!KU( f_.170,
                                               sign(<x.150^x.151, 'g'^~tid.118>, ~x.123)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.198, 0)[!KU( f_.199, ~x.123 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                          case fresh
                          by solve( KU((#vr.155, 1), ~ekI.111) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                          case fresh
                          by solve( (#vf.199, 0)[!KU( f_.200, ~x.123 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.196, 0)[!KU( f_.197, ~x.123 )] )
                      next
                        case sign
                        by solve( (#vr.176, 1)[!KU( f_.178, ~x.123 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_3
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    by solve( (#vr.167, 1)[!KU( f_.168, ~ekI.187 )] )
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    by solve( (#vr.167, 1)[!KU( f_.168, ~ekI.186 )] )
                  qed
                next
                  case exp
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                sign(<x.150^x.151, 'g'^~tid.118>, ~x.123))) )
                      case Init_2_case_1
                      by solve( KU((#vr.155, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                        case fresh
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.155, 1), ~ekI.111) )
                    next
                      case mac
                      solve( (#vr.168, 1)[!KU( f_.170,
                                               sign(<x.150^x.151, 'g'^~tid.118>, ~x.123)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                          case fresh
                          by solve( KU((#vr.155, 1), ~ekI.111) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      next
                        case sign
                        by solve( KU((#vr.155, 1), ~ekI.111) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_4
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    solve( (#vf.133, 0)[!KU( f_.134, ~ltkI.122 )] )
                      case fresh
                      by solve( (#vr.168, 1)[!KU( f_.169, ~ekI.188 )] )
                    qed
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    solve( (#vf.133, 0)[!KU( f_.134, ~ltkI.122 )] )
                      case fresh
                      by solve( (#vr.168, 1)[!KU( f_.169, ~ekI.187 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.130, 0)[!KU( f_.131, ~x.123 )] )
                    case fresh
                    solve( (#vf.133, 0)[!KU( f_.134, ~ltkI.122 )] )
                      case fresh
                      solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                  sign(<x.151^x.152, 'g'^~tid.118>, ~x.123))) )
                        case Init_2_case_1
                        by solve( KU((#vr.156, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                          case fresh
                          by solve( KU((#vr.156, 1), ~ekI.111) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.156, 1), ~ekI.111) )
                      next
                        case mac
                        solve( (#vr.175, 1)[!KU( f_.177,
                                                 sign(<x.151^x.152, 'g'^~tid.118>, ~x.123)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.156, 1), ~ekI.111) )
                        next
                          case Init_2_case_2
                          solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                            case fresh
                            by solve( KU((#vr.156, 1), ~ekI.111) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.156, 1), ~ekI.111) )
                        next
                          case sign
                          by solve( KU((#vr.156, 1), ~ekI.111) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_5
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.190 )] )
                next
                  case Init_1_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.189 )] )
                next
                  case exp
                  solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                              sign(<x.153^x.154, 'g'^~tid.118>, ~x.122))) )
                    case Init_2_case_1
                    by solve( KU((#vr.158, 1), ~ekI.111) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.186, 0)[!KU( f_.187, ~x.122 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.184, 0)[!KU( f_.185, ~x.173 )] )
                      case fresh
                      by solve( KU((#vr.158, 1), ~ekI.111) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.184, 0)[!KU( f_.185, ~x.173 )] )
                      case fresh
                      by solve( (#vf.187, 0)[!KU( f_.188, ~x.122 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.158, 1), ~ekI.111) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.184, 0)[!KU( f_.185, ~x.122 )] )
                  next
                    case mac
                    solve( (#vr.165, 1)[!KU( f_.167,
                                             sign(<x.153^x.154, 'g'^~tid.118>, ~x.122)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.158, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.195, 0)[!KU( f_.196, ~x.122 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.193, 0)[!KU( f_.194, ~x.182 )] )
                        case fresh
                        by solve( KU((#vr.158, 1), ~ekI.111) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.193, 0)[!KU( f_.194, ~x.182 )] )
                        case fresh
                        by solve( (#vf.196, 0)[!KU( f_.197, ~x.122 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.158, 1), ~ekI.111) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.193, 0)[!KU( f_.194, ~x.122 )] )
                    next
                      case sign
                      by solve( (#vr.173, 1)[!KU( f_.175, ~x.122 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_6
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.135, 0)[!KU( f_.136, ~ltkR.123 )] )
                    case fresh
                    by solve( (#vr.171, 1)[!KU( f_.172, ~ekI.191 )] )
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.135, 0)[!KU( f_.136, ~ltkR.123 )] )
                    case fresh
                    by solve( (#vr.171, 1)[!KU( f_.172, ~ekI.190 )] )
                  qed
                next
                  case exp
                  solve( (#vf.135, 0)[!KU( f_.136, ~ltkR.123 )] )
                    case fresh
                    solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                sign(<x.154^x.155, 'g'^~tid.118>, ~x.122))) )
                      case Init_2_case_1
                      by solve( KU((#vr.159, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.193, 0)[!KU( f_.194, ~x.122 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.191, 0)[!KU( f_.192, ~x.180 )] )
                        case fresh
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.191, 0)[!KU( f_.192, ~x.180 )] )
                        case fresh
                        by solve( (#vf.194, 0)[!KU( f_.195, ~x.122 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.159, 1), ~ekI.111) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.191, 0)[!KU( f_.192, ~x.122 )] )
                    next
                      case mac
                      solve( (#vr.172, 1)[!KU( f_.174,
                                               sign(<x.154^x.155, 'g'^~tid.118>, ~x.122)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.202, 0)[!KU( f_.203, ~x.122 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.200, 0)[!KU( f_.201, ~x.189 )] )
                          case fresh
                          by solve( KU((#vr.159, 1), ~ekI.111) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.200, 0)[!KU( f_.201, ~x.189 )] )
                          case fresh
                          by solve( (#vf.203, 0)[!KU( f_.204, ~x.122 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.200, 0)[!KU( f_.201, ~x.122 )] )
                      next
                        case sign
                        by solve( (#vr.180, 1)[!KU( f_.182, ~x.122 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_7
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    by solve( (#vr.171, 1)[!KU( f_.172, ~ekI.191 )] )
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    by solve( (#vr.171, 1)[!KU( f_.172, ~ekI.190 )] )
                  qed
                next
                  case exp
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                sign(<x.154^x.155, 'g'^~tid.118>, ~x.122))) )
                      case Init_2_case_1
                      by solve( KU((#vr.159, 1), ~ekI.111) )
                    next
                      case Init_2_case_2
                      solve( (#vf.191, 0)[!KU( f_.192, ~x.180 )] )
                        case fresh
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.159, 1), ~ekI.111) )
                    next
                      case mac
                      solve( (#vr.172, 1)[!KU( f_.174,
                                               sign(<x.154^x.155, 'g'^~tid.118>, ~x.122)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        solve( (#vf.200, 0)[!KU( f_.201, ~x.189 )] )
                          case fresh
                          by solve( KU((#vr.159, 1), ~ekI.111) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      next
                        case sign
                        by solve( KU((#vr.159, 1), ~ekI.111) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_8
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    solve( (#vf.136, 0)[!KU( f_.137, ~ltkR.123 )] )
                      case fresh
                      by solve( (#vr.172, 1)[!KU( f_.173, ~ekI.192 )] )
                    qed
                  qed
                next
                  case Init_1_case_2
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    solve( (#vf.136, 0)[!KU( f_.137, ~ltkR.123 )] )
                      case fresh
                      by solve( (#vr.172, 1)[!KU( f_.173, ~ekI.191 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.128, 0)[!KU( f_.129, ~x.122 )] )
                    case fresh
                    solve( (#vf.136, 0)[!KU( f_.137, ~ltkR.123 )] )
                      case fresh
                      solve( KU((#vf.125, 0), mac('g'^(~ekI.111*~ekI.112),
                                                  sign(<x.155^x.156, 'g'^~tid.118>, ~x.122))) )
                        case Init_2_case_1
                        by solve( KU((#vr.160, 1), ~ekI.111) )
                      next
                        case Init_2_case_2
                        solve( (#vf.198, 0)[!KU( f_.199, ~x.187 )] )
                          case fresh
                          by solve( KU((#vr.160, 1), ~ekI.111) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.160, 1), ~ekI.111) )
                      next
                        case mac
                        solve( (#vr.179, 1)[!KU( f_.181,
                                                 sign(<x.155^x.156, 'g'^~tid.118>, ~x.122)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.160, 1), ~ekI.111) )
                        next
                          case Init_2_case_2
                          solve( (#vf.207, 0)[!KU( f_.208, ~x.196 )] )
                            case fresh
                            by solve( KU((#vr.160, 1), ~ekI.111) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.160, 1), ~ekI.111) )
                        next
                          case sign
                          by solve( KU((#vr.160, 1), ~ekI.111) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case h
                solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekI.111*~ekI.112) )] )
                  case Init_1_case_1
                  by solve( (#vr.133, 1)[!KU( f_.134, ~ekI.153 )] )
                next
                  case Init_1_case_2
                  by solve( (#vr.133, 1)[!KU( f_.134, ~ekI.152 )] )
                next
                  case exp
                  by solve( KU((#vr.121, 1), ~ekI.111) )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Init_2_case_4
      solve( (#vf.61, 0)[!KU( f_.62, ~x.50 )] )
        case fresh
        by solve( (#vf.64, 0)[!KU( f_.65, ~x.14 )] )
      qed
    next
      case Resp_1_case_1
      solve( splitEqs(1) )
        case split
        solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekI.83*~ekR.84)) )] )
          case Sessionkey_Reveal_case_1
          solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                     sign(<x.121^x.122, 'g'^~tid.90>, ~x.95))) )
            case Init_2_case_1
            solve( KU((#vf.135, 0), mac('g'^(~ekI.83*~ekR.84),
                                        sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134))) )
              case Init_2
              by contradiction // cyclic
            next
              case mac
              solve( (#vr.173, 0)[!KU( f_.174, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.173, 1)[!KU( f_.175,
                                         sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.193, 1)[!KU( f_.194, ~ekR.213 )] )
                qed
              next
                case Resp_1
                solve( (#vr.173, 1)[!KU( f_.175,
                                         sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.199, 1)[!KU( f_.200, ~ekI.221 )] )
                qed
              next
                case exp
                solve( (#vr.173, 1)[!KU( f_.175,
                                         sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.188, 1)[!KU( f_.190, ~x.134 )] )
                qed
              qed
            qed
          next
            case Init_2_case_2
            by solve( (#vf.147, 0)[!KU( f_.148, ~x.95 )] )
          next
            case Init_2_case_3
            solve( (#vf.145, 0)[!KU( f_.146, ~x.134 )] )
              case fresh
              solve( KU((#vf.135, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134))) )
                case mac
                solve( (#vr.180, 0)[!KU( f_.181, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                      )] )
                    case sign
                    by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.220 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                      )] )
                    case sign
                    by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.228 )] )
                  qed
                next
                  case exp
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.127>, ~x.134)
                                      )] )
                    case sign
                    by solve( KU((#vr.188, 1), ~ekI.83) )
                  qed
                qed
              qed
            qed
          next
            case Init_2_case_4
            solve( (#vf.145, 0)[!KU( f_.146, ~x.134 )] )
              case fresh
              by solve( (#vf.148, 0)[!KU( f_.149, ~x.95 )] )
            qed
          next
            case Resp_1_case_1
            solve( splitEqs(1) )
              case split
              by contradiction // from formulas
            qed
          next
            case Resp_1_case_2
            by solve( (#vf.145, 0)[!KU( f_.146, ~x.95 )] )
          next
            case mac
            solve( (#vr.126, 0)[!KU( f_.127, 'g'^(~ekI.83*~ekR.84) )] )
              case Init_1
              solve( (#vr.126, 1)[!KU( f_.128, sign(<x.121^x.122, 'g'^~tid.90>, ~x.95)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case Init_2_case_2
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case Init_2_case_3
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case Init_2_case_4
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              next
                case sign
                by solve( (#vr.146, 1)[!KU( f_.147, ~ekR.166 )] )
              qed
            next
              case Resp_1
              solve( (#vr.126, 1)[!KU( f_.128, sign(<x.121^x.122, 'g'^~tid.90>, ~x.95)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case Init_2_case_2
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case Init_2_case_3
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case Init_2_case_4
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              next
                case sign
                by solve( (#vr.152, 1)[!KU( f_.153, ~ekI.174 )] )
              qed
            next
              case exp
              solve( (#vr.126, 1)[!KU( f_.128, sign(<x.121^x.122, 'g'^~tid.90>, ~x.95)
                                  )] )
                case Init_2_case_1
                by solve( KU((#vr.134, 1), ~ekI.83) )
              next
                case Init_2_case_2
                by solve( (#vf.163, 0)[!KU( f_.164, ~x.95 )] )
              next
                case Init_2_case_3
                solve( (#vf.161, 0)[!KU( f_.162, ~x.150 )] )
                  case fresh
                  by solve( KU((#vr.134, 1), ~ekI.83) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.161, 0)[!KU( f_.162, ~x.150 )] )
                  case fresh
                  by solve( (#vf.164, 0)[!KU( f_.165, ~x.95 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.134, 1), ~ekI.83) )
              next
                case Resp_1_case_2
                by solve( (#vf.161, 0)[!KU( f_.162, ~x.95 )] )
              next
                case sign
                by solve( (#vr.141, 1)[!KU( f_.143, ~x.95 )] )
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_2
          solve( (#vf.104, 0)[!KU( f_.105, ~ltkI.94 )] )
            case fresh
            solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                       sign(<x.122^x.123, 'g'^~tid.90>, ~x.95))) )
              case Init_2_case_1
              solve( KU((#vf.142, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141))) )
                case mac
                solve( (#vr.180, 0)[!KU( f_.181, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.220 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.228 )] )
                  qed
                next
                  case exp
                  solve( (#vr.180, 1)[!KU( f_.182,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( (#vr.195, 1)[!KU( f_.197, ~x.141 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.154, 0)[!KU( f_.155, ~x.95 )] )
            next
              case Init_2_case_3
              solve( (#vf.152, 0)[!KU( f_.153, ~x.141 )] )
                case fresh
                solve( KU((#vf.142, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141))) )
                  case Init_2
                  by contradiction // cyclic
                next
                  case mac
                  solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.187, 1)[!KU( f_.189,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.227 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.187, 1)[!KU( f_.189,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.235 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.187, 1)[!KU( f_.189,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( KU((#vr.195, 1), ~ekI.83) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.152, 0)[!KU( f_.153, ~x.141 )] )
                case fresh
                by solve( (#vf.155, 0)[!KU( f_.156, ~x.95 )] )
              qed
            next
              case Resp_1_case_1
              by solve( splitEqs(1) )
            next
              case Resp_1_case_2
              by solve( (#vf.152, 0)[!KU( f_.153, ~x.95 )] )
            next
              case mac
              solve( (#vr.133, 0)[!KU( f_.134, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case sign
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                qed
              next
                case Resp_1
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case sign
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                qed
              next
                case exp
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.141, 1), ~ekI.83) )
                next
                  case Init_2_case_2
                  by solve( (#vf.170, 0)[!KU( f_.171, ~x.95 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.168, 0)[!KU( f_.169, ~x.157 )] )
                    case fresh
                    by solve( KU((#vr.141, 1), ~ekI.83) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.168, 0)[!KU( f_.169, ~x.157 )] )
                    case fresh
                    by solve( (#vf.171, 0)[!KU( f_.172, ~x.95 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.141, 1), ~ekI.83) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.168, 0)[!KU( f_.169, ~x.95 )] )
                next
                  case sign
                  by solve( (#vr.148, 1)[!KU( f_.150, ~x.95 )] )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_3
          solve( (#vf.102, 0)[!KU( f_.103, ~x.95 )] )
            case fresh
            solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                       sign(<x.122^x.123, 'g'^~tid.90>, ~x.95))) )
              case Init_2_case_1
              solve( KU((#vf.142, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141))) )
                case Init_2
                by contradiction // cyclic
              next
                case mac
                solve( (#vr.181, 0)[!KU( f_.182, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.181, 1)[!KU( f_.183,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.201, 1)[!KU( f_.202, ~ekR.221 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.181, 1)[!KU( f_.183,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekI.229 )] )
                  qed
                next
                  case exp
                  solve( (#vr.181, 1)[!KU( f_.183,
                                           sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.196, 1)[!KU( f_.198, ~x.141 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              solve( (#vf.152, 0)[!KU( f_.153, ~x.141 )] )
                case fresh
                solve( KU((#vf.142, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141))) )
                  case mac
                  solve( (#vr.188, 0)[!KU( f_.189, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case sign
                      by solve( (#vr.208, 1)[!KU( f_.209, ~ekR.228 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case sign
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekI.236 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.134>, ~x.141)
                                        )] )
                      case sign
                      by solve( KU((#vr.196, 1), ~ekI.83) )
                    qed
                  qed
                qed
              qed
            next
              case Resp_1
              by solve( splitEqs(1) )
            next
              case mac
              solve( (#vr.133, 0)[!KU( f_.134, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case Resp_1
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                next
                  case sign
                  by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
                qed
              next
                case Resp_1
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case Resp_1
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                next
                  case sign
                  by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
                qed
              next
                case exp
                solve( (#vr.133, 1)[!KU( f_.135, sign(<x.122^x.123, 'g'^~tid.90>, ~x.95)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.141, 1), ~ekI.83) )
                next
                  case Init_2_case_2
                  solve( (#vf.168, 0)[!KU( f_.169, ~x.157 )] )
                    case fresh
                    by solve( KU((#vr.141, 1), ~ekI.83) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.141, 1), ~ekI.83) )
                next
                  case sign
                  by solve( KU((#vr.141, 1), ~ekI.83) )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_4
          solve( (#vf.102, 0)[!KU( f_.103, ~x.95 )] )
            case fresh
            solve( (#vf.105, 0)[!KU( f_.106, ~ltkI.94 )] )
              case fresh
              solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                         sign(<x.123^x.124, 'g'^~tid.90>, ~x.95))) )
                case Init_2_case_1
                solve( KU((#vf.149, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148))) )
                  case mac
                  solve( (#vr.188, 0)[!KU( f_.189, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( (#vr.208, 1)[!KU( f_.209, ~ekR.228 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekI.236 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.188, 1)[!KU( f_.190,
                                             sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( (#vr.203, 1)[!KU( f_.205, ~x.148 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.159, 0)[!KU( f_.160, ~x.148 )] )
                  case fresh
                  solve( KU((#vf.149, 0), mac('g'^(~ekI.83*~ekR.84),
                                              sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148))) )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case mac
                    solve( (#vr.195, 0)[!KU( f_.196, 'g'^(~ekI.83*~ekR.84) )] )
                      case Init_1
                      solve( (#vr.195, 1)[!KU( f_.197,
                                               sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.215, 1)[!KU( f_.216, ~ekR.235 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.195, 1)[!KU( f_.197,
                                               sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.221, 1)[!KU( f_.222, ~ekI.243 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.195, 1)[!KU( f_.197,
                                               sign(<'g'^~tid.90, 'g'^~ekI.141>, ~x.148)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( KU((#vr.203, 1), ~ekI.83) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                by solve( splitEqs(1) )
              next
                case mac
                solve( (#vr.140, 0)[!KU( f_.141, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.140, 1)[!KU( f_.142, sign(<x.123^x.124, 'g'^~tid.90>, ~x.95)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.160, 1)[!KU( f_.161, ~ekR.180 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.160, 1)[!KU( f_.161, ~ekR.180 )] )
                  next
                    case Resp_1
                    by solve( (#vr.160, 1)[!KU( f_.161, ~ekR.180 )] )
                  next
                    case sign
                    by solve( (#vr.160, 1)[!KU( f_.161, ~ekR.180 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.140, 1)[!KU( f_.142, sign(<x.123^x.124, 'g'^~tid.90>, ~x.95)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.188 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.188 )] )
                  next
                    case Resp_1
                    by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.188 )] )
                  next
                    case sign
                    by solve( (#vr.166, 1)[!KU( f_.167, ~ekI.188 )] )
                  qed
                next
                  case exp
                  solve( (#vr.140, 1)[!KU( f_.142, sign(<x.123^x.124, 'g'^~tid.90>, ~x.95)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.148, 1), ~ekI.83) )
                  next
                    case Init_2_case_2
                    solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                      case fresh
                      by solve( KU((#vr.148, 1), ~ekI.83) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.148, 1), ~ekI.83) )
                  next
                    case sign
                    by solve( KU((#vr.148, 1), ~ekI.83) )
                  qed
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_5
          solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                     sign(<x.125^x.126, 'g'^~tid.90>, ~x.94))) )
            case Init_2_case_1
            solve( KU((#vf.139, 0), mac('g'^(~ekI.83*~ekR.84),
                                        sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138))) )
              case Resp_1
              solve( splitEqs(1) )
                case split
                by contradiction // from formulas
              qed
            next
              case mac
              solve( (#vr.179, 0)[!KU( f_.180, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.179, 1)[!KU( f_.181,
                                         sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                    )] )
                  case Resp_1
                  by solve( (#vr.199, 1)[!KU( f_.200, ~ekR.219 )] )
                next
                  case sign
                  by solve( (#vr.199, 1)[!KU( f_.200, ~ekR.219 )] )
                qed
              next
                case Resp_1
                solve( (#vr.179, 1)[!KU( f_.181,
                                         sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                    )] )
                  case Resp_1
                  by solve( (#vr.205, 1)[!KU( f_.206, ~ekI.227 )] )
                next
                  case sign
                  by solve( (#vr.205, 1)[!KU( f_.206, ~ekI.227 )] )
                qed
              next
                case exp
                solve( (#vr.179, 1)[!KU( f_.181,
                                         sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                    )] )
                  case Resp_1
                  by solve( KU((#vr.187, 1), ~ekI.83) )
                next
                  case sign
                  by solve( (#vr.194, 1)[!KU( f_.196, ~x.138 )] )
                qed
              qed
            qed
          next
            case Init_2_case_2
            by solve( (#vf.151, 0)[!KU( f_.152, ~x.94 )] )
          next
            case Init_2_case_3
            solve( (#vf.149, 0)[!KU( f_.150, ~x.138 )] )
              case fresh
              solve( KU((#vf.139, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138))) )
                case mac
                solve( (#vr.186, 0)[!KU( f_.187, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                      )] )
                    case sign
                    by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.226 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                      )] )
                    case sign
                    by solve( (#vr.212, 1)[!KU( f_.213, ~ekI.234 )] )
                  qed
                next
                  case exp
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.131>, ~x.138)
                                      )] )
                    case sign
                    by solve( KU((#vr.194, 1), ~ekI.83) )
                  qed
                qed
              qed
            qed
          next
            case Init_2_case_4
            solve( (#vf.149, 0)[!KU( f_.150, ~x.138 )] )
              case fresh
              by solve( (#vf.152, 0)[!KU( f_.153, ~x.94 )] )
            qed
          next
            case Resp_1_case_1
            solve( splitEqs(1) )
              case split_case_1
              by solve( splitEqs(1) )
            next
              case split_case_2
              by contradiction // non-normal terms
            qed
          next
            case Resp_1_case_2
            by solve( (#vf.149, 0)[!KU( f_.150, ~x.94 )] )
          next
            case mac
            solve( (#vr.130, 0)[!KU( f_.131, 'g'^(~ekI.83*~ekR.84) )] )
              case Init_1
              solve( (#vr.130, 1)[!KU( f_.132, sign(<x.125^x.126, 'g'^~tid.90>, ~x.94)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case Init_2_case_2
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case Init_2_case_3
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case Init_2_case_4
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              next
                case sign
                by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
              qed
            next
              case Resp_1
              solve( (#vr.130, 1)[!KU( f_.132, sign(<x.125^x.126, 'g'^~tid.90>, ~x.94)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case Init_2_case_2
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case Init_2_case_3
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case Init_2_case_4
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              next
                case sign
                by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
              qed
            next
              case exp
              solve( (#vr.130, 1)[!KU( f_.132, sign(<x.125^x.126, 'g'^~tid.90>, ~x.94)
                                  )] )
                case Init_2_case_1
                by solve( KU((#vr.138, 1), ~ekI.83) )
              next
                case Init_2_case_2
                by solve( (#vf.167, 0)[!KU( f_.168, ~x.94 )] )
              next
                case Init_2_case_3
                solve( (#vf.165, 0)[!KU( f_.166, ~x.154 )] )
                  case fresh
                  by solve( KU((#vr.138, 1), ~ekI.83) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.165, 0)[!KU( f_.166, ~x.154 )] )
                  case fresh
                  by solve( (#vf.168, 0)[!KU( f_.169, ~x.94 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.138, 1), ~ekI.83) )
              next
                case Resp_1_case_2
                by solve( (#vf.165, 0)[!KU( f_.166, ~x.94 )] )
              next
                case sign
                by solve( (#vr.145, 1)[!KU( f_.147, ~x.94 )] )
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_6
          solve( (#vf.107, 0)[!KU( f_.108, ~ltkR.95 )] )
            case fresh
            solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                       sign(<x.126^x.127, 'g'^~tid.90>, ~x.94))) )
              case Init_2_case_1
              solve( KU((#vf.146, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145))) )
                case mac
                solve( (#vr.186, 0)[!KU( f_.187, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.226 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( (#vr.212, 1)[!KU( f_.213, ~ekI.234 )] )
                  qed
                next
                  case exp
                  solve( (#vr.186, 1)[!KU( f_.188,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( (#vr.201, 1)[!KU( f_.203, ~x.145 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.158, 0)[!KU( f_.159, ~x.94 )] )
            next
              case Init_2_case_3
              solve( (#vf.156, 0)[!KU( f_.157, ~x.145 )] )
                case fresh
                solve( KU((#vf.146, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145))) )
                  case Resp_1
                  by solve( splitEqs(1) )
                next
                  case mac
                  solve( (#vr.193, 0)[!KU( f_.194, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.193, 1)[!KU( f_.195,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case Resp_1
                      by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.233 )] )
                    next
                      case sign
                      by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.233 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.193, 1)[!KU( f_.195,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case Resp_1
                      by solve( (#vr.219, 1)[!KU( f_.220, ~ekI.241 )] )
                    next
                      case sign
                      by solve( (#vr.219, 1)[!KU( f_.220, ~ekI.241 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.193, 1)[!KU( f_.195,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case Resp_1
                      by solve( KU((#vr.201, 1), ~ekI.83) )
                    next
                      case sign
                      by solve( KU((#vr.201, 1), ~ekI.83) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.156, 0)[!KU( f_.157, ~x.145 )] )
                case fresh
                by solve( (#vf.159, 0)[!KU( f_.160, ~x.94 )] )
              qed
            next
              case Resp_1_case_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case Resp_1_case_2
              by solve( (#vf.156, 0)[!KU( f_.157, ~x.94 )] )
            next
              case mac
              solve( (#vr.137, 0)[!KU( f_.138, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case sign
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                qed
              next
                case Resp_1
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case sign
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                qed
              next
                case exp
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.145, 1), ~ekI.83) )
                next
                  case Init_2_case_2
                  by solve( (#vf.174, 0)[!KU( f_.175, ~x.94 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.172, 0)[!KU( f_.173, ~x.161 )] )
                    case fresh
                    by solve( KU((#vr.145, 1), ~ekI.83) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.172, 0)[!KU( f_.173, ~x.161 )] )
                    case fresh
                    by solve( (#vf.175, 0)[!KU( f_.176, ~x.94 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.145, 1), ~ekI.83) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.172, 0)[!KU( f_.173, ~x.94 )] )
                next
                  case sign
                  by solve( (#vr.152, 1)[!KU( f_.154, ~x.94 )] )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_7
          solve( (#vf.100, 0)[!KU( f_.101, ~x.94 )] )
            case fresh
            solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                       sign(<x.126^x.127, 'g'^~tid.90>, ~x.94))) )
              case Init_2_case_1
              solve( KU((#vf.146, 0), mac('g'^(~ekI.83*~ekR.84),
                                          sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145))) )
                case Resp_1
                by solve( splitEqs(1) )
              next
                case mac
                solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case Resp_1
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.227 )] )
                  next
                    case sign
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.227 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case Resp_1
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.235 )] )
                  next
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.235 )] )
                  qed
                next
                  case exp
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case Resp_1
                    by solve( KU((#vr.195, 1), ~ekI.83) )
                  next
                    case sign
                    by solve( (#vr.202, 1)[!KU( f_.204, ~x.145 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              solve( (#vf.156, 0)[!KU( f_.157, ~x.145 )] )
                case fresh
                solve( KU((#vf.146, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145))) )
                  case mac
                  solve( (#vr.194, 0)[!KU( f_.195, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case sign
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.234 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case sign
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.242 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.138>, ~x.145)
                                        )] )
                      case sign
                      by solve( KU((#vr.202, 1), ~ekI.83) )
                    qed
                  qed
                qed
              qed
            next
              case Resp_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case mac
              solve( (#vr.137, 0)[!KU( f_.138, 'g'^(~ekI.83*~ekR.84) )] )
                case Init_1
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case Resp_1
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                next
                  case sign
                  by solve( (#vr.157, 1)[!KU( f_.158, ~ekR.177 )] )
                qed
              next
                case Resp_1
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case Resp_1
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                next
                  case sign
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekI.185 )] )
                qed
              next
                case exp
                solve( (#vr.137, 1)[!KU( f_.139, sign(<x.126^x.127, 'g'^~tid.90>, ~x.94)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.145, 1), ~ekI.83) )
                next
                  case Init_2_case_2
                  solve( (#vf.172, 0)[!KU( f_.173, ~x.161 )] )
                    case fresh
                    by solve( KU((#vr.145, 1), ~ekI.83) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.145, 1), ~ekI.83) )
                next
                  case sign
                  by solve( KU((#vr.145, 1), ~ekI.83) )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_8
          solve( (#vf.100, 0)[!KU( f_.101, ~x.94 )] )
            case fresh
            solve( (#vf.108, 0)[!KU( f_.109, ~ltkR.95 )] )
              case fresh
              solve( KU((#vf.97, 0), mac('g'^(~ekI.83*~ekR.84),
                                         sign(<x.127^x.128, 'g'^~tid.90>, ~x.94))) )
                case Init_2_case_1
                solve( KU((#vf.153, 0), mac('g'^(~ekI.83*~ekR.84),
                                            sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152))) )
                  case mac
                  solve( (#vr.194, 0)[!KU( f_.195, 'g'^(~ekI.83*~ekR.84) )] )
                    case Init_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.234 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.242 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( (#vr.209, 1)[!KU( f_.211, ~x.152 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.163, 0)[!KU( f_.164, ~x.152 )] )
                  case fresh
                  solve( KU((#vf.153, 0), mac('g'^(~ekI.83*~ekR.84),
                                              sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152))) )
                    case Resp_1
                    by solve( splitEqs(1) )
                  next
                    case mac
                    solve( (#vr.201, 0)[!KU( f_.202, 'g'^(~ekI.83*~ekR.84) )] )
                      case Init_1
                      solve( (#vr.201, 1)[!KU( f_.203,
                                               sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                          )] )
                        case Resp_1
                        by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.241 )] )
                      next
                        case sign
                        by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.241 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.201, 1)[!KU( f_.203,
                                               sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                          )] )
                        case Resp_1
                        by solve( (#vr.227, 1)[!KU( f_.228, ~ekI.249 )] )
                      next
                        case sign
                        by solve( (#vr.227, 1)[!KU( f_.228, ~ekI.249 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.201, 1)[!KU( f_.203,
                                               sign(<'g'^~tid.90, 'g'^~ekI.145>, ~x.152)
                                          )] )
                        case Resp_1
                        by solve( KU((#vr.209, 1), ~ekI.83) )
                      next
                        case sign
                        by solve( KU((#vr.209, 1), ~ekI.83) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case mac
                solve( (#vr.144, 0)[!KU( f_.145, 'g'^(~ekI.83*~ekR.84) )] )
                  case Init_1
                  solve( (#vr.144, 1)[!KU( f_.146, sign(<x.127^x.128, 'g'^~tid.90>, ~x.94)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.164, 1)[!KU( f_.165, ~ekR.184 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.164, 1)[!KU( f_.165, ~ekR.184 )] )
                  next
                    case Resp_1
                    by solve( (#vr.164, 1)[!KU( f_.165, ~ekR.184 )] )
                  next
                    case sign
                    by solve( (#vr.164, 1)[!KU( f_.165, ~ekR.184 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.144, 1)[!KU( f_.146, sign(<x.127^x.128, 'g'^~tid.90>, ~x.94)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.192 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.192 )] )
                  next
                    case Resp_1
                    by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.192 )] )
                  next
                    case sign
                    by solve( (#vr.170, 1)[!KU( f_.171, ~ekI.192 )] )
                  qed
                next
                  case exp
                  solve( (#vr.144, 1)[!KU( f_.146, sign(<x.127^x.128, 'g'^~tid.90>, ~x.94)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.152, 1), ~ekI.83) )
                  next
                    case Init_2_case_2
                    solve( (#vf.179, 0)[!KU( f_.180, ~x.168 )] )
                      case fresh
                      by solve( KU((#vr.152, 1), ~ekI.83) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.152, 1), ~ekI.83) )
                  next
                    case sign
                    by solve( KU((#vr.152, 1), ~ekI.83) )
                  qed
                qed
              qed
            qed
          qed
        next
          case h
          solve( (#vr.87, 0)[!KU( f_.88, 'g'^(~ekI.83*~ekR.84) )] )
            case Init_1
            by solve( (#vr.105, 1)[!KU( f_.106, ~ekR.125 )] )
          next
            case Resp_1
            by solve( (#vr.111, 1)[!KU( f_.112, ~ekI.133 )] )
          next
            case exp
            by solve( KU((#vr.93, 1), ~ekI.83) )
          qed
        qed
      qed
    next
      case Resp_1_case_2
      by solve( (#vf.61, 0)[!KU( f_.62, ~x.14 )] )
    next
      case mac
      solve( (#vr.42, 1)[!KU( f_.44, sign(<hkr.7, 'g'^~ekI.8>, ~x.14) )] )
        case Init_2_case_1
        solve( KU((#vf.60, 0), mac(x.96^x.97,
                                   sign(<'g'^~ekI.8, 'g'^~ekI.51>, ~x.59))) )
          case Init_2
          by contradiction // cyclic
        next
          case mac
          solve( (#vr.101, 1)[!KU( f_.103, sign(<'g'^~ekI.8, 'g'^~ekI.51>, ~x.59)
                              )] )
            case Init_2
            by contradiction // cyclic
          next
            case sign
            by solve( (#vr.109, 1)[!KU( f_.111, ~x.59 )] )
          qed
        qed
      next
        case Init_2_case_2
        by solve( (#vf.72, 0)[!KU( f_.73, ~x.14 )] )
      next
        case Init_2_case_3
        solve( (#vf.70, 0)[!KU( f_.71, ~x.59 )] )
          case fresh
          solve( KU((#vf.60, 0), mac(x.97^x.98,
                                     sign(<'g'^~ekI.8, 'g'^~ekI.51>, ~x.59))) )
            case mac
            solve( (#vr.108, 1)[!KU( f_.110, sign(<'g'^~ekI.8, 'g'^~ekI.51>, ~x.59)
                                )] )
              case sign
              solve( splitEqs(1) )
                case split_case_1
                solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekI.121*~ekI.122)) )] )
                  case Sessionkey_Reveal_case_1
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    by solve( (#vr.176, 1)[!KU( f_.177, ~ekI.196 )] )
                  next
                    case Init_1_case_2
                    by solve( (#vr.176, 1)[!KU( f_.177, ~ekI.195 )] )
                  next
                    case exp
                    solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                sign(<x.159^x.160, 'g'^~tid.128>, ~x.133))) )
                      case Init_2_case_1
                      by solve( KU((#vr.164, 1), ~ekI.121) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.192, 0)[!KU( f_.193, ~x.133 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.190, 0)[!KU( f_.191, ~x.179 )] )
                        case fresh
                        by solve( KU((#vr.164, 1), ~ekI.121) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.190, 0)[!KU( f_.191, ~x.179 )] )
                        case fresh
                        by solve( (#vf.193, 0)[!KU( f_.194, ~x.133 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.164, 1), ~ekI.121) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.190, 0)[!KU( f_.191, ~x.133 )] )
                    next
                      case mac
                      solve( (#vr.171, 1)[!KU( f_.173,
                                               sign(<x.159^x.160, 'g'^~tid.128>, ~x.133)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.164, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.201, 0)[!KU( f_.202, ~x.133 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.199, 0)[!KU( f_.200, ~x.188 )] )
                          case fresh
                          by solve( KU((#vr.164, 1), ~ekI.121) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.199, 0)[!KU( f_.200, ~x.188 )] )
                          case fresh
                          by solve( (#vf.202, 0)[!KU( f_.203, ~x.133 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.164, 1), ~ekI.121) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.199, 0)[!KU( f_.200, ~x.133 )] )
                      next
                        case sign
                        by solve( (#vr.179, 1)[!KU( f_.181, ~x.133 )] )
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_2
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.142, 0)[!KU( f_.143, ~ltkI.132 )] )
                      case fresh
                      by solve( (#vr.177, 1)[!KU( f_.178, ~ekI.197 )] )
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.142, 0)[!KU( f_.143, ~ltkI.132 )] )
                      case fresh
                      by solve( (#vr.177, 1)[!KU( f_.178, ~ekI.196 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.142, 0)[!KU( f_.143, ~ltkI.132 )] )
                      case fresh
                      solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                  sign(<x.160^x.161, 'g'^~tid.128>, ~x.133))) )
                        case Init_2_case_1
                        by solve( KU((#vr.165, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.199, 0)[!KU( f_.200, ~x.133 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.197, 0)[!KU( f_.198, ~x.186 )] )
                          case fresh
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.197, 0)[!KU( f_.198, ~x.186 )] )
                          case fresh
                          by solve( (#vf.200, 0)[!KU( f_.201, ~x.133 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.165, 1), ~ekI.121) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.197, 0)[!KU( f_.198, ~x.133 )] )
                      next
                        case mac
                        solve( (#vr.178, 1)[!KU( f_.180,
                                                 sign(<x.160^x.161, 'g'^~tid.128>, ~x.133)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          by solve( (#vf.208, 0)[!KU( f_.209, ~x.133 )] )
                        next
                          case Init_2_case_3
                          solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                            case fresh
                            by solve( KU((#vr.165, 1), ~ekI.121) )
                          qed
                        next
                          case Init_2_case_4
                          solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                            case fresh
                            by solve( (#vf.209, 0)[!KU( f_.210, ~x.133 )] )
                          qed
                        next
                          case Resp_1_case_1
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        next
                          case Resp_1_case_2
                          by solve( (#vf.206, 0)[!KU( f_.207, ~x.133 )] )
                        next
                          case sign
                          by solve( (#vr.186, 1)[!KU( f_.188, ~x.133 )] )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_3
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      by solve( (#vr.177, 1)[!KU( f_.178, ~ekI.197 )] )
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      by solve( (#vr.177, 1)[!KU( f_.178, ~ekI.196 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                  sign(<x.160^x.161, 'g'^~tid.128>, ~x.133))) )
                        case Init_2_case_1
                        by solve( KU((#vr.165, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        solve( (#vf.197, 0)[!KU( f_.198, ~x.186 )] )
                          case fresh
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.165, 1), ~ekI.121) )
                      next
                        case mac
                        solve( (#vr.178, 1)[!KU( f_.180,
                                                 sign(<x.160^x.161, 'g'^~tid.128>, ~x.133)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                            case fresh
                            by solve( KU((#vr.165, 1), ~ekI.121) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        next
                          case sign
                          by solve( KU((#vr.165, 1), ~ekI.121) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_4
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      solve( (#vf.143, 0)[!KU( f_.144, ~ltkI.132 )] )
                        case fresh
                        by solve( (#vr.178, 1)[!KU( f_.179, ~ekI.198 )] )
                      qed
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      solve( (#vf.143, 0)[!KU( f_.144, ~ltkI.132 )] )
                        case fresh
                        by solve( (#vr.178, 1)[!KU( f_.179, ~ekI.197 )] )
                      qed
                    qed
                  next
                    case exp
                    solve( (#vf.140, 0)[!KU( f_.141, ~x.133 )] )
                      case fresh
                      solve( (#vf.143, 0)[!KU( f_.144, ~ltkI.132 )] )
                        case fresh
                        solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                    sign(<x.161^x.162, 'g'^~tid.128>, ~x.133))) )
                          case Init_2_case_1
                          by solve( KU((#vr.166, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          solve( (#vf.204, 0)[!KU( f_.205, ~x.193 )] )
                            case fresh
                            by solve( KU((#vr.166, 1), ~ekI.121) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.166, 1), ~ekI.121) )
                        next
                          case mac
                          solve( (#vr.185, 1)[!KU( f_.187,
                                                   sign(<x.161^x.162, 'g'^~tid.128>, ~x.133)
                                              )] )
                            case Init_2_case_1
                            by solve( KU((#vr.166, 1), ~ekI.121) )
                          next
                            case Init_2_case_2
                            solve( (#vf.213, 0)[!KU( f_.214, ~x.202 )] )
                              case fresh
                              by solve( KU((#vr.166, 1), ~ekI.121) )
                            qed
                          next
                            case Resp_1
                            by solve( KU((#vr.166, 1), ~ekI.121) )
                          next
                            case sign
                            by solve( KU((#vr.166, 1), ~ekI.121) )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_5
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    by solve( (#vr.180, 1)[!KU( f_.181, ~ekI.200 )] )
                  next
                    case Init_1_case_2
                    by solve( (#vr.180, 1)[!KU( f_.181, ~ekI.199 )] )
                  next
                    case exp
                    solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                sign(<x.163^x.164, 'g'^~tid.128>, ~x.132))) )
                      case Init_2_case_1
                      by solve( KU((#vr.168, 1), ~ekI.121) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.196, 0)[!KU( f_.197, ~x.132 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                        case fresh
                        by solve( KU((#vr.168, 1), ~ekI.121) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                        case fresh
                        by solve( (#vf.197, 0)[!KU( f_.198, ~x.132 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.168, 1), ~ekI.121) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.194, 0)[!KU( f_.195, ~x.132 )] )
                    next
                      case mac
                      solve( (#vr.175, 1)[!KU( f_.177,
                                               sign(<x.163^x.164, 'g'^~tid.128>, ~x.132)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.168, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.205, 0)[!KU( f_.206, ~x.132 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                          case fresh
                          by solve( KU((#vr.168, 1), ~ekI.121) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                          case fresh
                          by solve( (#vf.206, 0)[!KU( f_.207, ~x.132 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.168, 1), ~ekI.121) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.203, 0)[!KU( f_.204, ~x.132 )] )
                      next
                        case sign
                        by solve( (#vr.183, 1)[!KU( f_.185, ~x.132 )] )
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_6
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.145, 0)[!KU( f_.146, ~ltkR.133 )] )
                      case fresh
                      by solve( (#vr.181, 1)[!KU( f_.182, ~ekI.201 )] )
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.145, 0)[!KU( f_.146, ~ltkR.133 )] )
                      case fresh
                      by solve( (#vr.181, 1)[!KU( f_.182, ~ekI.200 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.145, 0)[!KU( f_.146, ~ltkR.133 )] )
                      case fresh
                      solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                  sign(<x.164^x.165, 'g'^~tid.128>, ~x.132))) )
                        case Init_2_case_1
                        by solve( KU((#vr.169, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.203, 0)[!KU( f_.204, ~x.132 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                          case fresh
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                          case fresh
                          by solve( (#vf.204, 0)[!KU( f_.205, ~x.132 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.169, 1), ~ekI.121) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.201, 0)[!KU( f_.202, ~x.132 )] )
                      next
                        case mac
                        solve( (#vr.182, 1)[!KU( f_.184,
                                                 sign(<x.164^x.165, 'g'^~tid.128>, ~x.132)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          by solve( (#vf.212, 0)[!KU( f_.213, ~x.132 )] )
                        next
                          case Init_2_case_3
                          solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                            case fresh
                            by solve( KU((#vr.169, 1), ~ekI.121) )
                          qed
                        next
                          case Init_2_case_4
                          solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                            case fresh
                            by solve( (#vf.213, 0)[!KU( f_.214, ~x.132 )] )
                          qed
                        next
                          case Resp_1_case_1
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        next
                          case Resp_1_case_2
                          by solve( (#vf.210, 0)[!KU( f_.211, ~x.132 )] )
                        next
                          case sign
                          by solve( (#vr.190, 1)[!KU( f_.192, ~x.132 )] )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_7
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      by solve( (#vr.181, 1)[!KU( f_.182, ~ekI.201 )] )
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      by solve( (#vr.181, 1)[!KU( f_.182, ~ekI.200 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                  sign(<x.164^x.165, 'g'^~tid.128>, ~x.132))) )
                        case Init_2_case_1
                        by solve( KU((#vr.169, 1), ~ekI.121) )
                      next
                        case Init_2_case_2
                        solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                          case fresh
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.169, 1), ~ekI.121) )
                      next
                        case mac
                        solve( (#vr.182, 1)[!KU( f_.184,
                                                 sign(<x.164^x.165, 'g'^~tid.128>, ~x.132)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                            case fresh
                            by solve( KU((#vr.169, 1), ~ekI.121) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        next
                          case sign
                          by solve( KU((#vr.169, 1), ~ekI.121) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_8
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      solve( (#vf.146, 0)[!KU( f_.147, ~ltkR.133 )] )
                        case fresh
                        by solve( (#vr.182, 1)[!KU( f_.183, ~ekI.202 )] )
                      qed
                    qed
                  next
                    case Init_1_case_2
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      solve( (#vf.146, 0)[!KU( f_.147, ~ltkR.133 )] )
                        case fresh
                        by solve( (#vr.182, 1)[!KU( f_.183, ~ekI.201 )] )
                      qed
                    qed
                  next
                    case exp
                    solve( (#vf.138, 0)[!KU( f_.139, ~x.132 )] )
                      case fresh
                      solve( (#vf.146, 0)[!KU( f_.147, ~ltkR.133 )] )
                        case fresh
                        solve( KU((#vf.135, 0), mac('g'^(~ekI.121*~ekI.122),
                                                    sign(<x.165^x.166, 'g'^~tid.128>, ~x.132))) )
                          case Init_2_case_1
                          by solve( KU((#vr.170, 1), ~ekI.121) )
                        next
                          case Init_2_case_2
                          solve( (#vf.208, 0)[!KU( f_.209, ~x.197 )] )
                            case fresh
                            by solve( KU((#vr.170, 1), ~ekI.121) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.170, 1), ~ekI.121) )
                        next
                          case mac
                          solve( (#vr.189, 1)[!KU( f_.191,
                                                   sign(<x.165^x.166, 'g'^~tid.128>, ~x.132)
                                              )] )
                            case Init_2_case_1
                            by solve( KU((#vr.170, 1), ~ekI.121) )
                          next
                            case Init_2_case_2
                            solve( (#vf.217, 0)[!KU( f_.218, ~x.206 )] )
                              case fresh
                              by solve( KU((#vr.170, 1), ~ekI.121) )
                            qed
                          next
                            case Resp_1
                            by solve( KU((#vr.170, 1), ~ekI.121) )
                          next
                            case sign
                            by solve( KU((#vr.170, 1), ~ekI.121) )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case h
                  solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.121*~ekI.122) )] )
                    case Init_1_case_1
                    by solve( (#vr.143, 1)[!KU( f_.144, ~ekI.163 )] )
                  next
                    case Init_1_case_2
                    by solve( (#vr.143, 1)[!KU( f_.144, ~ekI.162 )] )
                  next
                    case exp
                    by solve( KU((#vr.131, 1), ~ekI.121) )
                  qed
                qed
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            qed
          qed
        qed
      next
        case Init_2_case_4
        solve( (#vf.70, 0)[!KU( f_.71, ~x.59 )] )
          case fresh
          by solve( (#vf.73, 0)[!KU( f_.74, ~x.14 )] )
        qed
      next
        case Resp_1_case_1
        solve( splitEqs(1) )
          case split_case_1
          solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekI.93*~ekR.94)) )] )
            case Sessionkey_Reveal_case_1
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              by solve( (#vr.148, 1)[!KU( f_.149, ~ekR.168 )] )
            next
              case Resp_1
              by solve( (#vr.154, 1)[!KU( f_.155, ~ekI.176 )] )
            next
              case exp
              solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                          sign(<x.131^x.132, 'g'^~tid.100>, ~x.105))) )
                case Init_2_case_1
                by solve( KU((#vr.136, 1), ~ekI.93) )
              next
                case Init_2_case_2
                by solve( (#vf.164, 0)[!KU( f_.165, ~x.105 )] )
              next
                case Init_2_case_3
                solve( (#vf.162, 0)[!KU( f_.163, ~x.151 )] )
                  case fresh
                  by solve( KU((#vr.136, 1), ~ekI.93) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.162, 0)[!KU( f_.163, ~x.151 )] )
                  case fresh
                  by solve( (#vf.165, 0)[!KU( f_.166, ~x.105 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.136, 1), ~ekI.93) )
              next
                case Resp_1_case_2
                by solve( (#vf.162, 0)[!KU( f_.163, ~x.105 )] )
              next
                case mac
                solve( (#vr.143, 1)[!KU( f_.145,
                                         sign(<x.131^x.132, 'g'^~tid.100>, ~x.105)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.136, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  by solve( (#vf.173, 0)[!KU( f_.174, ~x.105 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.171, 0)[!KU( f_.172, ~x.160 )] )
                    case fresh
                    by solve( KU((#vr.136, 1), ~ekI.93) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.171, 0)[!KU( f_.172, ~x.160 )] )
                    case fresh
                    by solve( (#vf.174, 0)[!KU( f_.175, ~x.105 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.136, 1), ~ekI.93) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.171, 0)[!KU( f_.172, ~x.105 )] )
                next
                  case sign
                  by solve( (#vr.151, 1)[!KU( f_.153, ~x.105 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_2
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.114, 0)[!KU( f_.115, ~ltkI.104 )] )
                case fresh
                by solve( (#vr.149, 1)[!KU( f_.150, ~ekR.169 )] )
              qed
            next
              case Resp_1
              solve( (#vf.114, 0)[!KU( f_.115, ~ltkI.104 )] )
                case fresh
                by solve( (#vr.155, 1)[!KU( f_.156, ~ekI.177 )] )
              qed
            next
              case exp
              solve( (#vf.114, 0)[!KU( f_.115, ~ltkI.104 )] )
                case fresh
                solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                            sign(<x.132^x.133, 'g'^~tid.100>, ~x.105))) )
                  case Init_2_case_1
                  by solve( KU((#vr.137, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  by solve( (#vf.171, 0)[!KU( f_.172, ~x.105 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.169, 0)[!KU( f_.170, ~x.158 )] )
                    case fresh
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.169, 0)[!KU( f_.170, ~x.158 )] )
                    case fresh
                    by solve( (#vf.172, 0)[!KU( f_.173, ~x.105 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.137, 1), ~ekI.93) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.169, 0)[!KU( f_.170, ~x.105 )] )
                next
                  case mac
                  solve( (#vr.150, 1)[!KU( f_.152,
                                           sign(<x.132^x.133, 'g'^~tid.100>, ~x.105)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.180, 0)[!KU( f_.181, ~x.105 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.178, 0)[!KU( f_.179, ~x.167 )] )
                      case fresh
                      by solve( KU((#vr.137, 1), ~ekI.93) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.178, 0)[!KU( f_.179, ~x.167 )] )
                      case fresh
                      by solve( (#vf.181, 0)[!KU( f_.182, ~x.105 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.178, 0)[!KU( f_.179, ~x.105 )] )
                  next
                    case sign
                    by solve( (#vr.158, 1)[!KU( f_.160, ~x.105 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_3
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                by solve( (#vr.149, 1)[!KU( f_.150, ~ekR.169 )] )
              qed
            next
              case Resp_1
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                by solve( (#vr.155, 1)[!KU( f_.156, ~ekI.177 )] )
              qed
            next
              case exp
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                            sign(<x.132^x.133, 'g'^~tid.100>, ~x.105))) )
                  case Init_2_case_1
                  by solve( KU((#vr.137, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  solve( (#vf.169, 0)[!KU( f_.170, ~x.158 )] )
                    case fresh
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.137, 1), ~ekI.93) )
                next
                  case mac
                  solve( (#vr.150, 1)[!KU( f_.152,
                                           sign(<x.132^x.133, 'g'^~tid.100>, ~x.105)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    solve( (#vf.178, 0)[!KU( f_.179, ~x.167 )] )
                      case fresh
                      by solve( KU((#vr.137, 1), ~ekI.93) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  next
                    case sign
                    by solve( KU((#vr.137, 1), ~ekI.93) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_4
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                solve( (#vf.115, 0)[!KU( f_.116, ~ltkI.104 )] )
                  case fresh
                  by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.170 )] )
                qed
              qed
            next
              case Resp_1
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                solve( (#vf.115, 0)[!KU( f_.116, ~ltkI.104 )] )
                  case fresh
                  by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.178 )] )
                qed
              qed
            next
              case exp
              solve( (#vf.112, 0)[!KU( f_.113, ~x.105 )] )
                case fresh
                solve( (#vf.115, 0)[!KU( f_.116, ~ltkI.104 )] )
                  case fresh
                  solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                              sign(<x.133^x.134, 'g'^~tid.100>, ~x.105))) )
                    case Init_2_case_1
                    by solve( KU((#vr.138, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    solve( (#vf.176, 0)[!KU( f_.177, ~x.165 )] )
                      case fresh
                      by solve( KU((#vr.138, 1), ~ekI.93) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.138, 1), ~ekI.93) )
                  next
                    case mac
                    solve( (#vr.157, 1)[!KU( f_.159,
                                             sign(<x.133^x.134, 'g'^~tid.100>, ~x.105)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.138, 1), ~ekI.93) )
                    next
                      case Init_2_case_2
                      solve( (#vf.185, 0)[!KU( f_.186, ~x.174 )] )
                        case fresh
                        by solve( KU((#vr.138, 1), ~ekI.93) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.138, 1), ~ekI.93) )
                    next
                      case sign
                      by solve( KU((#vr.138, 1), ~ekI.93) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_5
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              by solve( (#vr.152, 1)[!KU( f_.153, ~ekR.172 )] )
            next
              case Resp_1
              by solve( (#vr.158, 1)[!KU( f_.159, ~ekI.180 )] )
            next
              case exp
              solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                          sign(<x.135^x.136, 'g'^~tid.100>, ~x.104))) )
                case Init_2_case_1
                by solve( KU((#vr.140, 1), ~ekI.93) )
              next
                case Init_2_case_2
                by solve( (#vf.168, 0)[!KU( f_.169, ~x.104 )] )
              next
                case Init_2_case_3
                solve( (#vf.166, 0)[!KU( f_.167, ~x.155 )] )
                  case fresh
                  by solve( KU((#vr.140, 1), ~ekI.93) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.166, 0)[!KU( f_.167, ~x.155 )] )
                  case fresh
                  by solve( (#vf.169, 0)[!KU( f_.170, ~x.104 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.140, 1), ~ekI.93) )
              next
                case Resp_1_case_2
                by solve( (#vf.166, 0)[!KU( f_.167, ~x.104 )] )
              next
                case mac
                solve( (#vr.147, 1)[!KU( f_.149,
                                         sign(<x.135^x.136, 'g'^~tid.100>, ~x.104)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.140, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  by solve( (#vf.177, 0)[!KU( f_.178, ~x.104 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                    case fresh
                    by solve( KU((#vr.140, 1), ~ekI.93) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                    case fresh
                    by solve( (#vf.178, 0)[!KU( f_.179, ~x.104 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.140, 1), ~ekI.93) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.175, 0)[!KU( f_.176, ~x.104 )] )
                next
                  case sign
                  by solve( (#vr.155, 1)[!KU( f_.157, ~x.104 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_6
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.117, 0)[!KU( f_.118, ~ltkR.105 )] )
                case fresh
                by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
              qed
            next
              case Resp_1
              solve( (#vf.117, 0)[!KU( f_.118, ~ltkR.105 )] )
                case fresh
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
              qed
            next
              case exp
              solve( (#vf.117, 0)[!KU( f_.118, ~ltkR.105 )] )
                case fresh
                solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                            sign(<x.136^x.137, 'g'^~tid.100>, ~x.104))) )
                  case Init_2_case_1
                  by solve( KU((#vr.141, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  by solve( (#vf.175, 0)[!KU( f_.176, ~x.104 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.173, 0)[!KU( f_.174, ~x.162 )] )
                    case fresh
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.173, 0)[!KU( f_.174, ~x.162 )] )
                    case fresh
                    by solve( (#vf.176, 0)[!KU( f_.177, ~x.104 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.141, 1), ~ekI.93) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.173, 0)[!KU( f_.174, ~x.104 )] )
                next
                  case mac
                  solve( (#vr.154, 1)[!KU( f_.156,
                                           sign(<x.136^x.137, 'g'^~tid.100>, ~x.104)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.184, 0)[!KU( f_.185, ~x.104 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                      case fresh
                      by solve( KU((#vr.141, 1), ~ekI.93) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                      case fresh
                      by solve( (#vf.185, 0)[!KU( f_.186, ~x.104 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.182, 0)[!KU( f_.183, ~x.104 )] )
                  next
                    case sign
                    by solve( (#vr.162, 1)[!KU( f_.164, ~x.104 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_7
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                by solve( (#vr.153, 1)[!KU( f_.154, ~ekR.173 )] )
              qed
            next
              case Resp_1
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekI.181 )] )
              qed
            next
              case exp
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                            sign(<x.136^x.137, 'g'^~tid.100>, ~x.104))) )
                  case Init_2_case_1
                  by solve( KU((#vr.141, 1), ~ekI.93) )
                next
                  case Init_2_case_2
                  solve( (#vf.173, 0)[!KU( f_.174, ~x.162 )] )
                    case fresh
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.141, 1), ~ekI.93) )
                next
                  case mac
                  solve( (#vr.154, 1)[!KU( f_.156,
                                           sign(<x.136^x.137, 'g'^~tid.100>, ~x.104)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                      case fresh
                      by solve( KU((#vr.141, 1), ~ekI.93) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  next
                    case sign
                    by solve( KU((#vr.141, 1), ~ekI.93) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_8
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                solve( (#vf.118, 0)[!KU( f_.119, ~ltkR.105 )] )
                  case fresh
                  by solve( (#vr.154, 1)[!KU( f_.155, ~ekR.174 )] )
                qed
              qed
            next
              case Resp_1
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                solve( (#vf.118, 0)[!KU( f_.119, ~ltkR.105 )] )
                  case fresh
                  by solve( (#vr.160, 1)[!KU( f_.161, ~ekI.182 )] )
                qed
              qed
            next
              case exp
              solve( (#vf.110, 0)[!KU( f_.111, ~x.104 )] )
                case fresh
                solve( (#vf.118, 0)[!KU( f_.119, ~ltkR.105 )] )
                  case fresh
                  solve( KU((#vf.107, 0), mac('g'^(~ekI.93*~ekR.94),
                                              sign(<x.137^x.138, 'g'^~tid.100>, ~x.104))) )
                    case Init_2_case_1
                    by solve( KU((#vr.142, 1), ~ekI.93) )
                  next
                    case Init_2_case_2
                    solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                      case fresh
                      by solve( KU((#vr.142, 1), ~ekI.93) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.142, 1), ~ekI.93) )
                  next
                    case mac
                    solve( (#vr.161, 1)[!KU( f_.163,
                                             sign(<x.137^x.138, 'g'^~tid.100>, ~x.104)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.142, 1), ~ekI.93) )
                    next
                      case Init_2_case_2
                      solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                        case fresh
                        by solve( KU((#vr.142, 1), ~ekI.93) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.142, 1), ~ekI.93) )
                    next
                      case sign
                      by solve( KU((#vr.142, 1), ~ekI.93) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case h
            solve( (#vr.42, 0)[!KU( f_.43, 'g'^(~ekI.93*~ekR.94) )] )
              case Init_1
              by solve( (#vr.115, 1)[!KU( f_.116, ~ekR.135 )] )
            next
              case Resp_1
              by solve( (#vr.121, 1)[!KU( f_.122, ~ekI.143 )] )
            next
              case exp
              by solve( KU((#vr.103, 1), ~ekI.93) )
            qed
          qed
        next
          case split_case_2
          by contradiction // non-normal terms
        qed
      next
        case Resp_1_case_2
        by solve( (#vf.70, 0)[!KU( f_.71, ~x.14 )] )
      next
        case sign
        by solve( (#vr.50, 1)[!KU( f_.52, ~x.14 )] )
      qed
    qed
  qed
next
  case Init_1_case_2
  by contradiction // from formulas
qed

lemma (modulo E) KI_Perfect_Forward_Secrecy_R:
  "not(Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
        (((((AcceptedR( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
            (not(Ex #r.8. Corrupt( I.1 ) @ #r.8))) &
           (not(Ex #r.9. Corrupt( R.2 ) @ #r.9))) &
          (K( sessKey.3 ) @ #k.5)) &
         (not(Ex #i2.10. SesskRev( ttest ) @ #i2.10))) &
        (not(Ex #i2.11 #i3.12 tpartner.13 kpartner.14.
              (SesskRev( tpartner.13 ) @ #i2.11) &
              (AcceptedI( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14
               ) @ #i3.12))))"
/* proof based on the same lemma modulo AC */
/*
doubly-guarded formula characterizing all attacks:
"Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
  (AcceptedR( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
  (K( sessKey.3 ) @ #k.5)
 &
  (All #r.8. (Corrupt( I.1 ) @ #r.8) ==> F) &
  (All #r.9. (Corrupt( R.2 ) @ #r.9) ==> F) &
  (All #i2.10. (SesskRev( ttest ) @ #i2.10) ==> F) &
  (All #i2.11 #i3.12 tpartner.13 kpartner.14.
    (SesskRev( tpartner.13 ) @ #i2.11) &
    (AcceptedI( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14 ) @ #i3.12)
   ==>
    F)"
*/
/*
proof by induction possible over the formula:
"(Ex ttest I.1 R.2 sessKey.3 #i1.4 #k.5 hki.6 hkr.7.
   (AcceptedR( ttest, I.1, R.2, hki.6, hkr.7, sessKey.3 ) @ #i1.4) &
   (K( sessKey.3 ) @ #k.5)
  &
   (All #r.8. (Corrupt( I.1 ) @ #r.8) ==> F) &
   (All #r.9. (Corrupt( R.2 ) @ #r.9) ==> F) &
   (All #i2.10. (SesskRev( ttest ) @ #i2.10) ==> F) &
   (All #i2.11 #i3.12 tpartner.13 kpartner.14.
     (SesskRev( tpartner.13 ) @ #i2.11) &
     (AcceptedI( tpartner.13, I.1, R.2, hki.6, hkr.7, kpartner.14 ) @ #i3.12)
    ==>
     F)) &
 (All ttest.15 I.16 R.17 sessKey.18 #i1.19 #k.20 hki.21 hkr.22.
   (AcceptedR( ttest.15, I.16, R.17, hki.21, hkr.22, sessKey.18
    ) @ #i1.19) &
   (K( sessKey.18 ) @ #k.20)
  ==>
   (Last(#k.20)) |
   (Last(#i1.19)) |
   (Ex #r.23. (Corrupt( I.16 ) @ #r.23) & All. (Last(#r.23)) ==> F) |
   (Ex #r.24. (Corrupt( R.17 ) @ #r.24) & All. (Last(#r.24)) ==> F) |
   (Ex #i2.25.
     (SesskRev( ttest.15 ) @ #i2.25)
    &
     All. (Last(#i2.25)) ==> F) |
   (Ex #i2.26 #i3.27 tpartner.28 kpartner.29.
     (SesskRev( tpartner.28 ) @ #i2.26) &
     (AcceptedI( tpartner.28, I.16, R.17, hki.21, hkr.22, kpartner.29
      ) @ #i3.27)
    &
     (All. (Last(#i3.27)) ==> F) & (All. (Last(#i2.26)) ==> F)))"
*/
simplify
solve( (#i1.4, 0)[!Pk( $I.11, pk(~x.12) )] )
  case Register_pk_evil
  by contradiction // from formulas
next
  case Register_pk_normal
  solve( (#i1.4, 1)[Resp_1( $I.11, $R.13, ~ltkR.14, ~ekR.8, hki.6 )] )
    case Resp_1_case_1
    solve( KU((#vf.15, 0), mac(x.10, sign(<hki.6, 'g'^~ekR.8>, ~x.12))) )
      case Init_2_case_1
      solve( KU((#vf.56, 0), mac(x.91^x.92,
                                 sign(<'g'^~ekR.8, 'g'^~ekI.48>, ~x.55))) )
        case Resp_1
        solve( splitEqs(1) )
          case split
          solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.137*~ekI.138)) )] )
            case Sessionkey_Reveal_case_1
            solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                        sign(<x.175^x.176, 'g'^~tid.144>, ~x.149))) )
              case Init_2_case_1
              solve( KU((#vf.189, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188))) )
                case Init_2
                by contradiction // cyclic
              next
                case mac
                solve( (#vr.227, 0)[!KU( f_.228, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.227, 1)[!KU( f_.229,
                                           sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.247, 1)[!KU( f_.248, ~ekR.266 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.227, 1)[!KU( f_.229,
                                           sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.253, 1)[!KU( f_.254, ~ekI.276 )] )
                  qed
                next
                  case exp
                  solve( (#vr.227, 1)[!KU( f_.229,
                                           sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.242, 1)[!KU( f_.244, ~x.188 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.201, 0)[!KU( f_.202, ~x.149 )] )
            next
              case Init_2_case_3
              solve( (#vf.199, 0)[!KU( f_.200, ~x.188 )] )
                case fresh
                solve( KU((#vf.189, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188))) )
                  case mac
                  solve( (#vr.234, 0)[!KU( f_.235, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                        )] )
                      case sign
                      by solve( (#vr.254, 1)[!KU( f_.255, ~ekR.273 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                        )] )
                      case sign
                      by solve( (#vr.260, 1)[!KU( f_.261, ~ekI.283 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.181>, ~x.188)
                                        )] )
                      case sign
                      by solve( KU((#vr.242, 1), ~ekR.137) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.199, 0)[!KU( f_.200, ~x.188 )] )
                case fresh
                by solve( (#vf.202, 0)[!KU( f_.203, ~x.149 )] )
              qed
            next
              case Resp_1_case_1
              solve( splitEqs(1) )
                case split
                by contradiction // from formulas
              qed
            next
              case Resp_1_case_2
              by solve( (#vf.199, 0)[!KU( f_.200, ~x.149 )] )
            next
              case mac
              solve( (#vr.180, 0)[!KU( f_.181, 'g'^(~ekR.137*~ekI.138) )] )
                case Init_1
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<x.175^x.176, 'g'^~tid.144>, ~x.149)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                next
                  case sign
                  by solve( (#vr.200, 1)[!KU( f_.201, ~ekR.219 )] )
                qed
              next
                case Resp_1
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<x.175^x.176, 'g'^~tid.144>, ~x.149)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                next
                  case sign
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekI.229 )] )
                qed
              next
                case exp
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<x.175^x.176, 'g'^~tid.144>, ~x.149)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.188, 1), ~ekR.137) )
                next
                  case Init_2_case_2
                  by solve( (#vf.217, 0)[!KU( f_.218, ~x.149 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.215, 0)[!KU( f_.216, ~x.204 )] )
                    case fresh
                    by solve( KU((#vr.188, 1), ~ekR.137) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.215, 0)[!KU( f_.216, ~x.204 )] )
                    case fresh
                    by solve( (#vf.218, 0)[!KU( f_.219, ~x.149 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.188, 1), ~ekR.137) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.215, 0)[!KU( f_.216, ~x.149 )] )
                next
                  case sign
                  by solve( (#vr.195, 1)[!KU( f_.197, ~x.149 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_2
            solve( (#vf.158, 0)[!KU( f_.159, ~ltkI.148 )] )
              case fresh
              solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<x.176^x.177, 'g'^~tid.144>, ~x.149))) )
                case Init_2_case_1
                solve( KU((#vf.196, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195))) )
                  case mac
                  solve( (#vr.234, 0)[!KU( f_.235, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case sign
                      by solve( (#vr.254, 1)[!KU( f_.255, ~ekR.273 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case sign
                      by solve( (#vr.260, 1)[!KU( f_.261, ~ekI.283 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.234, 1)[!KU( f_.236,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case sign
                      by solve( (#vr.249, 1)[!KU( f_.251, ~x.195 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                by solve( (#vf.208, 0)[!KU( f_.209, ~x.149 )] )
              next
                case Init_2_case_3
                solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                  case fresh
                  solve( KU((#vf.196, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195))) )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case mac
                    solve( (#vr.241, 0)[!KU( f_.242, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.241, 1)[!KU( f_.243,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.261, 1)[!KU( f_.262, ~ekR.280 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.241, 1)[!KU( f_.243,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.267, 1)[!KU( f_.268, ~ekI.290 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.241, 1)[!KU( f_.243,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( KU((#vr.249, 1), ~ekR.137) )
                      qed
                    qed
                  qed
                qed
              next
                case Init_2_case_4
                solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                  case fresh
                  by solve( (#vf.209, 0)[!KU( f_.210, ~x.149 )] )
                qed
              next
                case Resp_1_case_1
                by solve( splitEqs(1) )
              next
                case Resp_1_case_2
                by solve( (#vf.206, 0)[!KU( f_.207, ~x.149 )] )
              next
                case mac
                solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Init_2_case_3
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Init_2_case_4
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Resp_1_case_1
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Resp_1_case_2
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case sign
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Init_2_case_3
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Init_2_case_4
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Resp_1_case_1
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Resp_1_case_2
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  qed
                next
                  case exp
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.137) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.224, 0)[!KU( f_.225, ~x.149 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.222, 0)[!KU( f_.223, ~x.211 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.137) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.222, 0)[!KU( f_.223, ~x.211 )] )
                      case fresh
                      by solve( (#vf.225, 0)[!KU( f_.226, ~x.149 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.195, 1), ~ekR.137) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.222, 0)[!KU( f_.223, ~x.149 )] )
                  next
                    case sign
                    by solve( (#vr.202, 1)[!KU( f_.204, ~x.149 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_3
            solve( (#vf.156, 0)[!KU( f_.157, ~x.149 )] )
              case fresh
              solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<x.176^x.177, 'g'^~tid.144>, ~x.149))) )
                case Init_2_case_1
                solve( KU((#vf.196, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195))) )
                  case Init_2
                  by contradiction // cyclic
                next
                  case mac
                  solve( (#vr.235, 0)[!KU( f_.236, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.235, 1)[!KU( f_.237,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.255, 1)[!KU( f_.256, ~ekR.274 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.235, 1)[!KU( f_.237,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.261, 1)[!KU( f_.262, ~ekI.284 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.235, 1)[!KU( f_.237,
                                             sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.250, 1)[!KU( f_.252, ~x.195 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                  case fresh
                  solve( KU((#vf.196, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195))) )
                    case mac
                    solve( (#vr.242, 0)[!KU( f_.243, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case sign
                        by solve( (#vr.262, 1)[!KU( f_.263, ~ekR.281 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case sign
                        by solve( (#vr.268, 1)[!KU( f_.269, ~ekI.291 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.188>, ~x.195)
                                          )] )
                        case sign
                        by solve( KU((#vr.250, 1), ~ekR.137) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                by solve( splitEqs(1) )
              next
                case mac
                solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case Resp_1
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  next
                    case sign
                    by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case Resp_1
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  next
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                  qed
                next
                  case exp
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<x.176^x.177, 'g'^~tid.144>, ~x.149)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.137) )
                  next
                    case Init_2_case_2
                    solve( (#vf.222, 0)[!KU( f_.223, ~x.211 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.137) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.195, 1), ~ekR.137) )
                  next
                    case sign
                    by solve( KU((#vr.195, 1), ~ekR.137) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_4
            solve( (#vf.156, 0)[!KU( f_.157, ~x.149 )] )
              case fresh
              solve( (#vf.159, 0)[!KU( f_.160, ~ltkI.148 )] )
                case fresh
                solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<x.177^x.178, 'g'^~tid.144>, ~x.149))) )
                  case Init_2_case_1
                  solve( KU((#vf.203, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202))) )
                    case mac
                    solve( (#vr.242, 0)[!KU( f_.243, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                          )] )
                        case sign
                        by solve( (#vr.262, 1)[!KU( f_.263, ~ekR.281 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                          )] )
                        case sign
                        by solve( (#vr.268, 1)[!KU( f_.269, ~ekI.291 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.242, 1)[!KU( f_.244,
                                               sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                          )] )
                        case sign
                        by solve( (#vr.257, 1)[!KU( f_.259, ~x.202 )] )
                      qed
                    qed
                  qed
                next
                  case Init_2_case_2
                  solve( (#vf.213, 0)[!KU( f_.214, ~x.202 )] )
                    case fresh
                    solve( KU((#vf.203, 0), mac('g'^(~ekR.137*~ekI.138),
                                                sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202))) )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case mac
                      solve( (#vr.249, 0)[!KU( f_.250, 'g'^(~ekR.137*~ekI.138) )] )
                        case Init_1
                        solve( (#vr.249, 1)[!KU( f_.251,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                            )] )
                          case Init_2
                          by contradiction // cyclic
                        next
                          case sign
                          by solve( (#vr.269, 1)[!KU( f_.270, ~ekR.288 )] )
                        qed
                      next
                        case Resp_1
                        solve( (#vr.249, 1)[!KU( f_.251,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                            )] )
                          case Init_2
                          by contradiction // cyclic
                        next
                          case sign
                          by solve( (#vr.275, 1)[!KU( f_.276, ~ekI.298 )] )
                        qed
                      next
                        case exp
                        solve( (#vr.249, 1)[!KU( f_.251,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.195>, ~x.202)
                                            )] )
                          case Init_2
                          by contradiction // cyclic
                        next
                          case sign
                          by solve( KU((#vr.257, 1), ~ekR.137) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Resp_1
                  by solve( splitEqs(1) )
                next
                  case mac
                  solve( (#vr.194, 0)[!KU( f_.195, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<x.177^x.178, 'g'^~tid.144>, ~x.149)
                                        )] )
                      case Init_2_case_1
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.233 )] )
                    next
                      case Init_2_case_2
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.233 )] )
                    next
                      case Resp_1
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.233 )] )
                    next
                      case sign
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.233 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<x.177^x.178, 'g'^~tid.144>, ~x.149)
                                        )] )
                      case Init_2_case_1
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.243 )] )
                    next
                      case Init_2_case_2
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.243 )] )
                    next
                      case Resp_1
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.243 )] )
                    next
                      case sign
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.243 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<x.177^x.178, 'g'^~tid.144>, ~x.149)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.202, 1), ~ekR.137) )
                    next
                      case Init_2_case_2
                      solve( (#vf.229, 0)[!KU( f_.230, ~x.218 )] )
                        case fresh
                        by solve( KU((#vr.202, 1), ~ekR.137) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.202, 1), ~ekR.137) )
                    next
                      case sign
                      by solve( KU((#vr.202, 1), ~ekR.137) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_5
            solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                        sign(<x.179^x.180, 'g'^~tid.144>, ~x.148))) )
              case Init_2_case_1
              solve( KU((#vf.193, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192))) )
                case Resp_1
                solve( splitEqs(1) )
                  case split
                  by contradiction // from formulas
                qed
              next
                case mac
                solve( (#vr.233, 0)[!KU( f_.234, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.233, 1)[!KU( f_.235,
                                           sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                      )] )
                    case Resp_1
                    by solve( (#vr.253, 1)[!KU( f_.254, ~ekR.272 )] )
                  next
                    case sign
                    by solve( (#vr.253, 1)[!KU( f_.254, ~ekR.272 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.233, 1)[!KU( f_.235,
                                           sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                      )] )
                    case Resp_1
                    by solve( (#vr.259, 1)[!KU( f_.260, ~ekI.282 )] )
                  next
                    case sign
                    by solve( (#vr.259, 1)[!KU( f_.260, ~ekI.282 )] )
                  qed
                next
                  case exp
                  solve( (#vr.233, 1)[!KU( f_.235,
                                           sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                      )] )
                    case Resp_1
                    by solve( KU((#vr.241, 1), ~ekR.137) )
                  next
                    case sign
                    by solve( (#vr.248, 1)[!KU( f_.250, ~x.192 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.205, 0)[!KU( f_.206, ~x.148 )] )
            next
              case Init_2_case_3
              solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                case fresh
                solve( KU((#vf.193, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192))) )
                  case mac
                  solve( (#vr.240, 0)[!KU( f_.241, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                        )] )
                      case sign
                      by solve( (#vr.260, 1)[!KU( f_.261, ~ekR.279 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                        )] )
                      case sign
                      by solve( (#vr.266, 1)[!KU( f_.267, ~ekI.289 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.185>, ~x.192)
                                        )] )
                      case sign
                      by solve( KU((#vr.248, 1), ~ekR.137) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                case fresh
                by solve( (#vf.206, 0)[!KU( f_.207, ~x.148 )] )
              qed
            next
              case Resp_1_case_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case Resp_1_case_2
              by solve( (#vf.203, 0)[!KU( f_.204, ~x.148 )] )
            next
              case mac
              solve( (#vr.184, 0)[!KU( f_.185, 'g'^(~ekR.137*~ekI.138) )] )
                case Init_1
                solve( (#vr.184, 1)[!KU( f_.186,
                                         sign(<x.179^x.180, 'g'^~tid.144>, ~x.148)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                next
                  case sign
                  by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                qed
              next
                case Resp_1
                solve( (#vr.184, 1)[!KU( f_.186,
                                         sign(<x.179^x.180, 'g'^~tid.144>, ~x.148)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                next
                  case sign
                  by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                qed
              next
                case exp
                solve( (#vr.184, 1)[!KU( f_.186,
                                         sign(<x.179^x.180, 'g'^~tid.144>, ~x.148)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.192, 1), ~ekR.137) )
                next
                  case Init_2_case_2
                  by solve( (#vf.221, 0)[!KU( f_.222, ~x.148 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.219, 0)[!KU( f_.220, ~x.208 )] )
                    case fresh
                    by solve( KU((#vr.192, 1), ~ekR.137) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.219, 0)[!KU( f_.220, ~x.208 )] )
                    case fresh
                    by solve( (#vf.222, 0)[!KU( f_.223, ~x.148 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.192, 1), ~ekR.137) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.219, 0)[!KU( f_.220, ~x.148 )] )
                next
                  case sign
                  by solve( (#vr.199, 1)[!KU( f_.201, ~x.148 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_6
            solve( (#vf.161, 0)[!KU( f_.162, ~ltkR.149 )] )
              case fresh
              solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<x.180^x.181, 'g'^~tid.144>, ~x.148))) )
                case Init_2_case_1
                solve( KU((#vf.200, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199))) )
                  case mac
                  solve( (#vr.240, 0)[!KU( f_.241, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case sign
                      by solve( (#vr.260, 1)[!KU( f_.261, ~ekR.279 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case sign
                      by solve( (#vr.266, 1)[!KU( f_.267, ~ekI.289 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.240, 1)[!KU( f_.242,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case sign
                      by solve( (#vr.255, 1)[!KU( f_.257, ~x.199 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                by solve( (#vf.212, 0)[!KU( f_.213, ~x.148 )] )
              next
                case Init_2_case_3
                solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                  case fresh
                  solve( KU((#vf.200, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199))) )
                    case Resp_1
                    by solve( splitEqs(1) )
                  next
                    case mac
                    solve( (#vr.247, 0)[!KU( f_.248, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.247, 1)[!KU( f_.249,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case Resp_1
                        by solve( (#vr.267, 1)[!KU( f_.268, ~ekR.286 )] )
                      next
                        case sign
                        by solve( (#vr.267, 1)[!KU( f_.268, ~ekR.286 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.247, 1)[!KU( f_.249,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case Resp_1
                        by solve( (#vr.273, 1)[!KU( f_.274, ~ekI.296 )] )
                      next
                        case sign
                        by solve( (#vr.273, 1)[!KU( f_.274, ~ekI.296 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.247, 1)[!KU( f_.249,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case Resp_1
                        by solve( KU((#vr.255, 1), ~ekR.137) )
                      next
                        case sign
                        by solve( KU((#vr.255, 1), ~ekR.137) )
                      qed
                    qed
                  qed
                qed
              next
                case Init_2_case_4
                solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                  case fresh
                  by solve( (#vf.213, 0)[!KU( f_.214, ~x.148 )] )
                qed
              next
                case Resp_1_case_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case Resp_1_case_2
                by solve( (#vf.210, 0)[!KU( f_.211, ~x.148 )] )
              next
                case mac
                solve( (#vr.191, 0)[!KU( f_.192, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Init_2_case_3
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Init_2_case_4
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Resp_1_case_1
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Resp_1_case_2
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case sign
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Init_2_case_3
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Init_2_case_4
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Resp_1_case_1
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Resp_1_case_2
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case sign
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  qed
                next
                  case exp
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.199, 1), ~ekR.137) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.228, 0)[!KU( f_.229, ~x.148 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.226, 0)[!KU( f_.227, ~x.215 )] )
                      case fresh
                      by solve( KU((#vr.199, 1), ~ekR.137) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.226, 0)[!KU( f_.227, ~x.215 )] )
                      case fresh
                      by solve( (#vf.229, 0)[!KU( f_.230, ~x.148 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.199, 1), ~ekR.137) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.226, 0)[!KU( f_.227, ~x.148 )] )
                  next
                    case sign
                    by solve( (#vr.206, 1)[!KU( f_.208, ~x.148 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_7
            solve( (#vf.154, 0)[!KU( f_.155, ~x.148 )] )
              case fresh
              solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                          sign(<x.180^x.181, 'g'^~tid.144>, ~x.148))) )
                case Init_2_case_1
                solve( KU((#vf.200, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199))) )
                  case Resp_1
                  by solve( splitEqs(1) )
                next
                  case mac
                  solve( (#vr.241, 0)[!KU( f_.242, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.241, 1)[!KU( f_.243,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case Resp_1
                      by solve( (#vr.261, 1)[!KU( f_.262, ~ekR.280 )] )
                    next
                      case sign
                      by solve( (#vr.261, 1)[!KU( f_.262, ~ekR.280 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.241, 1)[!KU( f_.243,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case Resp_1
                      by solve( (#vr.267, 1)[!KU( f_.268, ~ekI.290 )] )
                    next
                      case sign
                      by solve( (#vr.267, 1)[!KU( f_.268, ~ekI.290 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.241, 1)[!KU( f_.243,
                                             sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                        )] )
                      case Resp_1
                      by solve( KU((#vr.249, 1), ~ekR.137) )
                    next
                      case sign
                      by solve( (#vr.256, 1)[!KU( f_.258, ~x.199 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                  case fresh
                  solve( KU((#vf.200, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199))) )
                    case mac
                    solve( (#vr.248, 0)[!KU( f_.249, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case sign
                        by solve( (#vr.268, 1)[!KU( f_.269, ~ekR.287 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case sign
                        by solve( (#vr.274, 1)[!KU( f_.275, ~ekI.297 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.192>, ~x.199)
                                          )] )
                        case sign
                        by solve( KU((#vr.256, 1), ~ekR.137) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case mac
                solve( (#vr.191, 0)[!KU( f_.192, 'g'^(~ekR.137*~ekI.138) )] )
                  case Init_1
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case Resp_1
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  next
                    case sign
                    by solve( (#vr.211, 1)[!KU( f_.212, ~ekR.230 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case Resp_1
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  next
                    case sign
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekI.240 )] )
                  qed
                next
                  case exp
                  solve( (#vr.191, 1)[!KU( f_.193,
                                           sign(<x.180^x.181, 'g'^~tid.144>, ~x.148)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.199, 1), ~ekR.137) )
                  next
                    case Init_2_case_2
                    solve( (#vf.226, 0)[!KU( f_.227, ~x.215 )] )
                      case fresh
                      by solve( KU((#vr.199, 1), ~ekR.137) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.199, 1), ~ekR.137) )
                  next
                    case sign
                    by solve( KU((#vr.199, 1), ~ekR.137) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_8
            solve( (#vf.154, 0)[!KU( f_.155, ~x.148 )] )
              case fresh
              solve( (#vf.162, 0)[!KU( f_.163, ~ltkR.149 )] )
                case fresh
                solve( KU((#vf.151, 0), mac('g'^(~ekR.137*~ekI.138),
                                            sign(<x.181^x.182, 'g'^~tid.144>, ~x.148))) )
                  case Init_2_case_1
                  solve( KU((#vf.207, 0), mac('g'^(~ekR.137*~ekI.138),
                                              sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206))) )
                    case mac
                    solve( (#vr.248, 0)[!KU( f_.249, 'g'^(~ekR.137*~ekI.138) )] )
                      case Init_1
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                          )] )
                        case sign
                        by solve( (#vr.268, 1)[!KU( f_.269, ~ekR.287 )] )
                      qed
                    next
                      case Resp_1
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                          )] )
                        case sign
                        by solve( (#vr.274, 1)[!KU( f_.275, ~ekI.297 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.248, 1)[!KU( f_.250,
                                               sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                          )] )
                        case sign
                        by solve( (#vr.263, 1)[!KU( f_.265, ~x.206 )] )
                      qed
                    qed
                  qed
                next
                  case Init_2_case_2
                  solve( (#vf.217, 0)[!KU( f_.218, ~x.206 )] )
                    case fresh
                    solve( KU((#vf.207, 0), mac('g'^(~ekR.137*~ekI.138),
                                                sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206))) )
                      case Resp_1
                      by solve( splitEqs(1) )
                    next
                      case mac
                      solve( (#vr.255, 0)[!KU( f_.256, 'g'^(~ekR.137*~ekI.138) )] )
                        case Init_1
                        solve( (#vr.255, 1)[!KU( f_.257,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                            )] )
                          case Resp_1
                          by solve( (#vr.275, 1)[!KU( f_.276, ~ekR.294 )] )
                        next
                          case sign
                          by solve( (#vr.275, 1)[!KU( f_.276, ~ekR.294 )] )
                        qed
                      next
                        case Resp_1
                        solve( (#vr.255, 1)[!KU( f_.257,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                            )] )
                          case Resp_1
                          by solve( (#vr.281, 1)[!KU( f_.282, ~ekI.304 )] )
                        next
                          case sign
                          by solve( (#vr.281, 1)[!KU( f_.282, ~ekI.304 )] )
                        qed
                      next
                        case exp
                        solve( (#vr.255, 1)[!KU( f_.257,
                                                 sign(<'g'^~tid.144, 'g'^~ekI.199>, ~x.206)
                                            )] )
                          case Resp_1
                          by solve( KU((#vr.263, 1), ~ekR.137) )
                        next
                          case sign
                          by solve( KU((#vr.263, 1), ~ekR.137) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Resp_1
                  solve( splitEqs(1) )
                    case split_case_1
                    by solve( splitEqs(1) )
                  next
                    case split_case_2
                    by contradiction // non-normal terms
                  qed
                next
                  case mac
                  solve( (#vr.198, 0)[!KU( f_.199, 'g'^(~ekR.137*~ekI.138) )] )
                    case Init_1
                    solve( (#vr.198, 1)[!KU( f_.200,
                                             sign(<x.181^x.182, 'g'^~tid.144>, ~x.148)
                                        )] )
                      case Init_2_case_1
                      by solve( (#vr.218, 1)[!KU( f_.219, ~ekR.237 )] )
                    next
                      case Init_2_case_2
                      by solve( (#vr.218, 1)[!KU( f_.219, ~ekR.237 )] )
                    next
                      case Resp_1
                      by solve( (#vr.218, 1)[!KU( f_.219, ~ekR.237 )] )
                    next
                      case sign
                      by solve( (#vr.218, 1)[!KU( f_.219, ~ekR.237 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vr.198, 1)[!KU( f_.200,
                                             sign(<x.181^x.182, 'g'^~tid.144>, ~x.148)
                                        )] )
                      case Init_2_case_1
                      by solve( (#vr.224, 1)[!KU( f_.225, ~ekI.247 )] )
                    next
                      case Init_2_case_2
                      by solve( (#vr.224, 1)[!KU( f_.225, ~ekI.247 )] )
                    next
                      case Resp_1
                      by solve( (#vr.224, 1)[!KU( f_.225, ~ekI.247 )] )
                    next
                      case sign
                      by solve( (#vr.224, 1)[!KU( f_.225, ~ekI.247 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.198, 1)[!KU( f_.200,
                                             sign(<x.181^x.182, 'g'^~tid.144>, ~x.148)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.206, 1), ~ekR.137) )
                    next
                      case Init_2_case_2
                      solve( (#vf.233, 0)[!KU( f_.234, ~x.222 )] )
                        case fresh
                        by solve( KU((#vr.206, 1), ~ekR.137) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.206, 1), ~ekR.137) )
                    next
                      case sign
                      by solve( KU((#vr.206, 1), ~ekR.137) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case h
            solve( (#vr.141, 0)[!KU( f_.142, 'g'^(~ekR.137*~ekI.138) )] )
              case Init_1
              by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.178 )] )
            next
              case Resp_1
              by solve( (#vr.165, 1)[!KU( f_.166, ~ekI.188 )] )
            next
              case exp
              by solve( KU((#vr.147, 1), ~ekR.137) )
            qed
          qed
        qed
      next
        case mac
        solve( (#vr.98, 1)[!KU( f_.100, sign(<'g'^~ekR.8, 'g'^~ekI.48>, ~x.55)
                           )] )
          case Resp_1
          solve( splitEqs(1) )
            case split
            solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.147*~ekI.148)) )] )
              case Sessionkey_Reveal_case_1
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.202, 1)[!KU( f_.203, ~ekR.221 )] )
              next
                case Resp_1
                by solve( (#vr.208, 1)[!KU( f_.209, ~ekI.231 )] )
              next
                case exp
                solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                            sign(<x.185^x.186, 'g'^~tid.154>, ~x.159))) )
                  case Init_2_case_1
                  by solve( KU((#vr.190, 1), ~ekR.147) )
                next
                  case Init_2_case_2
                  by solve( (#vf.218, 0)[!KU( f_.219, ~x.159 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.216, 0)[!KU( f_.217, ~x.205 )] )
                    case fresh
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.216, 0)[!KU( f_.217, ~x.205 )] )
                    case fresh
                    by solve( (#vf.219, 0)[!KU( f_.220, ~x.159 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.190, 1), ~ekR.147) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.216, 0)[!KU( f_.217, ~x.159 )] )
                next
                  case mac
                  solve( (#vr.197, 1)[!KU( f_.199,
                                           sign(<x.185^x.186, 'g'^~tid.154>, ~x.159)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.227, 0)[!KU( f_.228, ~x.159 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.225, 0)[!KU( f_.226, ~x.214 )] )
                      case fresh
                      by solve( KU((#vr.190, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.225, 0)[!KU( f_.226, ~x.214 )] )
                      case fresh
                      by solve( (#vf.228, 0)[!KU( f_.229, ~x.159 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.225, 0)[!KU( f_.226, ~x.159 )] )
                  next
                    case sign
                    by solve( (#vr.205, 1)[!KU( f_.207, ~x.159 )] )
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_2
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  by solve( (#vr.203, 1)[!KU( f_.204, ~ekR.222 )] )
                qed
              next
                case Resp_1
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  by solve( (#vr.209, 1)[!KU( f_.210, ~ekI.232 )] )
                qed
              next
                case exp
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.186^x.187, 'g'^~tid.154>, ~x.159))) )
                    case Init_2_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.225, 0)[!KU( f_.226, ~x.159 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( (#vf.226, 0)[!KU( f_.227, ~x.159 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.223, 0)[!KU( f_.224, ~x.159 )] )
                  next
                    case mac
                    solve( (#vr.204, 1)[!KU( f_.206,
                                             sign(<x.186^x.187, 'g'^~tid.154>, ~x.159)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.234, 0)[!KU( f_.235, ~x.159 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( KU((#vr.191, 1), ~ekR.147) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( (#vf.235, 0)[!KU( f_.236, ~x.159 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.232, 0)[!KU( f_.233, ~x.159 )] )
                    next
                      case sign
                      by solve( (#vr.212, 1)[!KU( f_.214, ~x.159 )] )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_3
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  by solve( (#vr.203, 1)[!KU( f_.204, ~ekR.222 )] )
                qed
              next
                case Resp_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  by solve( (#vr.209, 1)[!KU( f_.210, ~ekI.232 )] )
                qed
              next
                case exp
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.186^x.187, 'g'^~tid.154>, ~x.159))) )
                    case Init_2_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case mac
                    solve( (#vr.204, 1)[!KU( f_.206,
                                             sign(<x.186^x.187, 'g'^~tid.154>, ~x.159)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( KU((#vr.191, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case sign
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_4
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                  qed
                qed
              next
                case Resp_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                  qed
                qed
              next
                case exp
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                                sign(<x.187^x.188, 'g'^~tid.154>, ~x.159))) )
                      case Init_2_case_1
                      by solve( KU((#vr.192, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.230, 0)[!KU( f_.231, ~x.219 )] )
                        case fresh
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.192, 1), ~ekR.147) )
                    next
                      case mac
                      solve( (#vr.211, 1)[!KU( f_.213,
                                               sign(<x.187^x.188, 'g'^~tid.154>, ~x.159)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      next
                        case Init_2_case_2
                        solve( (#vf.239, 0)[!KU( f_.240, ~x.228 )] )
                          case fresh
                          by solve( KU((#vr.192, 1), ~ekR.147) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      next
                        case sign
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      qed
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_5
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.225 )] )
              next
                case Resp_1
                by solve( (#vr.212, 1)[!KU( f_.213, ~ekI.235 )] )
              next
                case exp
                solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                            sign(<x.189^x.190, 'g'^~tid.154>, ~x.158))) )
                  case Init_2_case_1
                  by solve( KU((#vr.194, 1), ~ekR.147) )
                next
                  case Init_2_case_2
                  by solve( (#vf.222, 0)[!KU( f_.223, ~x.158 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.220, 0)[!KU( f_.221, ~x.209 )] )
                    case fresh
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.220, 0)[!KU( f_.221, ~x.209 )] )
                    case fresh
                    by solve( (#vf.223, 0)[!KU( f_.224, ~x.158 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.194, 1), ~ekR.147) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.220, 0)[!KU( f_.221, ~x.158 )] )
                next
                  case mac
                  solve( (#vr.201, 1)[!KU( f_.203,
                                           sign(<x.189^x.190, 'g'^~tid.154>, ~x.158)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.231, 0)[!KU( f_.232, ~x.158 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.229, 0)[!KU( f_.230, ~x.218 )] )
                      case fresh
                      by solve( KU((#vr.194, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.229, 0)[!KU( f_.230, ~x.218 )] )
                      case fresh
                      by solve( (#vf.232, 0)[!KU( f_.233, ~x.158 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.229, 0)[!KU( f_.230, ~x.158 )] )
                  next
                    case sign
                    by solve( (#vr.209, 1)[!KU( f_.211, ~x.158 )] )
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_6
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                qed
              next
                case Resp_1
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                qed
              next
                case exp
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.190^x.191, 'g'^~tid.154>, ~x.158))) )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.229, 0)[!KU( f_.230, ~x.158 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( (#vf.230, 0)[!KU( f_.231, ~x.158 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.227, 0)[!KU( f_.228, ~x.158 )] )
                  next
                    case mac
                    solve( (#vr.208, 1)[!KU( f_.210,
                                             sign(<x.190^x.191, 'g'^~tid.154>, ~x.158)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.238, 0)[!KU( f_.239, ~x.158 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( KU((#vr.195, 1), ~ekR.147) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( (#vf.239, 0)[!KU( f_.240, ~x.158 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.236, 0)[!KU( f_.237, ~x.158 )] )
                    next
                      case sign
                      by solve( (#vr.216, 1)[!KU( f_.218, ~x.158 )] )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_7
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                qed
              next
                case Resp_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                qed
              next
                case exp
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.190^x.191, 'g'^~tid.154>, ~x.158))) )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case mac
                    solve( (#vr.208, 1)[!KU( f_.210,
                                             sign(<x.190^x.191, 'g'^~tid.154>, ~x.158)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( KU((#vr.195, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case sign
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_8
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    by solve( (#vr.208, 1)[!KU( f_.209, ~ekR.227 )] )
                  qed
                qed
              next
                case Resp_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    by solve( (#vr.214, 1)[!KU( f_.215, ~ekI.237 )] )
                  qed
                qed
              next
                case exp
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                                sign(<x.191^x.192, 'g'^~tid.154>, ~x.158))) )
                      case Init_2_case_1
                      by solve( KU((#vr.196, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.234, 0)[!KU( f_.235, ~x.223 )] )
                        case fresh
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.196, 1), ~ekR.147) )
                    next
                      case mac
                      solve( (#vr.215, 1)[!KU( f_.217,
                                               sign(<x.191^x.192, 'g'^~tid.154>, ~x.158)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      next
                        case Init_2_case_2
                        solve( (#vf.243, 0)[!KU( f_.244, ~x.232 )] )
                          case fresh
                          by solve( KU((#vr.196, 1), ~ekR.147) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      next
                        case sign
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      qed
                    qed
                  qed
                qed
              qed
            next
              case h
              solve( (#vr.98, 0)[!KU( f_.99, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.169, 1)[!KU( f_.170, ~ekR.188 )] )
              next
                case Resp_1
                by solve( (#vr.175, 1)[!KU( f_.176, ~ekI.198 )] )
              next
                case exp
                by solve( KU((#vr.157, 1), ~ekR.147) )
              qed
            qed
          qed
        next
          case sign
          by solve( (#vr.106, 1)[!KU( f_.108, ~x.55 )] )
        qed
      qed
    next
      case Init_2_case_2
      by solve( (#vf.68, 0)[!KU( f_.69, ~x.12 )] )
    next
      case Init_2_case_3
      solve( (#vf.66, 0)[!KU( f_.67, ~x.55 )] )
        case fresh
        solve( KU((#vf.56, 0), mac(x.92^x.93,
                                   sign(<'g'^~ekR.8, 'g'^~ekI.48>, ~x.55))) )
          case mac
          solve( (#vr.105, 1)[!KU( f_.107, sign(<'g'^~ekR.8, 'g'^~ekI.48>, ~x.55)
                              )] )
            case sign
            solve( splitEqs(1) )
              case split
              solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.118*~ekI.119)) )] )
                case Sessionkey_Reveal_case_1
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.192 )] )
                next
                  case Resp_1
                  by solve( (#vr.179, 1)[!KU( f_.180, ~ekI.202 )] )
                next
                  case exp
                  solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                              sign(<x.156^x.157, 'g'^~tid.125>, ~x.130))) )
                    case Init_2_case_1
                    by solve( KU((#vr.161, 1), ~ekR.118) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.189, 0)[!KU( f_.190, ~x.130 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                      case fresh
                      by solve( KU((#vr.161, 1), ~ekR.118) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                      case fresh
                      by solve( (#vf.190, 0)[!KU( f_.191, ~x.130 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.161, 1), ~ekR.118) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.187, 0)[!KU( f_.188, ~x.130 )] )
                  next
                    case mac
                    solve( (#vr.168, 1)[!KU( f_.170,
                                             sign(<x.156^x.157, 'g'^~tid.125>, ~x.130)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.161, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.198, 0)[!KU( f_.199, ~x.130 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                        case fresh
                        by solve( KU((#vr.161, 1), ~ekR.118) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                        case fresh
                        by solve( (#vf.199, 0)[!KU( f_.200, ~x.130 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.161, 1), ~ekR.118) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.196, 0)[!KU( f_.197, ~x.130 )] )
                    next
                      case sign
                      by solve( (#vr.176, 1)[!KU( f_.178, ~x.130 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_2
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.139, 0)[!KU( f_.140, ~ltkI.129 )] )
                    case fresh
                    by solve( (#vr.174, 1)[!KU( f_.175, ~ekR.193 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.139, 0)[!KU( f_.140, ~ltkI.129 )] )
                    case fresh
                    by solve( (#vr.180, 1)[!KU( f_.181, ~ekI.203 )] )
                  qed
                next
                  case exp
                  solve( (#vf.139, 0)[!KU( f_.140, ~ltkI.129 )] )
                    case fresh
                    solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                sign(<x.157^x.158, 'g'^~tid.125>, ~x.130))) )
                      case Init_2_case_1
                      by solve( KU((#vr.162, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.196, 0)[!KU( f_.197, ~x.130 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                        case fresh
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                        case fresh
                        by solve( (#vf.197, 0)[!KU( f_.198, ~x.130 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.162, 1), ~ekR.118) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.194, 0)[!KU( f_.195, ~x.130 )] )
                    next
                      case mac
                      solve( (#vr.175, 1)[!KU( f_.177,
                                               sign(<x.157^x.158, 'g'^~tid.125>, ~x.130)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.205, 0)[!KU( f_.206, ~x.130 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                          case fresh
                          by solve( KU((#vr.162, 1), ~ekR.118) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                          case fresh
                          by solve( (#vf.206, 0)[!KU( f_.207, ~x.130 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.203, 0)[!KU( f_.204, ~x.130 )] )
                      next
                        case sign
                        by solve( (#vr.183, 1)[!KU( f_.185, ~x.130 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_3
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    by solve( (#vr.174, 1)[!KU( f_.175, ~ekR.193 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    by solve( (#vr.180, 1)[!KU( f_.181, ~ekI.203 )] )
                  qed
                next
                  case exp
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                sign(<x.157^x.158, 'g'^~tid.125>, ~x.130))) )
                      case Init_2_case_1
                      by solve( KU((#vr.162, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      solve( (#vf.194, 0)[!KU( f_.195, ~x.183 )] )
                        case fresh
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.162, 1), ~ekR.118) )
                    next
                      case mac
                      solve( (#vr.175, 1)[!KU( f_.177,
                                               sign(<x.157^x.158, 'g'^~tid.125>, ~x.130)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        solve( (#vf.203, 0)[!KU( f_.204, ~x.192 )] )
                          case fresh
                          by solve( KU((#vr.162, 1), ~ekR.118) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      next
                        case sign
                        by solve( KU((#vr.162, 1), ~ekR.118) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_4
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    solve( (#vf.140, 0)[!KU( f_.141, ~ltkI.129 )] )
                      case fresh
                      by solve( (#vr.175, 1)[!KU( f_.176, ~ekR.194 )] )
                    qed
                  qed
                next
                  case Resp_1
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    solve( (#vf.140, 0)[!KU( f_.141, ~ltkI.129 )] )
                      case fresh
                      by solve( (#vr.181, 1)[!KU( f_.182, ~ekI.204 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.137, 0)[!KU( f_.138, ~x.130 )] )
                    case fresh
                    solve( (#vf.140, 0)[!KU( f_.141, ~ltkI.129 )] )
                      case fresh
                      solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                  sign(<x.158^x.159, 'g'^~tid.125>, ~x.130))) )
                        case Init_2_case_1
                        by solve( KU((#vr.163, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                          case fresh
                          by solve( KU((#vr.163, 1), ~ekR.118) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.163, 1), ~ekR.118) )
                      next
                        case mac
                        solve( (#vr.182, 1)[!KU( f_.184,
                                                 sign(<x.158^x.159, 'g'^~tid.125>, ~x.130)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.163, 1), ~ekR.118) )
                        next
                          case Init_2_case_2
                          solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                            case fresh
                            by solve( KU((#vr.163, 1), ~ekR.118) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.163, 1), ~ekR.118) )
                        next
                          case sign
                          by solve( KU((#vr.163, 1), ~ekR.118) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_5
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.196 )] )
                next
                  case Resp_1
                  by solve( (#vr.183, 1)[!KU( f_.184, ~ekI.206 )] )
                next
                  case exp
                  solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                              sign(<x.160^x.161, 'g'^~tid.125>, ~x.129))) )
                    case Init_2_case_1
                    by solve( KU((#vr.165, 1), ~ekR.118) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.193, 0)[!KU( f_.194, ~x.129 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.191, 0)[!KU( f_.192, ~x.180 )] )
                      case fresh
                      by solve( KU((#vr.165, 1), ~ekR.118) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.191, 0)[!KU( f_.192, ~x.180 )] )
                      case fresh
                      by solve( (#vf.194, 0)[!KU( f_.195, ~x.129 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.165, 1), ~ekR.118) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.191, 0)[!KU( f_.192, ~x.129 )] )
                  next
                    case mac
                    solve( (#vr.172, 1)[!KU( f_.174,
                                             sign(<x.160^x.161, 'g'^~tid.125>, ~x.129)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.165, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.202, 0)[!KU( f_.203, ~x.129 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.200, 0)[!KU( f_.201, ~x.189 )] )
                        case fresh
                        by solve( KU((#vr.165, 1), ~ekR.118) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.200, 0)[!KU( f_.201, ~x.189 )] )
                        case fresh
                        by solve( (#vf.203, 0)[!KU( f_.204, ~x.129 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.165, 1), ~ekR.118) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.200, 0)[!KU( f_.201, ~x.129 )] )
                    next
                      case sign
                      by solve( (#vr.180, 1)[!KU( f_.182, ~x.129 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_6
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.142, 0)[!KU( f_.143, ~ltkR.130 )] )
                    case fresh
                    by solve( (#vr.178, 1)[!KU( f_.179, ~ekR.197 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.142, 0)[!KU( f_.143, ~ltkR.130 )] )
                    case fresh
                    by solve( (#vr.184, 1)[!KU( f_.185, ~ekI.207 )] )
                  qed
                next
                  case exp
                  solve( (#vf.142, 0)[!KU( f_.143, ~ltkR.130 )] )
                    case fresh
                    solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                sign(<x.161^x.162, 'g'^~tid.125>, ~x.129))) )
                      case Init_2_case_1
                      by solve( KU((#vr.166, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.200, 0)[!KU( f_.201, ~x.129 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.198, 0)[!KU( f_.199, ~x.187 )] )
                        case fresh
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.198, 0)[!KU( f_.199, ~x.187 )] )
                        case fresh
                        by solve( (#vf.201, 0)[!KU( f_.202, ~x.129 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.166, 1), ~ekR.118) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.198, 0)[!KU( f_.199, ~x.129 )] )
                    next
                      case mac
                      solve( (#vr.179, 1)[!KU( f_.181,
                                               sign(<x.161^x.162, 'g'^~tid.125>, ~x.129)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.209, 0)[!KU( f_.210, ~x.129 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.207, 0)[!KU( f_.208, ~x.196 )] )
                          case fresh
                          by solve( KU((#vr.166, 1), ~ekR.118) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.207, 0)[!KU( f_.208, ~x.196 )] )
                          case fresh
                          by solve( (#vf.210, 0)[!KU( f_.211, ~x.129 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.207, 0)[!KU( f_.208, ~x.129 )] )
                      next
                        case sign
                        by solve( (#vr.187, 1)[!KU( f_.189, ~x.129 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_7
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    by solve( (#vr.178, 1)[!KU( f_.179, ~ekR.197 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    by solve( (#vr.184, 1)[!KU( f_.185, ~ekI.207 )] )
                  qed
                next
                  case exp
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                sign(<x.161^x.162, 'g'^~tid.125>, ~x.129))) )
                      case Init_2_case_1
                      by solve( KU((#vr.166, 1), ~ekR.118) )
                    next
                      case Init_2_case_2
                      solve( (#vf.198, 0)[!KU( f_.199, ~x.187 )] )
                        case fresh
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.166, 1), ~ekR.118) )
                    next
                      case mac
                      solve( (#vr.179, 1)[!KU( f_.181,
                                               sign(<x.161^x.162, 'g'^~tid.125>, ~x.129)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        solve( (#vf.207, 0)[!KU( f_.208, ~x.196 )] )
                          case fresh
                          by solve( KU((#vr.166, 1), ~ekR.118) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      next
                        case sign
                        by solve( KU((#vr.166, 1), ~ekR.118) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_8
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    solve( (#vf.143, 0)[!KU( f_.144, ~ltkR.130 )] )
                      case fresh
                      by solve( (#vr.179, 1)[!KU( f_.180, ~ekR.198 )] )
                    qed
                  qed
                next
                  case Resp_1
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    solve( (#vf.143, 0)[!KU( f_.144, ~ltkR.130 )] )
                      case fresh
                      by solve( (#vr.185, 1)[!KU( f_.186, ~ekI.208 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.135, 0)[!KU( f_.136, ~x.129 )] )
                    case fresh
                    solve( (#vf.143, 0)[!KU( f_.144, ~ltkR.130 )] )
                      case fresh
                      solve( KU((#vf.132, 0), mac('g'^(~ekR.118*~ekI.119),
                                                  sign(<x.162^x.163, 'g'^~tid.125>, ~x.129))) )
                        case Init_2_case_1
                        by solve( KU((#vr.167, 1), ~ekR.118) )
                      next
                        case Init_2_case_2
                        solve( (#vf.205, 0)[!KU( f_.206, ~x.194 )] )
                          case fresh
                          by solve( KU((#vr.167, 1), ~ekR.118) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.167, 1), ~ekR.118) )
                      next
                        case mac
                        solve( (#vr.186, 1)[!KU( f_.188,
                                                 sign(<x.162^x.163, 'g'^~tid.125>, ~x.129)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.167, 1), ~ekR.118) )
                        next
                          case Init_2_case_2
                          solve( (#vf.214, 0)[!KU( f_.215, ~x.203 )] )
                            case fresh
                            by solve( KU((#vr.167, 1), ~ekR.118) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.167, 1), ~ekR.118) )
                        next
                          case sign
                          by solve( KU((#vr.167, 1), ~ekR.118) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case h
                solve( (#vr.105, 0)[!KU( f_.106, 'g'^(~ekR.118*~ekI.119) )] )
                  case Init_1
                  by solve( (#vr.140, 1)[!KU( f_.141, ~ekR.159 )] )
                next
                  case Resp_1
                  by solve( (#vr.146, 1)[!KU( f_.147, ~ekI.169 )] )
                next
                  case exp
                  by solve( KU((#vr.128, 1), ~ekR.118) )
                qed
              qed
            qed
          qed
        qed
      qed
    next
      case Init_2_case_4
      solve( (#vf.66, 0)[!KU( f_.67, ~x.55 )] )
        case fresh
        by solve( (#vf.69, 0)[!KU( f_.70, ~x.12 )] )
      qed
    next
      case Resp_1_case_1
      solve( splitEqs(1) )
        case split_case_1
        solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.90*~ekR.91)) )] )
          case Sessionkey_Reveal_case_1
          solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                      sign(<x.128^x.129, 'g'^~tid.97>, ~x.102))) )
            case Init_2_case_1
            solve( KU((#vf.142, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141))) )
              case Init_2
              by contradiction // cyclic
            next
              case mac
              solve( (#vr.180, 0)[!KU( f_.181, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.229 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.228 )] )
                qed
              next
                case exp
                solve( (#vr.180, 1)[!KU( f_.182,
                                         sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                    )] )
                  case Init_2
                  by contradiction // cyclic
                next
                  case sign
                  by solve( (#vr.195, 1)[!KU( f_.197, ~x.141 )] )
                qed
              qed
            qed
          next
            case Init_2_case_2
            by solve( (#vf.154, 0)[!KU( f_.155, ~x.102 )] )
          next
            case Init_2_case_3
            solve( (#vf.152, 0)[!KU( f_.153, ~x.141 )] )
              case fresh
              solve( KU((#vf.142, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141))) )
                case mac
                solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.236 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.235 )] )
                  qed
                next
                  case exp
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.134>, ~x.141)
                                      )] )
                    case sign
                    by solve( KU((#vr.195, 1), ~ekR.90) )
                  qed
                qed
              qed
            qed
          next
            case Init_2_case_4
            solve( (#vf.152, 0)[!KU( f_.153, ~x.141 )] )
              case fresh
              by solve( (#vf.155, 0)[!KU( f_.156, ~x.102 )] )
            qed
          next
            case Resp_1_case_1
            solve( splitEqs(1) )
              case split_case_1
              by solve( splitEqs(1) )
            next
              case split_case_2
              by contradiction // non-normal terms
            qed
          next
            case Resp_1_case_2
            by solve( (#vf.152, 0)[!KU( f_.153, ~x.102 )] )
          next
            case mac
            solve( (#vr.133, 0)[!KU( f_.134, 'g'^(~ekR.90*~ekR.91) )] )
              case Resp_1_case_1
              solve( (#vr.133, 1)[!KU( f_.135, sign(<x.128^x.129, 'g'^~tid.97>, ~x.102)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case Init_2_case_2
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case Init_2_case_3
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case Init_2_case_4
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              next
                case sign
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.182 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vr.133, 1)[!KU( f_.135, sign(<x.128^x.129, 'g'^~tid.97>, ~x.102)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case Init_2_case_2
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case Init_2_case_3
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case Init_2_case_4
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              next
                case sign
                by solve( (#vr.159, 1)[!KU( f_.160, ~ekR.181 )] )
              qed
            next
              case exp
              solve( (#vr.133, 1)[!KU( f_.135, sign(<x.128^x.129, 'g'^~tid.97>, ~x.102)
                                  )] )
                case Init_2_case_1
                by solve( KU((#vr.141, 1), ~ekR.90) )
              next
                case Init_2_case_2
                by solve( (#vf.170, 0)[!KU( f_.171, ~x.102 )] )
              next
                case Init_2_case_3
                solve( (#vf.168, 0)[!KU( f_.169, ~x.157 )] )
                  case fresh
                  by solve( KU((#vr.141, 1), ~ekR.90) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.168, 0)[!KU( f_.169, ~x.157 )] )
                  case fresh
                  by solve( (#vf.171, 0)[!KU( f_.172, ~x.102 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.141, 1), ~ekR.90) )
              next
                case Resp_1_case_2
                by solve( (#vf.168, 0)[!KU( f_.169, ~x.102 )] )
              next
                case sign
                by solve( (#vr.148, 1)[!KU( f_.150, ~x.102 )] )
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_2
          solve( (#vf.111, 0)[!KU( f_.112, ~ltkI.101 )] )
            case fresh
            solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<x.129^x.130, 'g'^~tid.97>, ~x.102))) )
              case Init_2_case_1
              solve( KU((#vf.149, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148))) )
                case mac
                solve( (#vr.187, 0)[!KU( f_.188, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.236 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case sign
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.235 )] )
                  qed
                next
                  case exp
                  solve( (#vr.187, 1)[!KU( f_.189,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case sign
                    by solve( (#vr.202, 1)[!KU( f_.204, ~x.148 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.161, 0)[!KU( f_.162, ~x.102 )] )
            next
              case Init_2_case_3
              solve( (#vf.159, 0)[!KU( f_.160, ~x.148 )] )
                case fresh
                solve( KU((#vf.149, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148))) )
                  case Init_2
                  by contradiction // cyclic
                next
                  case mac
                  solve( (#vr.194, 0)[!KU( f_.195, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.243 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.242 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.194, 1)[!KU( f_.196,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case Init_2
                      by contradiction // cyclic
                    next
                      case sign
                      by solve( KU((#vr.202, 1), ~ekR.90) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.159, 0)[!KU( f_.160, ~x.148 )] )
                case fresh
                by solve( (#vf.162, 0)[!KU( f_.163, ~x.102 )] )
              qed
            next
              case Resp_1_case_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case Resp_1_case_2
              by solve( (#vf.159, 0)[!KU( f_.160, ~x.102 )] )
            next
              case mac
              solve( (#vr.140, 0)[!KU( f_.141, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case sign
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case sign
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                qed
              next
                case exp
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.148, 1), ~ekR.90) )
                next
                  case Init_2_case_2
                  by solve( (#vf.177, 0)[!KU( f_.178, ~x.102 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                    case fresh
                    by solve( KU((#vr.148, 1), ~ekR.90) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                    case fresh
                    by solve( (#vf.178, 0)[!KU( f_.179, ~x.102 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.148, 1), ~ekR.90) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.175, 0)[!KU( f_.176, ~x.102 )] )
                next
                  case sign
                  by solve( (#vr.155, 1)[!KU( f_.157, ~x.102 )] )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_3
          solve( (#vf.109, 0)[!KU( f_.110, ~x.102 )] )
            case fresh
            solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<x.129^x.130, 'g'^~tid.97>, ~x.102))) )
              case Init_2_case_1
              solve( KU((#vf.149, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148))) )
                case Init_2
                by contradiction // cyclic
              next
                case mac
                solve( (#vr.188, 0)[!KU( f_.189, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.188, 1)[!KU( f_.190,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.237 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.188, 1)[!KU( f_.190,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.236 )] )
                  qed
                next
                  case exp
                  solve( (#vr.188, 1)[!KU( f_.190,
                                           sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                      )] )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case sign
                    by solve( (#vr.203, 1)[!KU( f_.205, ~x.148 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              solve( (#vf.159, 0)[!KU( f_.160, ~x.148 )] )
                case fresh
                solve( KU((#vf.149, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148))) )
                  case mac
                  solve( (#vr.195, 0)[!KU( f_.196, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.244 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.243 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.141>, ~x.148)
                                        )] )
                      case sign
                      by solve( KU((#vr.203, 1), ~ekR.90) )
                    qed
                  qed
                qed
              qed
            next
              case Resp_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case mac
              solve( (#vr.140, 0)[!KU( f_.141, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case Resp_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                next
                  case sign
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case Resp_1
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                next
                  case sign
                  by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
                qed
              next
                case exp
                solve( (#vr.140, 1)[!KU( f_.142, sign(<x.129^x.130, 'g'^~tid.97>, ~x.102)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.148, 1), ~ekR.90) )
                next
                  case Init_2_case_2
                  solve( (#vf.175, 0)[!KU( f_.176, ~x.164 )] )
                    case fresh
                    by solve( KU((#vr.148, 1), ~ekR.90) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.148, 1), ~ekR.90) )
                next
                  case sign
                  by solve( KU((#vr.148, 1), ~ekR.90) )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_4
          solve( (#vf.109, 0)[!KU( f_.110, ~x.102 )] )
            case fresh
            solve( (#vf.112, 0)[!KU( f_.113, ~ltkI.101 )] )
              case fresh
              solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<x.130^x.131, 'g'^~tid.97>, ~x.102))) )
                case Init_2_case_1
                solve( KU((#vf.156, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155))) )
                  case mac
                  solve( (#vr.195, 0)[!KU( f_.196, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                        )] )
                      case sign
                      by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.244 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                        )] )
                      case sign
                      by solve( (#vr.221, 1)[!KU( f_.222, ~ekR.243 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.195, 1)[!KU( f_.197,
                                             sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                        )] )
                      case sign
                      by solve( (#vr.210, 1)[!KU( f_.212, ~x.155 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.166, 0)[!KU( f_.167, ~x.155 )] )
                  case fresh
                  solve( KU((#vf.156, 0), mac('g'^(~ekR.90*~ekR.91),
                                              sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155))) )
                    case Init_2
                    by contradiction // cyclic
                  next
                    case mac
                    solve( (#vr.202, 0)[!KU( f_.203, 'g'^(~ekR.90*~ekR.91) )] )
                      case Resp_1_case_1
                      solve( (#vr.202, 1)[!KU( f_.204,
                                               sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.228, 1)[!KU( f_.229, ~ekR.251 )] )
                      qed
                    next
                      case Resp_1_case_2
                      solve( (#vr.202, 1)[!KU( f_.204,
                                               sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( (#vr.228, 1)[!KU( f_.229, ~ekR.250 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.202, 1)[!KU( f_.204,
                                               sign(<'g'^~tid.97, 'g'^~ekI.148>, ~x.155)
                                          )] )
                        case Init_2
                        by contradiction // cyclic
                      next
                        case sign
                        by solve( KU((#vr.210, 1), ~ekR.90) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case mac
                solve( (#vr.147, 0)[!KU( f_.148, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.147, 1)[!KU( f_.149, sign(<x.130^x.131, 'g'^~tid.97>, ~x.102)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.196 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.196 )] )
                  next
                    case Resp_1
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.196 )] )
                  next
                    case sign
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.196 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.147, 1)[!KU( f_.149, sign(<x.130^x.131, 'g'^~tid.97>, ~x.102)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.195 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.195 )] )
                  next
                    case Resp_1
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.195 )] )
                  next
                    case sign
                    by solve( (#vr.173, 1)[!KU( f_.174, ~ekR.195 )] )
                  qed
                next
                  case exp
                  solve( (#vr.147, 1)[!KU( f_.149, sign(<x.130^x.131, 'g'^~tid.97>, ~x.102)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.155, 1), ~ekR.90) )
                  next
                    case Init_2_case_2
                    solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                      case fresh
                      by solve( KU((#vr.155, 1), ~ekR.90) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.155, 1), ~ekR.90) )
                  next
                    case sign
                    by solve( KU((#vr.155, 1), ~ekR.90) )
                  qed
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_5
          solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                      sign(<x.132^x.133, 'g'^~tid.97>, ~x.101))) )
            case Init_2_case_1
            solve( KU((#vf.146, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145))) )
              case Resp_1
              solve( splitEqs(1) )
                case split_case_1
                by solve( splitEqs(1) )
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case mac
              solve( (#vr.186, 0)[!KU( f_.187, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.186, 1)[!KU( f_.188,
                                         sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                    )] )
                  case Resp_1
                  by solve( (#vr.212, 1)[!KU( f_.213, ~ekR.235 )] )
                next
                  case sign
                  by solve( (#vr.212, 1)[!KU( f_.213, ~ekR.235 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.186, 1)[!KU( f_.188,
                                         sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                    )] )
                  case Resp_1
                  by solve( (#vr.212, 1)[!KU( f_.213, ~ekR.234 )] )
                next
                  case sign
                  by solve( (#vr.212, 1)[!KU( f_.213, ~ekR.234 )] )
                qed
              next
                case exp
                solve( (#vr.186, 1)[!KU( f_.188,
                                         sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                    )] )
                  case Resp_1
                  by solve( KU((#vr.194, 1), ~ekR.90) )
                next
                  case sign
                  by solve( (#vr.201, 1)[!KU( f_.203, ~x.145 )] )
                qed
              qed
            qed
          next
            case Init_2_case_2
            by solve( (#vf.158, 0)[!KU( f_.159, ~x.101 )] )
          next
            case Init_2_case_3
            solve( (#vf.156, 0)[!KU( f_.157, ~x.145 )] )
              case fresh
              solve( KU((#vf.146, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145))) )
                case mac
                solve( (#vr.193, 0)[!KU( f_.194, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekR.242 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekR.241 )] )
                  qed
                next
                  case exp
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.138>, ~x.145)
                                      )] )
                    case sign
                    by solve( KU((#vr.201, 1), ~ekR.90) )
                  qed
                qed
              qed
            qed
          next
            case Init_2_case_4
            solve( (#vf.156, 0)[!KU( f_.157, ~x.145 )] )
              case fresh
              by solve( (#vf.159, 0)[!KU( f_.160, ~x.101 )] )
            qed
          next
            case Resp_1_case_1
            solve( splitEqs(1) )
              case split_case_1
              solve( splitEqs(1) )
                case split_case_1
                solve( splitEqs(1) )
                  case split_case_1
                  by contradiction // from formulas
                next
                  case split_case_2
                  solve( splitEqs(1) )
                    case split_case_1
                    solve( KU((#vf.15, 0), sign(<'g'^~ekR.183, 'g'^~ekR.182>, ~x.12)) )
                      case Resp_1
                      solve( KU((#vf.36, 0), 'g'^~ekR.183) )
                        case Resp_1
                        solve( KU((#vf.55, 0), 'g'^~ekR.182) )
                          case Resp_1
                          by contradiction // cyclic
                        next
                          case exp
                          by solve( (#vr.268, 1)[!KU( f_.269, ~ekR.182 )] )
                        qed
                      next
                        case exp
                        by solve( (#vr.231, 1)[!KU( f_.232, ~ekR.183 )] )
                      qed
                    next
                      case sign
                      by solve( (#vr.187, 1)[!KU( f_.189, ~x.12 )] )
                    qed
                  next
                    case split_case_2
                    by contradiction // from formulas
                  qed
                qed
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case split_case_2
              by contradiction // non-normal terms
            qed
          next
            case Resp_1_case_2
            by solve( (#vf.156, 0)[!KU( f_.157, ~x.101 )] )
          next
            case mac
            solve( (#vr.137, 0)[!KU( f_.138, 'g'^(~ekR.90*~ekR.91) )] )
              case Resp_1_case_1
              solve( (#vr.137, 1)[!KU( f_.139, sign(<x.132^x.133, 'g'^~tid.97>, ~x.101)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case Init_2_case_2
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case Init_2_case_3
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case Init_2_case_4
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              next
                case sign
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vr.137, 1)[!KU( f_.139, sign(<x.132^x.133, 'g'^~tid.97>, ~x.101)
                                  )] )
                case Init_2_case_1
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case Init_2_case_2
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case Init_2_case_3
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case Init_2_case_4
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case Resp_1_case_1
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case Resp_1_case_2
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              next
                case sign
                by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
              qed
            next
              case exp
              solve( (#vr.137, 1)[!KU( f_.139, sign(<x.132^x.133, 'g'^~tid.97>, ~x.101)
                                  )] )
                case Init_2_case_1
                by solve( KU((#vr.145, 1), ~ekR.90) )
              next
                case Init_2_case_2
                by solve( (#vf.174, 0)[!KU( f_.175, ~x.101 )] )
              next
                case Init_2_case_3
                solve( (#vf.172, 0)[!KU( f_.173, ~x.161 )] )
                  case fresh
                  by solve( KU((#vr.145, 1), ~ekR.90) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.172, 0)[!KU( f_.173, ~x.161 )] )
                  case fresh
                  by solve( (#vf.175, 0)[!KU( f_.176, ~x.101 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.145, 1), ~ekR.90) )
              next
                case Resp_1_case_2
                by solve( (#vf.172, 0)[!KU( f_.173, ~x.101 )] )
              next
                case sign
                by solve( (#vr.152, 1)[!KU( f_.154, ~x.101 )] )
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_6
          solve( (#vf.114, 0)[!KU( f_.115, ~ltkR.102 )] )
            case fresh
            solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<x.133^x.134, 'g'^~tid.97>, ~x.101))) )
              case Init_2_case_1
              solve( KU((#vf.153, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152))) )
                case mac
                solve( (#vr.193, 0)[!KU( f_.194, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case sign
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekR.242 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case sign
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekR.241 )] )
                  qed
                next
                  case exp
                  solve( (#vr.193, 1)[!KU( f_.195,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case sign
                    by solve( (#vr.208, 1)[!KU( f_.210, ~x.152 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              by solve( (#vf.165, 0)[!KU( f_.166, ~x.101 )] )
            next
              case Init_2_case_3
              solve( (#vf.163, 0)[!KU( f_.164, ~x.152 )] )
                case fresh
                solve( KU((#vf.153, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152))) )
                  case Resp_1
                  solve( splitEqs(1) )
                    case split_case_1
                    by solve( splitEqs(1) )
                  next
                    case split_case_2
                    by contradiction // non-normal terms
                  qed
                next
                  case mac
                  solve( (#vr.200, 0)[!KU( f_.201, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.200, 1)[!KU( f_.202,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case Resp_1
                      by solve( (#vr.226, 1)[!KU( f_.227, ~ekR.249 )] )
                    next
                      case sign
                      by solve( (#vr.226, 1)[!KU( f_.227, ~ekR.249 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.200, 1)[!KU( f_.202,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case Resp_1
                      by solve( (#vr.226, 1)[!KU( f_.227, ~ekR.248 )] )
                    next
                      case sign
                      by solve( (#vr.226, 1)[!KU( f_.227, ~ekR.248 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.200, 1)[!KU( f_.202,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case Resp_1
                      by solve( KU((#vr.208, 1), ~ekR.90) )
                    next
                      case sign
                      by solve( KU((#vr.208, 1), ~ekR.90) )
                    qed
                  qed
                qed
              qed
            next
              case Init_2_case_4
              solve( (#vf.163, 0)[!KU( f_.164, ~x.152 )] )
                case fresh
                by solve( (#vf.166, 0)[!KU( f_.167, ~x.101 )] )
              qed
            next
              case Resp_1_case_1
              solve( splitEqs(1) )
                case split_case_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case Resp_1_case_2
              by solve( (#vf.163, 0)[!KU( f_.164, ~x.101 )] )
            next
              case mac
              solve( (#vr.144, 0)[!KU( f_.145, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case sign
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Init_2_case_3
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Init_2_case_4
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Resp_1_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Resp_1_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case sign
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                qed
              next
                case exp
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.152, 1), ~ekR.90) )
                next
                  case Init_2_case_2
                  by solve( (#vf.181, 0)[!KU( f_.182, ~x.101 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.179, 0)[!KU( f_.180, ~x.168 )] )
                    case fresh
                    by solve( KU((#vr.152, 1), ~ekR.90) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.179, 0)[!KU( f_.180, ~x.168 )] )
                    case fresh
                    by solve( (#vf.182, 0)[!KU( f_.183, ~x.101 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.152, 1), ~ekR.90) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.179, 0)[!KU( f_.180, ~x.101 )] )
                next
                  case sign
                  by solve( (#vr.159, 1)[!KU( f_.161, ~x.101 )] )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_7
          solve( (#vf.107, 0)[!KU( f_.108, ~x.101 )] )
            case fresh
            solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                        sign(<x.133^x.134, 'g'^~tid.97>, ~x.101))) )
              case Init_2_case_1
              solve( KU((#vf.153, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152))) )
                case Resp_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case mac
                solve( (#vr.194, 0)[!KU( f_.195, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.194, 1)[!KU( f_.196,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case Resp_1
                    by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.243 )] )
                  next
                    case sign
                    by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.243 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.194, 1)[!KU( f_.196,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case Resp_1
                    by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.242 )] )
                  next
                    case sign
                    by solve( (#vr.220, 1)[!KU( f_.221, ~ekR.242 )] )
                  qed
                next
                  case exp
                  solve( (#vr.194, 1)[!KU( f_.196,
                                           sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                      )] )
                    case Resp_1
                    by solve( KU((#vr.202, 1), ~ekR.90) )
                  next
                    case sign
                    by solve( (#vr.209, 1)[!KU( f_.211, ~x.152 )] )
                  qed
                qed
              qed
            next
              case Init_2_case_2
              solve( (#vf.163, 0)[!KU( f_.164, ~x.152 )] )
                case fresh
                solve( KU((#vf.153, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152))) )
                  case mac
                  solve( (#vr.201, 0)[!KU( f_.202, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( (#vr.227, 1)[!KU( f_.228, ~ekR.250 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( (#vr.227, 1)[!KU( f_.228, ~ekR.249 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.145>, ~x.152)
                                        )] )
                      case sign
                      by solve( KU((#vr.209, 1), ~ekR.90) )
                    qed
                  qed
                qed
              qed
            next
              case Resp_1
              solve( splitEqs(1) )
                case split_case_1
                solve( splitEqs(1) )
                  case split_case_1
                  by solve( splitEqs(1) )
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            next
              case mac
              solve( (#vr.144, 0)[!KU( f_.145, 'g'^(~ekR.90*~ekR.91) )] )
                case Resp_1_case_1
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case Resp_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                next
                  case sign
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.193 )] )
                qed
              next
                case Resp_1_case_2
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Init_2_case_2
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case Resp_1
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                next
                  case sign
                  by solve( (#vr.170, 1)[!KU( f_.171, ~ekR.192 )] )
                qed
              next
                case exp
                solve( (#vr.144, 1)[!KU( f_.146, sign(<x.133^x.134, 'g'^~tid.97>, ~x.101)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.152, 1), ~ekR.90) )
                next
                  case Init_2_case_2
                  solve( (#vf.179, 0)[!KU( f_.180, ~x.168 )] )
                    case fresh
                    by solve( KU((#vr.152, 1), ~ekR.90) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.152, 1), ~ekR.90) )
                next
                  case sign
                  by solve( KU((#vr.152, 1), ~ekR.90) )
                qed
              qed
            qed
          qed
        next
          case Sessionkey_Reveal_case_8
          solve( (#vf.107, 0)[!KU( f_.108, ~x.101 )] )
            case fresh
            solve( (#vf.115, 0)[!KU( f_.116, ~ltkR.102 )] )
              case fresh
              solve( KU((#vf.104, 0), mac('g'^(~ekR.90*~ekR.91),
                                          sign(<x.134^x.135, 'g'^~tid.97>, ~x.101))) )
                case Init_2_case_1
                solve( KU((#vf.160, 0), mac('g'^(~ekR.90*~ekR.91),
                                            sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159))) )
                  case mac
                  solve( (#vr.201, 0)[!KU( f_.202, 'g'^(~ekR.90*~ekR.91) )] )
                    case Resp_1_case_1
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                        )] )
                      case sign
                      by solve( (#vr.227, 1)[!KU( f_.228, ~ekR.250 )] )
                    qed
                  next
                    case Resp_1_case_2
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                        )] )
                      case sign
                      by solve( (#vr.227, 1)[!KU( f_.228, ~ekR.249 )] )
                    qed
                  next
                    case exp
                    solve( (#vr.201, 1)[!KU( f_.203,
                                             sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                        )] )
                      case sign
                      by solve( (#vr.216, 1)[!KU( f_.218, ~x.159 )] )
                    qed
                  qed
                qed
              next
                case Init_2_case_2
                solve( (#vf.170, 0)[!KU( f_.171, ~x.159 )] )
                  case fresh
                  solve( KU((#vf.160, 0), mac('g'^(~ekR.90*~ekR.91),
                                              sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159))) )
                    case Resp_1
                    solve( splitEqs(1) )
                      case split_case_1
                      by solve( splitEqs(1) )
                    next
                      case split_case_2
                      by contradiction // non-normal terms
                    qed
                  next
                    case mac
                    solve( (#vr.208, 0)[!KU( f_.209, 'g'^(~ekR.90*~ekR.91) )] )
                      case Resp_1_case_1
                      solve( (#vr.208, 1)[!KU( f_.210,
                                               sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                          )] )
                        case Resp_1
                        by solve( (#vr.234, 1)[!KU( f_.235, ~ekR.257 )] )
                      next
                        case sign
                        by solve( (#vr.234, 1)[!KU( f_.235, ~ekR.257 )] )
                      qed
                    next
                      case Resp_1_case_2
                      solve( (#vr.208, 1)[!KU( f_.210,
                                               sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                          )] )
                        case Resp_1
                        by solve( (#vr.234, 1)[!KU( f_.235, ~ekR.256 )] )
                      next
                        case sign
                        by solve( (#vr.234, 1)[!KU( f_.235, ~ekR.256 )] )
                      qed
                    next
                      case exp
                      solve( (#vr.208, 1)[!KU( f_.210,
                                               sign(<'g'^~tid.97, 'g'^~ekI.152>, ~x.159)
                                          )] )
                        case Resp_1
                        by solve( KU((#vr.216, 1), ~ekR.90) )
                      next
                        case sign
                        by solve( KU((#vr.216, 1), ~ekR.90) )
                      qed
                    qed
                  qed
                qed
              next
                case Resp_1
                solve( splitEqs(1) )
                  case split_case_1
                  solve( splitEqs(1) )
                    case split_case_1
                    by solve( splitEqs(1) )
                  next
                    case split_case_2
                    by contradiction // non-normal terms
                  qed
                next
                  case split_case_2
                  by contradiction // non-normal terms
                qed
              next
                case mac
                solve( (#vr.151, 0)[!KU( f_.152, 'g'^(~ekR.90*~ekR.91) )] )
                  case Resp_1_case_1
                  solve( (#vr.151, 1)[!KU( f_.153, sign(<x.134^x.135, 'g'^~tid.97>, ~x.101)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.200 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.200 )] )
                  next
                    case Resp_1
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.200 )] )
                  next
                    case sign
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.200 )] )
                  qed
                next
                  case Resp_1_case_2
                  solve( (#vr.151, 1)[!KU( f_.153, sign(<x.134^x.135, 'g'^~tid.97>, ~x.101)
                                      )] )
                    case Init_2_case_1
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.199 )] )
                  next
                    case Init_2_case_2
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.199 )] )
                  next
                    case Resp_1
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.199 )] )
                  next
                    case sign
                    by solve( (#vr.177, 1)[!KU( f_.178, ~ekR.199 )] )
                  qed
                next
                  case exp
                  solve( (#vr.151, 1)[!KU( f_.153, sign(<x.134^x.135, 'g'^~tid.97>, ~x.101)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.159, 1), ~ekR.90) )
                  next
                    case Init_2_case_2
                    solve( (#vf.186, 0)[!KU( f_.187, ~x.175 )] )
                      case fresh
                      by solve( KU((#vr.159, 1), ~ekR.90) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.159, 1), ~ekR.90) )
                  next
                    case sign
                    by solve( KU((#vr.159, 1), ~ekR.90) )
                  qed
                qed
              qed
            qed
          qed
        next
          case h
          solve( (#vr.94, 0)[!KU( f_.95, 'g'^(~ekR.90*~ekR.91) )] )
            case Resp_1_case_1
            by solve( (#vr.118, 1)[!KU( f_.119, ~ekR.141 )] )
          next
            case Resp_1_case_2
            by solve( (#vr.118, 1)[!KU( f_.119, ~ekR.140 )] )
          next
            case exp
            by solve( KU((#vr.100, 1), ~ekR.90) )
          qed
        qed
      next
        case split_case_2
        by contradiction // non-normal terms
      qed
    next
      case Resp_1_case_2
      by solve( (#vf.66, 0)[!KU( f_.67, ~x.12 )] )
    next
      case mac
      solve( (#vr.47, 1)[!KU( f_.49, sign(<hki.6, 'g'^~ekR.8>, ~x.12) )] )
        case Init_2_case_1
        solve( KU((#vf.65, 0), mac(x.103^x.104,
                                   sign(<'g'^~ekR.8, 'g'^~ekI.56>, ~x.64))) )
          case Resp_1
          solve( splitEqs(1) )
            case split_case_1
            solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.147*~ekI.148)) )] )
              case Sessionkey_Reveal_case_1
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.202, 1)[!KU( f_.203, ~ekR.221 )] )
              next
                case Resp_1
                by solve( (#vr.208, 1)[!KU( f_.209, ~ekI.231 )] )
              next
                case exp
                solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                            sign(<x.185^x.186, 'g'^~tid.154>, ~x.159))) )
                  case Init_2_case_1
                  by solve( KU((#vr.190, 1), ~ekR.147) )
                next
                  case Init_2_case_2
                  by solve( (#vf.218, 0)[!KU( f_.219, ~x.159 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.216, 0)[!KU( f_.217, ~x.205 )] )
                    case fresh
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.216, 0)[!KU( f_.217, ~x.205 )] )
                    case fresh
                    by solve( (#vf.219, 0)[!KU( f_.220, ~x.159 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.190, 1), ~ekR.147) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.216, 0)[!KU( f_.217, ~x.159 )] )
                next
                  case mac
                  solve( (#vr.197, 1)[!KU( f_.199,
                                           sign(<x.185^x.186, 'g'^~tid.154>, ~x.159)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.227, 0)[!KU( f_.228, ~x.159 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.225, 0)[!KU( f_.226, ~x.214 )] )
                      case fresh
                      by solve( KU((#vr.190, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.225, 0)[!KU( f_.226, ~x.214 )] )
                      case fresh
                      by solve( (#vf.228, 0)[!KU( f_.229, ~x.159 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.190, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.225, 0)[!KU( f_.226, ~x.159 )] )
                  next
                    case sign
                    by solve( (#vr.205, 1)[!KU( f_.207, ~x.159 )] )
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_2
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  by solve( (#vr.203, 1)[!KU( f_.204, ~ekR.222 )] )
                qed
              next
                case Resp_1
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  by solve( (#vr.209, 1)[!KU( f_.210, ~ekI.232 )] )
                qed
              next
                case exp
                solve( (#vf.168, 0)[!KU( f_.169, ~ltkI.158 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.186^x.187, 'g'^~tid.154>, ~x.159))) )
                    case Init_2_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.225, 0)[!KU( f_.226, ~x.159 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( (#vf.226, 0)[!KU( f_.227, ~x.159 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.223, 0)[!KU( f_.224, ~x.159 )] )
                  next
                    case mac
                    solve( (#vr.204, 1)[!KU( f_.206,
                                             sign(<x.186^x.187, 'g'^~tid.154>, ~x.159)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.234, 0)[!KU( f_.235, ~x.159 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( KU((#vr.191, 1), ~ekR.147) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( (#vf.235, 0)[!KU( f_.236, ~x.159 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.232, 0)[!KU( f_.233, ~x.159 )] )
                    next
                      case sign
                      by solve( (#vr.212, 1)[!KU( f_.214, ~x.159 )] )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_3
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  by solve( (#vr.203, 1)[!KU( f_.204, ~ekR.222 )] )
                qed
              next
                case Resp_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  by solve( (#vr.209, 1)[!KU( f_.210, ~ekI.232 )] )
                qed
              next
                case exp
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.186^x.187, 'g'^~tid.154>, ~x.159))) )
                    case Init_2_case_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    solve( (#vf.223, 0)[!KU( f_.224, ~x.212 )] )
                      case fresh
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.191, 1), ~ekR.147) )
                  next
                    case mac
                    solve( (#vr.204, 1)[!KU( f_.206,
                                             sign(<x.186^x.187, 'g'^~tid.154>, ~x.159)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.232, 0)[!KU( f_.233, ~x.221 )] )
                        case fresh
                        by solve( KU((#vr.191, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    next
                      case sign
                      by solve( KU((#vr.191, 1), ~ekR.147) )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_4
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    by solve( (#vr.204, 1)[!KU( f_.205, ~ekR.223 )] )
                  qed
                qed
              next
                case Resp_1
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    by solve( (#vr.210, 1)[!KU( f_.211, ~ekI.233 )] )
                  qed
                qed
              next
                case exp
                solve( (#vf.166, 0)[!KU( f_.167, ~x.159 )] )
                  case fresh
                  solve( (#vf.169, 0)[!KU( f_.170, ~ltkI.158 )] )
                    case fresh
                    solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                                sign(<x.187^x.188, 'g'^~tid.154>, ~x.159))) )
                      case Init_2_case_1
                      by solve( KU((#vr.192, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.230, 0)[!KU( f_.231, ~x.219 )] )
                        case fresh
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.192, 1), ~ekR.147) )
                    next
                      case mac
                      solve( (#vr.211, 1)[!KU( f_.213,
                                               sign(<x.187^x.188, 'g'^~tid.154>, ~x.159)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      next
                        case Init_2_case_2
                        solve( (#vf.239, 0)[!KU( f_.240, ~x.228 )] )
                          case fresh
                          by solve( KU((#vr.192, 1), ~ekR.147) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      next
                        case sign
                        by solve( KU((#vr.192, 1), ~ekR.147) )
                      qed
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_5
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.206, 1)[!KU( f_.207, ~ekR.225 )] )
              next
                case Resp_1
                by solve( (#vr.212, 1)[!KU( f_.213, ~ekI.235 )] )
              next
                case exp
                solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                            sign(<x.189^x.190, 'g'^~tid.154>, ~x.158))) )
                  case Init_2_case_1
                  by solve( KU((#vr.194, 1), ~ekR.147) )
                next
                  case Init_2_case_2
                  by solve( (#vf.222, 0)[!KU( f_.223, ~x.158 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.220, 0)[!KU( f_.221, ~x.209 )] )
                    case fresh
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.220, 0)[!KU( f_.221, ~x.209 )] )
                    case fresh
                    by solve( (#vf.223, 0)[!KU( f_.224, ~x.158 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.194, 1), ~ekR.147) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.220, 0)[!KU( f_.221, ~x.158 )] )
                next
                  case mac
                  solve( (#vr.201, 1)[!KU( f_.203,
                                           sign(<x.189^x.190, 'g'^~tid.154>, ~x.158)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.231, 0)[!KU( f_.232, ~x.158 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.229, 0)[!KU( f_.230, ~x.218 )] )
                      case fresh
                      by solve( KU((#vr.194, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.229, 0)[!KU( f_.230, ~x.218 )] )
                      case fresh
                      by solve( (#vf.232, 0)[!KU( f_.233, ~x.158 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.194, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.229, 0)[!KU( f_.230, ~x.158 )] )
                  next
                    case sign
                    by solve( (#vr.209, 1)[!KU( f_.211, ~x.158 )] )
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_6
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                qed
              next
                case Resp_1
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                qed
              next
                case exp
                solve( (#vf.171, 0)[!KU( f_.172, ~ltkR.159 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.190^x.191, 'g'^~tid.154>, ~x.158))) )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.229, 0)[!KU( f_.230, ~x.158 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( (#vf.230, 0)[!KU( f_.231, ~x.158 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.227, 0)[!KU( f_.228, ~x.158 )] )
                  next
                    case mac
                    solve( (#vr.208, 1)[!KU( f_.210,
                                             sign(<x.190^x.191, 'g'^~tid.154>, ~x.158)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.238, 0)[!KU( f_.239, ~x.158 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( KU((#vr.195, 1), ~ekR.147) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( (#vf.239, 0)[!KU( f_.240, ~x.158 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.236, 0)[!KU( f_.237, ~x.158 )] )
                    next
                      case sign
                      by solve( (#vr.216, 1)[!KU( f_.218, ~x.158 )] )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_7
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  by solve( (#vr.207, 1)[!KU( f_.208, ~ekR.226 )] )
                qed
              next
                case Resp_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  by solve( (#vr.213, 1)[!KU( f_.214, ~ekI.236 )] )
                qed
              next
                case exp
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                              sign(<x.190^x.191, 'g'^~tid.154>, ~x.158))) )
                    case Init_2_case_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case Init_2_case_2
                    solve( (#vf.227, 0)[!KU( f_.228, ~x.216 )] )
                      case fresh
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.195, 1), ~ekR.147) )
                  next
                    case mac
                    solve( (#vr.208, 1)[!KU( f_.210,
                                             sign(<x.190^x.191, 'g'^~tid.154>, ~x.158)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.236, 0)[!KU( f_.237, ~x.225 )] )
                        case fresh
                        by solve( KU((#vr.195, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    next
                      case sign
                      by solve( KU((#vr.195, 1), ~ekR.147) )
                    qed
                  qed
                qed
              qed
            next
              case Sessionkey_Reveal_case_8
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    by solve( (#vr.208, 1)[!KU( f_.209, ~ekR.227 )] )
                  qed
                qed
              next
                case Resp_1
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    by solve( (#vr.214, 1)[!KU( f_.215, ~ekI.237 )] )
                  qed
                qed
              next
                case exp
                solve( (#vf.164, 0)[!KU( f_.165, ~x.158 )] )
                  case fresh
                  solve( (#vf.172, 0)[!KU( f_.173, ~ltkR.159 )] )
                    case fresh
                    solve( KU((#vf.161, 0), mac('g'^(~ekR.147*~ekI.148),
                                                sign(<x.191^x.192, 'g'^~tid.154>, ~x.158))) )
                      case Init_2_case_1
                      by solve( KU((#vr.196, 1), ~ekR.147) )
                    next
                      case Init_2_case_2
                      solve( (#vf.234, 0)[!KU( f_.235, ~x.223 )] )
                        case fresh
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.196, 1), ~ekR.147) )
                    next
                      case mac
                      solve( (#vr.215, 1)[!KU( f_.217,
                                               sign(<x.191^x.192, 'g'^~tid.154>, ~x.158)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      next
                        case Init_2_case_2
                        solve( (#vf.243, 0)[!KU( f_.244, ~x.232 )] )
                          case fresh
                          by solve( KU((#vr.196, 1), ~ekR.147) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      next
                        case sign
                        by solve( KU((#vr.196, 1), ~ekR.147) )
                      qed
                    qed
                  qed
                qed
              qed
            next
              case h
              solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.147*~ekI.148) )] )
                case Init_1
                by solve( (#vr.169, 1)[!KU( f_.170, ~ekR.188 )] )
              next
                case Resp_1
                by solve( (#vr.175, 1)[!KU( f_.176, ~ekI.198 )] )
              next
                case exp
                by solve( KU((#vr.157, 1), ~ekR.147) )
              qed
            qed
          next
            case split_case_2
            by contradiction // non-normal terms
          qed
        next
          case mac
          solve( (#vr.108, 1)[!KU( f_.110, sign(<'g'^~ekR.8, 'g'^~ekI.56>, ~x.64)
                              )] )
            case Resp_1
            solve( splitEqs(1) )
              case split_case_1
              solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.157*~ekI.158)) )] )
                case Sessionkey_Reveal_case_1
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  by solve( (#vr.212, 1)[!KU( f_.213, ~ekR.231 )] )
                next
                  case Resp_1
                  by solve( (#vr.218, 1)[!KU( f_.219, ~ekI.241 )] )
                next
                  case exp
                  solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                              sign(<x.195^x.196, 'g'^~tid.164>, ~x.169))) )
                    case Init_2_case_1
                    by solve( KU((#vr.200, 1), ~ekR.157) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.228, 0)[!KU( f_.229, ~x.169 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.226, 0)[!KU( f_.227, ~x.215 )] )
                      case fresh
                      by solve( KU((#vr.200, 1), ~ekR.157) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.226, 0)[!KU( f_.227, ~x.215 )] )
                      case fresh
                      by solve( (#vf.229, 0)[!KU( f_.230, ~x.169 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.200, 1), ~ekR.157) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.226, 0)[!KU( f_.227, ~x.169 )] )
                  next
                    case mac
                    solve( (#vr.207, 1)[!KU( f_.209,
                                             sign(<x.195^x.196, 'g'^~tid.164>, ~x.169)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.200, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.237, 0)[!KU( f_.238, ~x.169 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.235, 0)[!KU( f_.236, ~x.224 )] )
                        case fresh
                        by solve( KU((#vr.200, 1), ~ekR.157) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.235, 0)[!KU( f_.236, ~x.224 )] )
                        case fresh
                        by solve( (#vf.238, 0)[!KU( f_.239, ~x.169 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.200, 1), ~ekR.157) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.235, 0)[!KU( f_.236, ~x.169 )] )
                    next
                      case sign
                      by solve( (#vr.215, 1)[!KU( f_.217, ~x.169 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_2
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.178, 0)[!KU( f_.179, ~ltkI.168 )] )
                    case fresh
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.232 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.178, 0)[!KU( f_.179, ~ltkI.168 )] )
                    case fresh
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekI.242 )] )
                  qed
                next
                  case exp
                  solve( (#vf.178, 0)[!KU( f_.179, ~ltkI.168 )] )
                    case fresh
                    solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                sign(<x.196^x.197, 'g'^~tid.164>, ~x.169))) )
                      case Init_2_case_1
                      by solve( KU((#vr.201, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.235, 0)[!KU( f_.236, ~x.169 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.233, 0)[!KU( f_.234, ~x.222 )] )
                        case fresh
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.233, 0)[!KU( f_.234, ~x.222 )] )
                        case fresh
                        by solve( (#vf.236, 0)[!KU( f_.237, ~x.169 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.201, 1), ~ekR.157) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.233, 0)[!KU( f_.234, ~x.169 )] )
                    next
                      case mac
                      solve( (#vr.214, 1)[!KU( f_.216,
                                               sign(<x.196^x.197, 'g'^~tid.164>, ~x.169)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.244, 0)[!KU( f_.245, ~x.169 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.242, 0)[!KU( f_.243, ~x.231 )] )
                          case fresh
                          by solve( KU((#vr.201, 1), ~ekR.157) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.242, 0)[!KU( f_.243, ~x.231 )] )
                          case fresh
                          by solve( (#vf.245, 0)[!KU( f_.246, ~x.169 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.242, 0)[!KU( f_.243, ~x.169 )] )
                      next
                        case sign
                        by solve( (#vr.222, 1)[!KU( f_.224, ~x.169 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_3
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    by solve( (#vr.213, 1)[!KU( f_.214, ~ekR.232 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    by solve( (#vr.219, 1)[!KU( f_.220, ~ekI.242 )] )
                  qed
                next
                  case exp
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                sign(<x.196^x.197, 'g'^~tid.164>, ~x.169))) )
                      case Init_2_case_1
                      by solve( KU((#vr.201, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      solve( (#vf.233, 0)[!KU( f_.234, ~x.222 )] )
                        case fresh
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.201, 1), ~ekR.157) )
                    next
                      case mac
                      solve( (#vr.214, 1)[!KU( f_.216,
                                               sign(<x.196^x.197, 'g'^~tid.164>, ~x.169)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        solve( (#vf.242, 0)[!KU( f_.243, ~x.231 )] )
                          case fresh
                          by solve( KU((#vr.201, 1), ~ekR.157) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      next
                        case sign
                        by solve( KU((#vr.201, 1), ~ekR.157) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_4
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    solve( (#vf.179, 0)[!KU( f_.180, ~ltkI.168 )] )
                      case fresh
                      by solve( (#vr.214, 1)[!KU( f_.215, ~ekR.233 )] )
                    qed
                  qed
                next
                  case Resp_1
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    solve( (#vf.179, 0)[!KU( f_.180, ~ltkI.168 )] )
                      case fresh
                      by solve( (#vr.220, 1)[!KU( f_.221, ~ekI.243 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.169 )] )
                    case fresh
                    solve( (#vf.179, 0)[!KU( f_.180, ~ltkI.168 )] )
                      case fresh
                      solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                  sign(<x.197^x.198, 'g'^~tid.164>, ~x.169))) )
                        case Init_2_case_1
                        by solve( KU((#vr.202, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        solve( (#vf.240, 0)[!KU( f_.241, ~x.229 )] )
                          case fresh
                          by solve( KU((#vr.202, 1), ~ekR.157) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.202, 1), ~ekR.157) )
                      next
                        case mac
                        solve( (#vr.221, 1)[!KU( f_.223,
                                                 sign(<x.197^x.198, 'g'^~tid.164>, ~x.169)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.202, 1), ~ekR.157) )
                        next
                          case Init_2_case_2
                          solve( (#vf.249, 0)[!KU( f_.250, ~x.238 )] )
                            case fresh
                            by solve( KU((#vr.202, 1), ~ekR.157) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.202, 1), ~ekR.157) )
                        next
                          case sign
                          by solve( KU((#vr.202, 1), ~ekR.157) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_5
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  by solve( (#vr.216, 1)[!KU( f_.217, ~ekR.235 )] )
                next
                  case Resp_1
                  by solve( (#vr.222, 1)[!KU( f_.223, ~ekI.245 )] )
                next
                  case exp
                  solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                              sign(<x.199^x.200, 'g'^~tid.164>, ~x.168))) )
                    case Init_2_case_1
                    by solve( KU((#vr.204, 1), ~ekR.157) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.232, 0)[!KU( f_.233, ~x.168 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.230, 0)[!KU( f_.231, ~x.219 )] )
                      case fresh
                      by solve( KU((#vr.204, 1), ~ekR.157) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.230, 0)[!KU( f_.231, ~x.219 )] )
                      case fresh
                      by solve( (#vf.233, 0)[!KU( f_.234, ~x.168 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.204, 1), ~ekR.157) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.230, 0)[!KU( f_.231, ~x.168 )] )
                  next
                    case mac
                    solve( (#vr.211, 1)[!KU( f_.213,
                                             sign(<x.199^x.200, 'g'^~tid.164>, ~x.168)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.204, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.241, 0)[!KU( f_.242, ~x.168 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.239, 0)[!KU( f_.240, ~x.228 )] )
                        case fresh
                        by solve( KU((#vr.204, 1), ~ekR.157) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.239, 0)[!KU( f_.240, ~x.228 )] )
                        case fresh
                        by solve( (#vf.242, 0)[!KU( f_.243, ~x.168 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.204, 1), ~ekR.157) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.239, 0)[!KU( f_.240, ~x.168 )] )
                    next
                      case sign
                      by solve( (#vr.219, 1)[!KU( f_.221, ~x.168 )] )
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_6
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.181, 0)[!KU( f_.182, ~ltkR.169 )] )
                    case fresh
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekR.236 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.181, 0)[!KU( f_.182, ~ltkR.169 )] )
                    case fresh
                    by solve( (#vr.223, 1)[!KU( f_.224, ~ekI.246 )] )
                  qed
                next
                  case exp
                  solve( (#vf.181, 0)[!KU( f_.182, ~ltkR.169 )] )
                    case fresh
                    solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                sign(<x.200^x.201, 'g'^~tid.164>, ~x.168))) )
                      case Init_2_case_1
                      by solve( KU((#vr.205, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.239, 0)[!KU( f_.240, ~x.168 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.237, 0)[!KU( f_.238, ~x.226 )] )
                        case fresh
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.237, 0)[!KU( f_.238, ~x.226 )] )
                        case fresh
                        by solve( (#vf.240, 0)[!KU( f_.241, ~x.168 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.205, 1), ~ekR.157) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.237, 0)[!KU( f_.238, ~x.168 )] )
                    next
                      case mac
                      solve( (#vr.218, 1)[!KU( f_.220,
                                               sign(<x.200^x.201, 'g'^~tid.164>, ~x.168)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.248, 0)[!KU( f_.249, ~x.168 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.246, 0)[!KU( f_.247, ~x.235 )] )
                          case fresh
                          by solve( KU((#vr.205, 1), ~ekR.157) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.246, 0)[!KU( f_.247, ~x.235 )] )
                          case fresh
                          by solve( (#vf.249, 0)[!KU( f_.250, ~x.168 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.246, 0)[!KU( f_.247, ~x.168 )] )
                      next
                        case sign
                        by solve( (#vr.226, 1)[!KU( f_.228, ~x.168 )] )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_7
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    by solve( (#vr.217, 1)[!KU( f_.218, ~ekR.236 )] )
                  qed
                next
                  case Resp_1
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    by solve( (#vr.223, 1)[!KU( f_.224, ~ekI.246 )] )
                  qed
                next
                  case exp
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                sign(<x.200^x.201, 'g'^~tid.164>, ~x.168))) )
                      case Init_2_case_1
                      by solve( KU((#vr.205, 1), ~ekR.157) )
                    next
                      case Init_2_case_2
                      solve( (#vf.237, 0)[!KU( f_.238, ~x.226 )] )
                        case fresh
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.205, 1), ~ekR.157) )
                    next
                      case mac
                      solve( (#vr.218, 1)[!KU( f_.220,
                                               sign(<x.200^x.201, 'g'^~tid.164>, ~x.168)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        solve( (#vf.246, 0)[!KU( f_.247, ~x.235 )] )
                          case fresh
                          by solve( KU((#vr.205, 1), ~ekR.157) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      next
                        case sign
                        by solve( KU((#vr.205, 1), ~ekR.157) )
                      qed
                    qed
                  qed
                qed
              next
                case Sessionkey_Reveal_case_8
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    solve( (#vf.182, 0)[!KU( f_.183, ~ltkR.169 )] )
                      case fresh
                      by solve( (#vr.218, 1)[!KU( f_.219, ~ekR.237 )] )
                    qed
                  qed
                next
                  case Resp_1
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    solve( (#vf.182, 0)[!KU( f_.183, ~ltkR.169 )] )
                      case fresh
                      by solve( (#vr.224, 1)[!KU( f_.225, ~ekI.247 )] )
                    qed
                  qed
                next
                  case exp
                  solve( (#vf.174, 0)[!KU( f_.175, ~x.168 )] )
                    case fresh
                    solve( (#vf.182, 0)[!KU( f_.183, ~ltkR.169 )] )
                      case fresh
                      solve( KU((#vf.171, 0), mac('g'^(~ekR.157*~ekI.158),
                                                  sign(<x.201^x.202, 'g'^~tid.164>, ~x.168))) )
                        case Init_2_case_1
                        by solve( KU((#vr.206, 1), ~ekR.157) )
                      next
                        case Init_2_case_2
                        solve( (#vf.244, 0)[!KU( f_.245, ~x.233 )] )
                          case fresh
                          by solve( KU((#vr.206, 1), ~ekR.157) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.206, 1), ~ekR.157) )
                      next
                        case mac
                        solve( (#vr.225, 1)[!KU( f_.227,
                                                 sign(<x.201^x.202, 'g'^~tid.164>, ~x.168)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.206, 1), ~ekR.157) )
                        next
                          case Init_2_case_2
                          solve( (#vf.253, 0)[!KU( f_.254, ~x.242 )] )
                            case fresh
                            by solve( KU((#vr.206, 1), ~ekR.157) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.206, 1), ~ekR.157) )
                        next
                          case sign
                          by solve( KU((#vr.206, 1), ~ekR.157) )
                        qed
                      qed
                    qed
                  qed
                qed
              next
                case h
                solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.157*~ekI.158) )] )
                  case Init_1
                  by solve( (#vr.179, 1)[!KU( f_.180, ~ekR.198 )] )
                next
                  case Resp_1
                  by solve( (#vr.185, 1)[!KU( f_.186, ~ekI.208 )] )
                next
                  case exp
                  by solve( KU((#vr.167, 1), ~ekR.157) )
                qed
              qed
            next
              case split_case_2
              by contradiction // non-normal terms
            qed
          next
            case sign
            by solve( (#vr.116, 1)[!KU( f_.118, ~x.64 )] )
          qed
        qed
      next
        case Init_2_case_2
        by solve( (#vf.77, 0)[!KU( f_.78, ~x.12 )] )
      next
        case Init_2_case_3
        solve( (#vf.75, 0)[!KU( f_.76, ~x.64 )] )
          case fresh
          solve( KU((#vf.65, 0), mac(x.104^x.105,
                                     sign(<'g'^~ekR.8, 'g'^~ekI.56>, ~x.64))) )
            case mac
            solve( (#vr.115, 1)[!KU( f_.117, sign(<'g'^~ekR.8, 'g'^~ekI.56>, ~x.64)
                                )] )
              case sign
              solve( splitEqs(1) )
                case split_case_1
                solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.128*~ekI.129)) )] )
                  case Sessionkey_Reveal_case_1
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    by solve( (#vr.183, 1)[!KU( f_.184, ~ekR.202 )] )
                  next
                    case Resp_1
                    by solve( (#vr.189, 1)[!KU( f_.190, ~ekI.212 )] )
                  next
                    case exp
                    solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                sign(<x.166^x.167, 'g'^~tid.135>, ~x.140))) )
                      case Init_2_case_1
                      by solve( KU((#vr.171, 1), ~ekR.128) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.199, 0)[!KU( f_.200, ~x.140 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.197, 0)[!KU( f_.198, ~x.186 )] )
                        case fresh
                        by solve( KU((#vr.171, 1), ~ekR.128) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.197, 0)[!KU( f_.198, ~x.186 )] )
                        case fresh
                        by solve( (#vf.200, 0)[!KU( f_.201, ~x.140 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.171, 1), ~ekR.128) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.197, 0)[!KU( f_.198, ~x.140 )] )
                    next
                      case mac
                      solve( (#vr.178, 1)[!KU( f_.180,
                                               sign(<x.166^x.167, 'g'^~tid.135>, ~x.140)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.171, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.208, 0)[!KU( f_.209, ~x.140 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                          case fresh
                          by solve( KU((#vr.171, 1), ~ekR.128) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.206, 0)[!KU( f_.207, ~x.195 )] )
                          case fresh
                          by solve( (#vf.209, 0)[!KU( f_.210, ~x.140 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.171, 1), ~ekR.128) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.206, 0)[!KU( f_.207, ~x.140 )] )
                      next
                        case sign
                        by solve( (#vr.186, 1)[!KU( f_.188, ~x.140 )] )
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_2
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.149, 0)[!KU( f_.150, ~ltkI.139 )] )
                      case fresh
                      by solve( (#vr.184, 1)[!KU( f_.185, ~ekR.203 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vf.149, 0)[!KU( f_.150, ~ltkI.139 )] )
                      case fresh
                      by solve( (#vr.190, 1)[!KU( f_.191, ~ekI.213 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.149, 0)[!KU( f_.150, ~ltkI.139 )] )
                      case fresh
                      solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                  sign(<x.167^x.168, 'g'^~tid.135>, ~x.140))) )
                        case Init_2_case_1
                        by solve( KU((#vr.172, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.206, 0)[!KU( f_.207, ~x.140 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.204, 0)[!KU( f_.205, ~x.193 )] )
                          case fresh
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.204, 0)[!KU( f_.205, ~x.193 )] )
                          case fresh
                          by solve( (#vf.207, 0)[!KU( f_.208, ~x.140 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.172, 1), ~ekR.128) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.204, 0)[!KU( f_.205, ~x.140 )] )
                      next
                        case mac
                        solve( (#vr.185, 1)[!KU( f_.187,
                                                 sign(<x.167^x.168, 'g'^~tid.135>, ~x.140)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          by solve( (#vf.215, 0)[!KU( f_.216, ~x.140 )] )
                        next
                          case Init_2_case_3
                          solve( (#vf.213, 0)[!KU( f_.214, ~x.202 )] )
                            case fresh
                            by solve( KU((#vr.172, 1), ~ekR.128) )
                          qed
                        next
                          case Init_2_case_4
                          solve( (#vf.213, 0)[!KU( f_.214, ~x.202 )] )
                            case fresh
                            by solve( (#vf.216, 0)[!KU( f_.217, ~x.140 )] )
                          qed
                        next
                          case Resp_1_case_1
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        next
                          case Resp_1_case_2
                          by solve( (#vf.213, 0)[!KU( f_.214, ~x.140 )] )
                        next
                          case sign
                          by solve( (#vr.193, 1)[!KU( f_.195, ~x.140 )] )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_3
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      by solve( (#vr.184, 1)[!KU( f_.185, ~ekR.203 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      by solve( (#vr.190, 1)[!KU( f_.191, ~ekI.213 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                  sign(<x.167^x.168, 'g'^~tid.135>, ~x.140))) )
                        case Init_2_case_1
                        by solve( KU((#vr.172, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        solve( (#vf.204, 0)[!KU( f_.205, ~x.193 )] )
                          case fresh
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.172, 1), ~ekR.128) )
                      next
                        case mac
                        solve( (#vr.185, 1)[!KU( f_.187,
                                                 sign(<x.167^x.168, 'g'^~tid.135>, ~x.140)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          solve( (#vf.213, 0)[!KU( f_.214, ~x.202 )] )
                            case fresh
                            by solve( KU((#vr.172, 1), ~ekR.128) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        next
                          case sign
                          by solve( KU((#vr.172, 1), ~ekR.128) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_4
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      solve( (#vf.150, 0)[!KU( f_.151, ~ltkI.139 )] )
                        case fresh
                        by solve( (#vr.185, 1)[!KU( f_.186, ~ekR.204 )] )
                      qed
                    qed
                  next
                    case Resp_1
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      solve( (#vf.150, 0)[!KU( f_.151, ~ltkI.139 )] )
                        case fresh
                        by solve( (#vr.191, 1)[!KU( f_.192, ~ekI.214 )] )
                      qed
                    qed
                  next
                    case exp
                    solve( (#vf.147, 0)[!KU( f_.148, ~x.140 )] )
                      case fresh
                      solve( (#vf.150, 0)[!KU( f_.151, ~ltkI.139 )] )
                        case fresh
                        solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                    sign(<x.168^x.169, 'g'^~tid.135>, ~x.140))) )
                          case Init_2_case_1
                          by solve( KU((#vr.173, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          solve( (#vf.211, 0)[!KU( f_.212, ~x.200 )] )
                            case fresh
                            by solve( KU((#vr.173, 1), ~ekR.128) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.173, 1), ~ekR.128) )
                        next
                          case mac
                          solve( (#vr.192, 1)[!KU( f_.194,
                                                   sign(<x.168^x.169, 'g'^~tid.135>, ~x.140)
                                              )] )
                            case Init_2_case_1
                            by solve( KU((#vr.173, 1), ~ekR.128) )
                          next
                            case Init_2_case_2
                            solve( (#vf.220, 0)[!KU( f_.221, ~x.209 )] )
                              case fresh
                              by solve( KU((#vr.173, 1), ~ekR.128) )
                            qed
                          next
                            case Resp_1
                            by solve( KU((#vr.173, 1), ~ekR.128) )
                          next
                            case sign
                            by solve( KU((#vr.173, 1), ~ekR.128) )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_5
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    by solve( (#vr.187, 1)[!KU( f_.188, ~ekR.206 )] )
                  next
                    case Resp_1
                    by solve( (#vr.193, 1)[!KU( f_.194, ~ekI.216 )] )
                  next
                    case exp
                    solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                sign(<x.170^x.171, 'g'^~tid.135>, ~x.139))) )
                      case Init_2_case_1
                      by solve( KU((#vr.175, 1), ~ekR.128) )
                    next
                      case Init_2_case_2
                      by solve( (#vf.203, 0)[!KU( f_.204, ~x.139 )] )
                    next
                      case Init_2_case_3
                      solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                        case fresh
                        by solve( KU((#vr.175, 1), ~ekR.128) )
                      qed
                    next
                      case Init_2_case_4
                      solve( (#vf.201, 0)[!KU( f_.202, ~x.190 )] )
                        case fresh
                        by solve( (#vf.204, 0)[!KU( f_.205, ~x.139 )] )
                      qed
                    next
                      case Resp_1_case_1
                      by solve( KU((#vr.175, 1), ~ekR.128) )
                    next
                      case Resp_1_case_2
                      by solve( (#vf.201, 0)[!KU( f_.202, ~x.139 )] )
                    next
                      case mac
                      solve( (#vr.182, 1)[!KU( f_.184,
                                               sign(<x.170^x.171, 'g'^~tid.135>, ~x.139)
                                          )] )
                        case Init_2_case_1
                        by solve( KU((#vr.175, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.212, 0)[!KU( f_.213, ~x.139 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                          case fresh
                          by solve( KU((#vr.175, 1), ~ekR.128) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.210, 0)[!KU( f_.211, ~x.199 )] )
                          case fresh
                          by solve( (#vf.213, 0)[!KU( f_.214, ~x.139 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.175, 1), ~ekR.128) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.210, 0)[!KU( f_.211, ~x.139 )] )
                      next
                        case sign
                        by solve( (#vr.190, 1)[!KU( f_.192, ~x.139 )] )
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_6
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.152, 0)[!KU( f_.153, ~ltkR.140 )] )
                      case fresh
                      by solve( (#vr.188, 1)[!KU( f_.189, ~ekR.207 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vf.152, 0)[!KU( f_.153, ~ltkR.140 )] )
                      case fresh
                      by solve( (#vr.194, 1)[!KU( f_.195, ~ekI.217 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.152, 0)[!KU( f_.153, ~ltkR.140 )] )
                      case fresh
                      solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                  sign(<x.171^x.172, 'g'^~tid.135>, ~x.139))) )
                        case Init_2_case_1
                        by solve( KU((#vr.176, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        by solve( (#vf.210, 0)[!KU( f_.211, ~x.139 )] )
                      next
                        case Init_2_case_3
                        solve( (#vf.208, 0)[!KU( f_.209, ~x.197 )] )
                          case fresh
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        qed
                      next
                        case Init_2_case_4
                        solve( (#vf.208, 0)[!KU( f_.209, ~x.197 )] )
                          case fresh
                          by solve( (#vf.211, 0)[!KU( f_.212, ~x.139 )] )
                        qed
                      next
                        case Resp_1_case_1
                        by solve( KU((#vr.176, 1), ~ekR.128) )
                      next
                        case Resp_1_case_2
                        by solve( (#vf.208, 0)[!KU( f_.209, ~x.139 )] )
                      next
                        case mac
                        solve( (#vr.189, 1)[!KU( f_.191,
                                                 sign(<x.171^x.172, 'g'^~tid.135>, ~x.139)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          by solve( (#vf.219, 0)[!KU( f_.220, ~x.139 )] )
                        next
                          case Init_2_case_3
                          solve( (#vf.217, 0)[!KU( f_.218, ~x.206 )] )
                            case fresh
                            by solve( KU((#vr.176, 1), ~ekR.128) )
                          qed
                        next
                          case Init_2_case_4
                          solve( (#vf.217, 0)[!KU( f_.218, ~x.206 )] )
                            case fresh
                            by solve( (#vf.220, 0)[!KU( f_.221, ~x.139 )] )
                          qed
                        next
                          case Resp_1_case_1
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        next
                          case Resp_1_case_2
                          by solve( (#vf.217, 0)[!KU( f_.218, ~x.139 )] )
                        next
                          case sign
                          by solve( (#vr.197, 1)[!KU( f_.199, ~x.139 )] )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_7
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      by solve( (#vr.188, 1)[!KU( f_.189, ~ekR.207 )] )
                    qed
                  next
                    case Resp_1
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      by solve( (#vr.194, 1)[!KU( f_.195, ~ekI.217 )] )
                    qed
                  next
                    case exp
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                  sign(<x.171^x.172, 'g'^~tid.135>, ~x.139))) )
                        case Init_2_case_1
                        by solve( KU((#vr.176, 1), ~ekR.128) )
                      next
                        case Init_2_case_2
                        solve( (#vf.208, 0)[!KU( f_.209, ~x.197 )] )
                          case fresh
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        qed
                      next
                        case Resp_1
                        by solve( KU((#vr.176, 1), ~ekR.128) )
                      next
                        case mac
                        solve( (#vr.189, 1)[!KU( f_.191,
                                                 sign(<x.171^x.172, 'g'^~tid.135>, ~x.139)
                                            )] )
                          case Init_2_case_1
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          solve( (#vf.217, 0)[!KU( f_.218, ~x.206 )] )
                            case fresh
                            by solve( KU((#vr.176, 1), ~ekR.128) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        next
                          case sign
                          by solve( KU((#vr.176, 1), ~ekR.128) )
                        qed
                      qed
                    qed
                  qed
                next
                  case Sessionkey_Reveal_case_8
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      solve( (#vf.153, 0)[!KU( f_.154, ~ltkR.140 )] )
                        case fresh
                        by solve( (#vr.189, 1)[!KU( f_.190, ~ekR.208 )] )
                      qed
                    qed
                  next
                    case Resp_1
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      solve( (#vf.153, 0)[!KU( f_.154, ~ltkR.140 )] )
                        case fresh
                        by solve( (#vr.195, 1)[!KU( f_.196, ~ekI.218 )] )
                      qed
                    qed
                  next
                    case exp
                    solve( (#vf.145, 0)[!KU( f_.146, ~x.139 )] )
                      case fresh
                      solve( (#vf.153, 0)[!KU( f_.154, ~ltkR.140 )] )
                        case fresh
                        solve( KU((#vf.142, 0), mac('g'^(~ekR.128*~ekI.129),
                                                    sign(<x.172^x.173, 'g'^~tid.135>, ~x.139))) )
                          case Init_2_case_1
                          by solve( KU((#vr.177, 1), ~ekR.128) )
                        next
                          case Init_2_case_2
                          solve( (#vf.215, 0)[!KU( f_.216, ~x.204 )] )
                            case fresh
                            by solve( KU((#vr.177, 1), ~ekR.128) )
                          qed
                        next
                          case Resp_1
                          by solve( KU((#vr.177, 1), ~ekR.128) )
                        next
                          case mac
                          solve( (#vr.196, 1)[!KU( f_.198,
                                                   sign(<x.172^x.173, 'g'^~tid.135>, ~x.139)
                                              )] )
                            case Init_2_case_1
                            by solve( KU((#vr.177, 1), ~ekR.128) )
                          next
                            case Init_2_case_2
                            solve( (#vf.224, 0)[!KU( f_.225, ~x.213 )] )
                              case fresh
                              by solve( KU((#vr.177, 1), ~ekR.128) )
                            qed
                          next
                            case Resp_1
                            by solve( KU((#vr.177, 1), ~ekR.128) )
                          next
                            case sign
                            by solve( KU((#vr.177, 1), ~ekR.128) )
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case h
                  solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.128*~ekI.129) )] )
                    case Init_1
                    by solve( (#vr.150, 1)[!KU( f_.151, ~ekR.169 )] )
                  next
                    case Resp_1
                    by solve( (#vr.156, 1)[!KU( f_.157, ~ekI.179 )] )
                  next
                    case exp
                    by solve( KU((#vr.138, 1), ~ekR.128) )
                  qed
                qed
              next
                case split_case_2
                by contradiction // non-normal terms
              qed
            qed
          qed
        qed
      next
        case Init_2_case_4
        solve( (#vf.75, 0)[!KU( f_.76, ~x.64 )] )
          case fresh
          by solve( (#vf.78, 0)[!KU( f_.79, ~x.12 )] )
        qed
      next
        case Resp_1_case_1
        solve( splitEqs(1) )
          case split_case_1
          solve( (#k.5, 0)[!KU( f_.17, h('g'^(~ekR.100*~ekR.101)) )] )
            case Sessionkey_Reveal_case_1
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              by solve( (#vr.161, 1)[!KU( f_.162, ~ekR.184 )] )
            next
              case Resp_1_case_2
              by solve( (#vr.161, 1)[!KU( f_.162, ~ekR.183 )] )
            next
              case exp
              solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                          sign(<x.138^x.139, 'g'^~tid.107>, ~x.112))) )
                case Init_2_case_1
                by solve( KU((#vr.143, 1), ~ekR.100) )
              next
                case Init_2_case_2
                by solve( (#vf.171, 0)[!KU( f_.172, ~x.112 )] )
              next
                case Init_2_case_3
                solve( (#vf.169, 0)[!KU( f_.170, ~x.158 )] )
                  case fresh
                  by solve( KU((#vr.143, 1), ~ekR.100) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.169, 0)[!KU( f_.170, ~x.158 )] )
                  case fresh
                  by solve( (#vf.172, 0)[!KU( f_.173, ~x.112 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.143, 1), ~ekR.100) )
              next
                case Resp_1_case_2
                by solve( (#vf.169, 0)[!KU( f_.170, ~x.112 )] )
              next
                case mac
                solve( (#vr.150, 1)[!KU( f_.152,
                                         sign(<x.138^x.139, 'g'^~tid.107>, ~x.112)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.143, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  by solve( (#vf.180, 0)[!KU( f_.181, ~x.112 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.178, 0)[!KU( f_.179, ~x.167 )] )
                    case fresh
                    by solve( KU((#vr.143, 1), ~ekR.100) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.178, 0)[!KU( f_.179, ~x.167 )] )
                    case fresh
                    by solve( (#vf.181, 0)[!KU( f_.182, ~x.112 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.143, 1), ~ekR.100) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.178, 0)[!KU( f_.179, ~x.112 )] )
                next
                  case sign
                  by solve( (#vr.158, 1)[!KU( f_.160, ~x.112 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_2
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.121, 0)[!KU( f_.122, ~ltkI.111 )] )
                case fresh
                by solve( (#vr.162, 1)[!KU( f_.163, ~ekR.185 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vf.121, 0)[!KU( f_.122, ~ltkI.111 )] )
                case fresh
                by solve( (#vr.162, 1)[!KU( f_.163, ~ekR.184 )] )
              qed
            next
              case exp
              solve( (#vf.121, 0)[!KU( f_.122, ~ltkI.111 )] )
                case fresh
                solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                            sign(<x.139^x.140, 'g'^~tid.107>, ~x.112))) )
                  case Init_2_case_1
                  by solve( KU((#vr.144, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  by solve( (#vf.178, 0)[!KU( f_.179, ~x.112 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.165 )] )
                    case fresh
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.165 )] )
                    case fresh
                    by solve( (#vf.179, 0)[!KU( f_.180, ~x.112 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.144, 1), ~ekR.100) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.176, 0)[!KU( f_.177, ~x.112 )] )
                next
                  case mac
                  solve( (#vr.157, 1)[!KU( f_.159,
                                           sign(<x.139^x.140, 'g'^~tid.107>, ~x.112)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.187, 0)[!KU( f_.188, ~x.112 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.185, 0)[!KU( f_.186, ~x.174 )] )
                      case fresh
                      by solve( KU((#vr.144, 1), ~ekR.100) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.185, 0)[!KU( f_.186, ~x.174 )] )
                      case fresh
                      by solve( (#vf.188, 0)[!KU( f_.189, ~x.112 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.185, 0)[!KU( f_.186, ~x.112 )] )
                  next
                    case sign
                    by solve( (#vr.165, 1)[!KU( f_.167, ~x.112 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_3
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                by solve( (#vr.162, 1)[!KU( f_.163, ~ekR.185 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                by solve( (#vr.162, 1)[!KU( f_.163, ~ekR.184 )] )
              qed
            next
              case exp
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                            sign(<x.139^x.140, 'g'^~tid.107>, ~x.112))) )
                  case Init_2_case_1
                  by solve( KU((#vr.144, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  solve( (#vf.176, 0)[!KU( f_.177, ~x.165 )] )
                    case fresh
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.144, 1), ~ekR.100) )
                next
                  case mac
                  solve( (#vr.157, 1)[!KU( f_.159,
                                           sign(<x.139^x.140, 'g'^~tid.107>, ~x.112)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    solve( (#vf.185, 0)[!KU( f_.186, ~x.174 )] )
                      case fresh
                      by solve( KU((#vr.144, 1), ~ekR.100) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  next
                    case sign
                    by solve( KU((#vr.144, 1), ~ekR.100) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_4
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                solve( (#vf.122, 0)[!KU( f_.123, ~ltkI.111 )] )
                  case fresh
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.186 )] )
                qed
              qed
            next
              case Resp_1_case_2
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                solve( (#vf.122, 0)[!KU( f_.123, ~ltkI.111 )] )
                  case fresh
                  by solve( (#vr.163, 1)[!KU( f_.164, ~ekR.185 )] )
                qed
              qed
            next
              case exp
              solve( (#vf.119, 0)[!KU( f_.120, ~x.112 )] )
                case fresh
                solve( (#vf.122, 0)[!KU( f_.123, ~ltkI.111 )] )
                  case fresh
                  solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                              sign(<x.140^x.141, 'g'^~tid.107>, ~x.112))) )
                    case Init_2_case_1
                    by solve( KU((#vr.145, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    solve( (#vf.183, 0)[!KU( f_.184, ~x.172 )] )
                      case fresh
                      by solve( KU((#vr.145, 1), ~ekR.100) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.145, 1), ~ekR.100) )
                  next
                    case mac
                    solve( (#vr.164, 1)[!KU( f_.166,
                                             sign(<x.140^x.141, 'g'^~tid.107>, ~x.112)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.145, 1), ~ekR.100) )
                    next
                      case Init_2_case_2
                      solve( (#vf.192, 0)[!KU( f_.193, ~x.181 )] )
                        case fresh
                        by solve( KU((#vr.145, 1), ~ekR.100) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.145, 1), ~ekR.100) )
                    next
                      case sign
                      by solve( KU((#vr.145, 1), ~ekR.100) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_5
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              by solve( (#vr.165, 1)[!KU( f_.166, ~ekR.188 )] )
            next
              case Resp_1_case_2
              by solve( (#vr.165, 1)[!KU( f_.166, ~ekR.187 )] )
            next
              case exp
              solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                          sign(<x.142^x.143, 'g'^~tid.107>, ~x.111))) )
                case Init_2_case_1
                by solve( KU((#vr.147, 1), ~ekR.100) )
              next
                case Init_2_case_2
                by solve( (#vf.175, 0)[!KU( f_.176, ~x.111 )] )
              next
                case Init_2_case_3
                solve( (#vf.173, 0)[!KU( f_.174, ~x.162 )] )
                  case fresh
                  by solve( KU((#vr.147, 1), ~ekR.100) )
                qed
              next
                case Init_2_case_4
                solve( (#vf.173, 0)[!KU( f_.174, ~x.162 )] )
                  case fresh
                  by solve( (#vf.176, 0)[!KU( f_.177, ~x.111 )] )
                qed
              next
                case Resp_1_case_1
                by solve( KU((#vr.147, 1), ~ekR.100) )
              next
                case Resp_1_case_2
                by solve( (#vf.173, 0)[!KU( f_.174, ~x.111 )] )
              next
                case mac
                solve( (#vr.154, 1)[!KU( f_.156,
                                         sign(<x.142^x.143, 'g'^~tid.107>, ~x.111)
                                    )] )
                  case Init_2_case_1
                  by solve( KU((#vr.147, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  by solve( (#vf.184, 0)[!KU( f_.185, ~x.111 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                    case fresh
                    by solve( KU((#vr.147, 1), ~ekR.100) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.182, 0)[!KU( f_.183, ~x.171 )] )
                    case fresh
                    by solve( (#vf.185, 0)[!KU( f_.186, ~x.111 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.147, 1), ~ekR.100) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.182, 0)[!KU( f_.183, ~x.111 )] )
                next
                  case sign
                  by solve( (#vr.162, 1)[!KU( f_.164, ~x.111 )] )
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_6
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.124, 0)[!KU( f_.125, ~ltkR.112 )] )
                case fresh
                by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vf.124, 0)[!KU( f_.125, ~ltkR.112 )] )
                case fresh
                by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
              qed
            next
              case exp
              solve( (#vf.124, 0)[!KU( f_.125, ~ltkR.112 )] )
                case fresh
                solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                            sign(<x.143^x.144, 'g'^~tid.107>, ~x.111))) )
                  case Init_2_case_1
                  by solve( KU((#vr.148, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  by solve( (#vf.182, 0)[!KU( f_.183, ~x.111 )] )
                next
                  case Init_2_case_3
                  solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                    case fresh
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  qed
                next
                  case Init_2_case_4
                  solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                    case fresh
                    by solve( (#vf.183, 0)[!KU( f_.184, ~x.111 )] )
                  qed
                next
                  case Resp_1_case_1
                  by solve( KU((#vr.148, 1), ~ekR.100) )
                next
                  case Resp_1_case_2
                  by solve( (#vf.180, 0)[!KU( f_.181, ~x.111 )] )
                next
                  case mac
                  solve( (#vr.161, 1)[!KU( f_.163,
                                           sign(<x.143^x.144, 'g'^~tid.107>, ~x.111)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    by solve( (#vf.191, 0)[!KU( f_.192, ~x.111 )] )
                  next
                    case Init_2_case_3
                    solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                      case fresh
                      by solve( KU((#vr.148, 1), ~ekR.100) )
                    qed
                  next
                    case Init_2_case_4
                    solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                      case fresh
                      by solve( (#vf.192, 0)[!KU( f_.193, ~x.111 )] )
                    qed
                  next
                    case Resp_1_case_1
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  next
                    case Resp_1_case_2
                    by solve( (#vf.189, 0)[!KU( f_.190, ~x.111 )] )
                  next
                    case sign
                    by solve( (#vr.169, 1)[!KU( f_.171, ~x.111 )] )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_7
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.189 )] )
              qed
            next
              case Resp_1_case_2
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                by solve( (#vr.166, 1)[!KU( f_.167, ~ekR.188 )] )
              qed
            next
              case exp
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                            sign(<x.143^x.144, 'g'^~tid.107>, ~x.111))) )
                  case Init_2_case_1
                  by solve( KU((#vr.148, 1), ~ekR.100) )
                next
                  case Init_2_case_2
                  solve( (#vf.180, 0)[!KU( f_.181, ~x.169 )] )
                    case fresh
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  qed
                next
                  case Resp_1
                  by solve( KU((#vr.148, 1), ~ekR.100) )
                next
                  case mac
                  solve( (#vr.161, 1)[!KU( f_.163,
                                           sign(<x.143^x.144, 'g'^~tid.107>, ~x.111)
                                      )] )
                    case Init_2_case_1
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    solve( (#vf.189, 0)[!KU( f_.190, ~x.178 )] )
                      case fresh
                      by solve( KU((#vr.148, 1), ~ekR.100) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  next
                    case sign
                    by solve( KU((#vr.148, 1), ~ekR.100) )
                  qed
                qed
              qed
            qed
          next
            case Sessionkey_Reveal_case_8
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                solve( (#vf.125, 0)[!KU( f_.126, ~ltkR.112 )] )
                  case fresh
                  by solve( (#vr.167, 1)[!KU( f_.168, ~ekR.190 )] )
                qed
              qed
            next
              case Resp_1_case_2
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                solve( (#vf.125, 0)[!KU( f_.126, ~ltkR.112 )] )
                  case fresh
                  by solve( (#vr.167, 1)[!KU( f_.168, ~ekR.189 )] )
                qed
              qed
            next
              case exp
              solve( (#vf.117, 0)[!KU( f_.118, ~x.111 )] )
                case fresh
                solve( (#vf.125, 0)[!KU( f_.126, ~ltkR.112 )] )
                  case fresh
                  solve( KU((#vf.114, 0), mac('g'^(~ekR.100*~ekR.101),
                                              sign(<x.144^x.145, 'g'^~tid.107>, ~x.111))) )
                    case Init_2_case_1
                    by solve( KU((#vr.149, 1), ~ekR.100) )
                  next
                    case Init_2_case_2
                    solve( (#vf.187, 0)[!KU( f_.188, ~x.176 )] )
                      case fresh
                      by solve( KU((#vr.149, 1), ~ekR.100) )
                    qed
                  next
                    case Resp_1
                    by solve( KU((#vr.149, 1), ~ekR.100) )
                  next
                    case mac
                    solve( (#vr.168, 1)[!KU( f_.170,
                                             sign(<x.144^x.145, 'g'^~tid.107>, ~x.111)
                                        )] )
                      case Init_2_case_1
                      by solve( KU((#vr.149, 1), ~ekR.100) )
                    next
                      case Init_2_case_2
                      solve( (#vf.196, 0)[!KU( f_.197, ~x.185 )] )
                        case fresh
                        by solve( KU((#vr.149, 1), ~ekR.100) )
                      qed
                    next
                      case Resp_1
                      by solve( KU((#vr.149, 1), ~ekR.100) )
                    next
                      case sign
                      by solve( KU((#vr.149, 1), ~ekR.100) )
                    qed
                  qed
                qed
              qed
            qed
          next
            case h
            solve( (#vr.47, 0)[!KU( f_.48, 'g'^(~ekR.100*~ekR.101) )] )
              case Resp_1_case_1
              by solve( (#vr.128, 1)[!KU( f_.129, ~ekR.151 )] )
            next
              case Resp_1_case_2
              by solve( (#vr.128, 1)[!KU( f_.129, ~ekR.150 )] )
            next
              case exp
              by solve( KU((#vr.110, 1), ~ekR.100) )
            qed
          qed
        next
          case split_case_2
          by contradiction // non-normal terms
        qed
      next
        case Resp_1_case_2
        by solve( (#vf.75, 0)[!KU( f_.76, ~x.12 )] )
      next
        case sign
        by solve( (#vr.55, 1)[!KU( f_.57, ~x.12 )] )
      qed
    qed
  next
    case Resp_1_case_2
    by contradiction // from formulas
  qed
qed

/* All well-formedness checks were successful. */

end
/* Output
maude tool: 'maude'
 checking version: 2.6. OK.


analyzing: data/examples/STS-MAC-fix1.spthy

------------------------------------------------------------------------------
analyzed: data/examples/STS-MAC-fix1.spthy

  output:          case-studies/temp-analysis.spthy
  processing time: 241.456748s
  KI_Perfect_Forward_Secrecy_I: complete proof (956 steps)
  KI_Perfect_Forward_Secrecy_R: complete proof (1909 steps)

------------------------------------------------------------------------------

==============================================================================
summary of processed files:

analyzed: data/examples/STS-MAC-fix1.spthy

  output:          case-studies/temp-analysis.spthy
  processing time: 241.456748s
  KI_Perfect_Forward_Secrecy_I: complete proof (956 steps)
  KI_Perfect_Forward_Secrecy_R: complete proof (1909 steps)

==============================================================================
*/

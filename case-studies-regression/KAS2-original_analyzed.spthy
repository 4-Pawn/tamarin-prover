theory KAS2_original begin

// Function signature and definition of the equational theory E

functions: KDF/1, MAC/2, adec/2, aenc/2, fst/1, h/1, pair/2, pk/1, snd/1
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2

section{* KAS2 *}

rule (modulo E) Register_pk:
   [ Fr( ~ltkA ) ]
  -->
   [ !Ltk( $A, ~ltkA ), !Pk( $A, pk(~ltkA) ), Out( pk(~ltkA) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Init_1:
   [ Fr( ~m1 ), !Ltk( $I, ~lkI ), !Pk( $R, pkR ) ]
  --[ Sid( ~m1, $I, $R, <$I, $R, 'Init', aenc(~m1, pkR)> ) ]->
   [
   Init_1( ~m1, $I, $R, ~lkI, ~m1, aenc(~m1, pkR) ), !Ephk( ~m1, ~m1 ),
   Out( aenc(~m1, pkR) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Resp_1:
   [ Fr( ~m2 ), In( c1 ), !Ltk( $R, ~lkR ), !Pk( $I, pkI ) ]
  --[
  Sid( ~m2, $R, $I, <$R, $I, 'Resp', aenc(~m2, pkI), c1> ),
  Match( ~m2, <$I, $R, 'Init', c1> ),
  Match( ~m2, <$I, $R, 'Init', c1, aenc(~m2, pkI)> )
  ]->
   [
   Resp_1( ~m2, $I, $R, ~lkR, adec(c1, ~lkR), ~m2, c1, aenc(~m2, pkI) ),
   !Ephk( ~m2, ~m2 ),
   Out( <aenc(~m2, pkI), 
         MAC(KDF(<adec(c1, ~lkR), ~m2, $I, $R, c1, aenc(~m2, pkI)>),
             <'Resp', $R, $I, aenc(~m2, pkI), c1>)
        >
   )
   ]

  /*
  rule (modulo AC) Resp_1:
     [ Fr( ~m2.4 ), In( c1.5 ), !Ltk( $R.2, ~lkR.3 ), !Pk( $I.1, pkI.6 ) ]
    --[
    Sid( ~m2.4, $R.2, $I.1, <$R.2, $I.1, 'Resp', aenc(~m2.4, pkI.6), c1.5> ),
    Match( ~m2.4, <$I.1, $R.2, 'Init', c1.5> ),
    Match( ~m2.4, <$I.1, $R.2, 'Init', c1.5, aenc(~m2.4, pkI.6)> )
    ]->
     [
     Resp_1( ~m2.4, $I.1, $R.2, ~lkR.3, z.7, ~m2.4, c1.5, aenc(~m2.4, pkI.6)
     ),
     !Ephk( ~m2.4, ~m2.4 ),
     Out( <aenc(~m2.4, pkI.6), 
           MAC(KDF(<z.7, ~m2.4, $I.1, $R.2, c1.5, aenc(~m2.4, pkI.6)>),
               <'Resp', $R.2, $I.1, aenc(~m2.4, pkI.6), c1.5>)
          >
     )
     ]
  
    variants (modulo AC)
    1. ~lkR.3
             = ~lkR.38
       c1.5  = c1.40
       z.7   = adec(c1.40, ~lkR.38)
    
    2. ~lkR.3
             = ~lkR.42
       c1.5  = aenc(z.46, pk(~lkR.42))
       z.7   = z.46
  */

rule (modulo E) Init_2:
   [
   Init_1( ~m1, $I, $R, ~lkI, ~m1, c1 ),
   In( <c2, 
        MAC(KDF(<~m1, adec(c2, ~lkI), $I, $R, c1, c2>), <'Resp', $R, $I, c2, c1>)
       >
   )
   ]
  --[
  Sid( ~m1, $I, $R, <$I, $R, 'Init', c1, c2> ),
  Match( ~m1, <$R, $I, 'Resp', c2, c1> ),
  Accept( ~m1, KDF(<~m1, adec(c2, ~lkI), $I, $R, c1, c2>) )
  ]->
   [
   Out( MAC(KDF(<~m1, adec(c2, ~lkI), $I, $R, c1, c2>),
            <'Init', $I, $R, c1, c2>)
   ),
   !Sessk( ~m1, KDF(<~m1, adec(c2, ~lkI), $I, $R, c1, c2>) )
   ]

  /*
  rule (modulo AC) Init_2:
     [
     Init_1( ~m1.4, $I.1, $R.2, ~lkI.3, ~m1.4, c1.5 ),
     In( <c2.6, 
          MAC(KDF(<~m1.4, z.7, $I.1, $R.2, c1.5, c2.6>),
              <'Resp', $R.2, $I.1, c2.6, c1.5>)
         >
     )
     ]
    --[
    Sid( ~m1.4, $I.1, $R.2, <$I.1, $R.2, 'Init', c1.5, c2.6> ),
    Match( ~m1.4, <$R.2, $I.1, 'Resp', c2.6, c1.5> ),
    Accept( ~m1.4, KDF(<~m1.4, z.7, $I.1, $R.2, c1.5, c2.6>) )
    ]->
     [
     Out( MAC(KDF(<~m1.4, z.7, $I.1, $R.2, c1.5, c2.6>),
              <'Init', $I.1, $R.2, c1.5, c2.6>)
     ),
     !Sessk( ~m1.4, KDF(<~m1.4, z.7, $I.1, $R.2, c1.5, c2.6>) )
     ]
  
    variants (modulo AC)
    1. ~lkI.3
             = ~lkI.39
       c2.6  = c2.42
       z.7   = adec(c2.42, ~lkI.39)
    
    2. ~lkI.3
             = ~lkI.42
       c2.6  = aenc(z.46, pk(~lkI.42))
       z.7   = z.46
  */

rule (modulo E) Resp_2:
   [
   Resp_1( ~m2, $I, $R, ~lkR, m1, ~m2, c1, c2 ),
   In( MAC(KDF(<m1, ~m2, $I, $R, c1, c2>), <'Init', $I, $R, c1, c2>) )
   ]
  --[ Accept( ~m2, KDF(<m1, ~m2, $I, $R, c1, c2>) ) ]->
   [ !Sessk( ~m2, KDF(<m1, ~m2, $I, $R, c1, c2>) ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Sessk_reveal:
   [ !Sessk( ~tid, k ) ] --[ SesskRev( ~tid ) ]-> [ Out( k ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Ltk_reveal:
   [ !Ltk( $A, lkA ) ] --[ LtkRev( $A ) ]-> [ Out( lkA ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Ephk_reveal:
   [ !Ephk( ~s, ~ek ) ] --[ EphkRev( ~s ) ]-> [ Out( ~ek ) ]

  /* has exactly the trivial AC variant */

lemma (modulo E) KAS_key_secrecy:
  all-traces
  "not(Ex #i1 #i2.1 #i3.2 s.3 A.4 B.5 minfo.6 k.7.
        (((((Sid( s.3, A.4, B.5, minfo.6 ) @ #i1) & (K( k.7 ) @ #i2.1)) &
           (Accept( s.3, k.7 ) @ #i3.2)) &
          (not(Ex #i4.8. SesskRev( s.3 ) @ #i4.8))) &
         (All ss.9 #i4.10 #i5.11 C.12 D.13 ms.14.
           ((Sid( ss.9, C.12, D.13, ms.14 ) @ #i4.10) &
            (Match( s.3, ms.14 ) @ #i5.11)) ==>
           (((((not(Ex #i6.15 #i7.16 kpartner.17.
                     (Accept( ss.9, kpartner.17 ) @ #i6.15) & (SesskRev( ss.9 ) @ #i7.16))) &
               (not(Ex #i6.18 #i7.19.
                     (LtkRev( A.4 ) @ #i6.18) & (EphkRev( s.3 ) @ #i7.19)))) &
              (not(Ex #i6.20 #i7.21.
                    (LtkRev( B.5 ) @ #i6.20) & (EphkRev( ss.9 ) @ #i7.21)))) &
             (not(Ex #i6.22 #i7.23.
                   (LtkRev( A.4 ) @ #i6.22) & (LtkRev( B.5 ) @ #i7.23)))) &
            (not(Ex #i6.24 #i7.25.
                  (EphkRev( s.3 ) @ #i6.24) & (EphkRev( ss.9 ) @ #i7.25)))))) &
        ((not(Ex ss.26 #i4.27 #i5.28 C.29 D.30 ms.31.
               (Sid( ss.26, C.29, D.30, ms.31 ) @ #i4.27) &
               (Match( s.3, ms.31 ) @ #i5.28))) ==>
         ((not(Ex #i6.32. EphkRev( s.3 ) @ #i6.32)) &
          (not(Ex #i6.33. (LtkRev( B.5 ) @ #i6.33) & (#i6.33 < #i3.2))))))"
/* proof based on the same lemma modulo AC */
/*
guarded formula characterizing all counter-examples:
"Ex #i1 #i2.1 #i3.2 s.3 A.4 B.5 minfo.6 k.7.
  (Sid( s.3, A.4, B.5, minfo.6 ) @ #i1) &
  (K( k.7 ) @ #i2.1) &
  (Accept( s.3, k.7 ) @ #i3.2)
 &
  (All #i4.8. (SesskRev( s.3 ) @ #i4.8) ==> F) &
  (All ss.9 #i4.10 #i5.11 C.12 D.13 ms.14.
    (Sid( ss.9, C.12, D.13, ms.14 ) @ #i4.10) &
    (Match( s.3, ms.14 ) @ #i5.11)
   ==>
    (All #i6.15 #i7.16 kpartner.17.
      (Accept( ss.9, kpartner.17 ) @ #i6.15) & (SesskRev( ss.9 ) @ #i7.16)
     ==>
      F) &
    (All #i6.18 #i7.19.
      (LtkRev( A.4 ) @ #i6.18) & (EphkRev( s.3 ) @ #i7.19)
     ==>
      F) &
    (All #i6.20 #i7.21.
      (LtkRev( B.5 ) @ #i6.20) & (EphkRev( ss.9 ) @ #i7.21)
     ==>
      F) &
    (All #i6.22 #i7.23.
      (LtkRev( A.4 ) @ #i6.22) & (LtkRev( B.5 ) @ #i7.23)
     ==>
      F) &
    (All #i6.24 #i7.25.
      (EphkRev( s.3 ) @ #i6.24) & (EphkRev( ss.9 ) @ #i7.25)
     ==>
      F)) &
  ((Ex ss.26 #i4.27 #i5.28 C.29 D.30 ms.31.
     (Sid( ss.26, C.29, D.30, ms.31 ) @ #i4.27) &
     (Match( s.3, ms.31 ) @ #i5.28)
    &
     T) |
   ((All #i6.32. (EphkRev( s.3 ) @ #i6.32) ==> F) &
    (All #i6.33.
      (LtkRev( B.5 ) @ #i6.33)
     ==>
      All . (#i6.33 < #i3.2) ==> F)))"
*/
simplify
solve( Disj(Ex ss.4 #i4.5 #i5.6 C.7 D.8 ms.9.
             (Sid( ss.4, C.7, D.8, ms.9 ) @ #i4.5) & (Match( s.3, ms.9 ) @ #i5.6)
            &
             T) |
           ((All #i6.6. (EphkRev( s.3 ) @ #i6.6) ==> F) &
            (All #i6.7. (LtkRev( B.5 ) @ #i6.7) ==> All . (#i6.7 < #i3.2) ==> F)) )
  case case_1
  solve( Sid( s.3, A.4, B.5, minfo.6 ) @ #i1 )
    case Init_1
    solve( (#i1, 1)[!Ltk( $I.16, ~lkI.18 )] )
      case Register_pk
      solve( (#i1, 2)[!Pk( $R.17, pkR.20 )] )
        case Register_pk
        solve( Accept( ~m1.19, k.7 ) @ #i3.2 )
          case Init_2
          solve( (#i3.2, 0)[Init_1( ~m1.19, $I.41, $R.42, ~lkI.43, ~m1.19, c1.45
                            )] )
            case Init_1
            solve( Sid( ss.9, C.12, D.13, ms.14 ) @ #i4.10 )
              case Init_1
              solve( (#i4.10, 1)[!Ltk( $I.77, ~lkI.79 )] )
                case Register_pk
                solve( (#i4.10, 2)[!Pk( $R.78, pkR.81 )] )
                  case Register_pk
                  by solve( Match( ~m1.19,
                                   <$I.77, $R.78, 'Init', aenc(~m1.80, pk(~ltkA.99))>
                            ) @ #i5.11 )
                qed
              qed
            next
              case Init_2
              solve( (#i4.10, 0)[Init_1( ~m1.80, $I.77, $R.78, ~lkI.79, ~m1.80, c1.81
                                 )] )
                case Init_1
                by solve( Match( ~m1.19,
                                 <$I.77, $R.78, 'Init', aenc(~m1.80, pk(~ltkA.110)), c2.82>
                          ) @ #i5.11 )
              qed
            next
              case Resp_1
              solve( (#i4.10, 2)[!Ltk( $R.78, ~lkR.79 )] )
                case Register_pk
                solve( (#i4.10, 3)[!Pk( $I.77, pkI.82 )] )
                  case Register_pk
                  solve( Match( ~m1.19,
                                <$R.78, $I.77, 'Resp', aenc(~m2.80, pk(~ltkA.103)), c1.81>
                         ) @ #i5.11 )
                    case Init_2
                    solve( (#i5.11, 0)[Init_1( ~m1.19, $I.77, $R.78, ~lkI.108, ~m1.19, c1.81
                                       )] )
                      case Init_1
                      solve( splitEqs(1) )
                        case split_case_1
                        solve( splitEqs(1) )
                          case split_case_1
                          solve( (#i2.1, 0)[!KU( f_.8,
                                                 KDF(<~m1.143, ~z.142, $I.16, $R.17, 
                                                      aenc(~m1.143, pk(~ltkA.144)), aenc(~z.142, pk(~lkI.141))
                                                     >)
                                            )] /* may loop */ )
                            case Sessk_reveal_case_1
                            by contradiction // from formulas
                          next
                            case Sessk_reveal_case_2
                            by contradiction // from formulas
                          next
                            case cKDF
                            solve( KU((#vr.148, 0), ~z.142) )
                              case Ephk_reveal
                              solve( KU((#vr.148, 0), ~m1.143) )
                                case Ephk_reveal
                                by contradiction // from formulas
                              next
                                case Init_1
                                solve( (#vr.211, 1)[!KU( f_.216, ~ltkA.144 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            next
                              case Resp_1
                              solve( KU((#vr.148, 0), ~m1.143) )
                                case Ephk_reveal
                                solve( (#vr.187, 1)[!KU( f_.192, ~lkI.141 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              next
                                case Init_1
                                solve( (#vr.187, 1)[!KU( f_.192, ~lkI.141 )] /* may loop */ )
                                  case Ltk_reveal
                                  solve( (#vr.226, 1)[!KU( f_.231, ~ltkA.144 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case split_case_2
                          solve( (#i2.1, 0)[!KU( f_.8,
                                                 KDF(<~m1.143, ~z.142, $I.16, $R.17, 
                                                      aenc(~m1.143, pk(~ltkA.144)), aenc(~z.142, pk(~lkI.141))
                                                     >)
                                            )] /* may loop */ )
                            case Sessk_reveal
                            by contradiction // from formulas
                          next
                            case cKDF
                            solve( KU((#vr.149, 0), ~z.142) )
                              case Ephk_reveal
                              solve( KU((#vr.149, 0), ~m1.143) )
                                case Ephk_reveal
                                by contradiction // from formulas
                              next
                                case Init_1
                                solve( (#vr.212, 1)[!KU( f_.217, ~ltkA.144 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            next
                              case Resp_1
                              solve( KU((#vr.149, 0), ~m1.143) )
                                case Ephk_reveal
                                solve( (#vr.188, 1)[!KU( f_.193, ~lkI.141 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              next
                                case Init_1
                                solve( (#vr.188, 1)[!KU( f_.193, ~lkI.141 )] /* may loop */ )
                                  case Ltk_reveal
                                  solve( (#vr.227, 1)[!KU( f_.232, ~ltkA.144 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case split_case_2
                        solve( splitEqs(1) )
                          case split_case_1
                          solve( (#i2.1, 0)[!KU( f_.8,
                                                 KDF(<~m1.144, adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                      $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                      aenc(~m2.142, pk(~ltkA.143))>)
                                            )] /* may loop */ )
                            case Sessk_reveal
                            by contradiction // from formulas
                          next
                            case cKDF
                            solve( KU((#vr.149, 0), ~m1.144) )
                              case Ephk_reveal
                              solve( KU((#vf.48, 0), MAC(KDF(<~m1.144, 
                                                              adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                              $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                              aenc(~m2.142, pk(~ltkA.143))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.142, pk(~ltkA.143)), 
                                                          aenc(~m1.144, pk(~ltkA.145))>)) )
                                case cMAC
                                solve( KU((#vr.149, 0), adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141)) )
                                  case cadec
                                  solve( (#vr.195, 1)[!KU( f_.199, ~lkI.141 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            next
                              case Init_1
                              solve( (#vr.178, 1)[!KU( f_.183, ~ltkA.145 )] /* may loop */ )
                                case Ltk_reveal
                                solve( KU((#vf.48, 0), MAC(KDF(<~m1.144, 
                                                                adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                                $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                                aenc(~m2.142, pk(~ltkA.143))>),
                                                           <'Resp', $R.17, $I.16, 
                                                            aenc(~m2.142, pk(~ltkA.143)), 
                                                            aenc(~m1.144, pk(~ltkA.145))>)) )
                                  case cMAC
                                  solve( KU((#vr.149, 0), adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141)) )
                                    case cadec
                                    solve( (#vr.231, 1)[!KU( f_.235, ~lkI.141 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case split_case_2
                          solve( (#i2.1, 0)[!KU( f_.8,
                                                 KDF(<~m1.144, adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                      $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                      aenc(~m2.142, pk(~ltkA.143))>)
                                            )] /* may loop */ )
                            case Sessk_reveal
                            by contradiction // from formulas
                          next
                            case cKDF
                            solve( KU((#vr.150, 0), ~m1.144) )
                              case Ephk_reveal
                              solve( KU((#vf.48, 0), MAC(KDF(<~m1.144, 
                                                              adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                              $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                              aenc(~m2.142, pk(~ltkA.143))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.142, pk(~ltkA.143)), 
                                                          aenc(~m1.144, pk(~ltkA.145))>)) )
                                case cMAC
                                solve( KU((#vr.150, 0), adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141)) )
                                  case cadec
                                  solve( (#vr.196, 1)[!KU( f_.200, ~lkI.141 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            next
                              case Init_1
                              solve( (#vr.179, 1)[!KU( f_.184, ~ltkA.145 )] /* may loop */ )
                                case Ltk_reveal
                                solve( KU((#vf.48, 0), MAC(KDF(<~m1.144, 
                                                                adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141), 
                                                                $I.16, $R.17, aenc(~m1.144, pk(~ltkA.145)), 
                                                                aenc(~m2.142, pk(~ltkA.143))>),
                                                           <'Resp', $R.17, $I.16, 
                                                            aenc(~m2.142, pk(~ltkA.143)), 
                                                            aenc(~m1.144, pk(~ltkA.145))>)) )
                                  case cMAC
                                  solve( KU((#vr.150, 0), adec(aenc(~m2.142, pk(~ltkA.143)), ~lkI.141)) )
                                    case cadec
                                    solve( (#vr.232, 1)[!KU( f_.236, ~lkI.141 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Resp_2
          by solve( (#i3.2, 0)[Resp_1( ~m1.19, $I.41, $R.42, ~lkR.43, m1.47,
                                       ~m1.19, c1.45, c2.46
                               )] )
        qed
      qed
    qed
  next
    case Init_2
    solve( (#i1, 0)[Init_1( ~m1.19, $I.16, $R.17, ~lkI.18, ~m1.19, c1.20 )] )
      case Init_1
      solve( Accept( ~m1.19, k.7 ) @ #i3.2 )
        case Init_2
        solve( (#i3.2, 0)[Init_1( ~m1.19, $I.52, $R.53, ~lkI.54, ~m1.19, c1.56
                          )] )
          case Init_1
          solve( Sid( ss.9, C.12, D.13, ms.14 ) @ #i4.10 )
            case Init_1
            solve( (#i4.10, 1)[!Ltk( $I.88, ~lkI.90 )] )
              case Register_pk
              solve( (#i4.10, 2)[!Pk( $R.89, pkR.92 )] )
                case Register_pk
                by solve( Match( ~m1.19,
                                 <$I.88, $R.89, 'Init', aenc(~m1.91, pk(~ltkA.110))>
                          ) @ #i5.11 )
              qed
            qed
          next
            case Init_2
            solve( (#i4.10, 0)[Init_1( ~m1.91, $I.88, $R.89, ~lkI.90, ~m1.91, c1.92
                               )] )
              case Init_1
              by solve( Match( ~m1.19,
                               <$I.88, $R.89, 'Init', aenc(~m1.91, pk(~ltkA.121)), c2.93>
                        ) @ #i5.11 )
            qed
          next
            case Resp_1
            solve( (#i4.10, 2)[!Ltk( $R.89, ~lkR.90 )] )
              case Register_pk
              solve( (#i4.10, 3)[!Pk( $I.88, pkI.93 )] )
                case Register_pk
                solve( Match( ~m1.19,
                              <$R.89, $I.88, 'Resp', aenc(~m2.91, pk(~ltkA.114)), c1.92>
                       ) @ #i5.11 )
                  case Init_2
                  solve( (#i5.11, 0)[Init_1( ~m1.19, $I.88, $R.89, ~lkI.119, ~m1.19, c1.92
                                     )] )
                    case Init_1
                    solve( splitEqs(1) )
                      case split_case_1
                      solve( splitEqs(1) )
                        case split_case_1
                        solve( (#i2.1, 0)[!KU( f_.8,
                                               KDF(<~m1.154, ~z.153, $I.16, $R.17, 
                                                    aenc(~m1.154, pk(~ltkA.155)), aenc(~z.153, pk(~lkI.152))>)
                                          )] /* may loop */ )
                          case Sessk_reveal_case_1
                          by contradiction // from formulas
                        next
                          case Sessk_reveal_case_2
                          by contradiction // from formulas
                        next
                          case cKDF
                          solve( KU((#vr.159, 0), ~z.153) )
                            case Ephk_reveal
                            solve( KU((#vr.159, 0), ~m1.154) )
                              case Ephk_reveal
                              by contradiction // from formulas
                            next
                              case Init_1
                              solve( (#vr.222, 1)[!KU( f_.227, ~ltkA.155 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          next
                            case Resp_1
                            solve( KU((#vr.159, 0), ~m1.154) )
                              case Ephk_reveal
                              solve( (#vr.198, 1)[!KU( f_.203, ~lkI.152 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            next
                              case Init_1
                              solve( (#vr.198, 1)[!KU( f_.203, ~lkI.152 )] /* may loop */ )
                                case Ltk_reveal
                                solve( (#vr.237, 1)[!KU( f_.242, ~ltkA.155 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case split_case_2
                        solve( (#i2.1, 0)[!KU( f_.8,
                                               KDF(<~m1.154, ~z.153, $I.16, $R.17, 
                                                    aenc(~m1.154, pk(~ltkA.155)), aenc(~z.153, pk(~lkI.152))>)
                                          )] /* may loop */ )
                          case Sessk_reveal
                          by contradiction // from formulas
                        next
                          case cKDF
                          solve( KU((#vr.160, 0), ~z.153) )
                            case Ephk_reveal
                            solve( KU((#vr.160, 0), ~m1.154) )
                              case Ephk_reveal
                              by contradiction // from formulas
                            next
                              case Init_1
                              solve( (#vr.223, 1)[!KU( f_.228, ~ltkA.155 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          next
                            case Resp_1
                            solve( KU((#vr.160, 0), ~m1.154) )
                              case Ephk_reveal
                              solve( (#vr.199, 1)[!KU( f_.204, ~lkI.152 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            next
                              case Init_1
                              solve( (#vr.199, 1)[!KU( f_.204, ~lkI.152 )] /* may loop */ )
                                case Ltk_reveal
                                solve( (#vr.238, 1)[!KU( f_.243, ~ltkA.155 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case split_case_2
                      solve( splitEqs(1) )
                        case split_case_1
                        solve( (#i2.1, 0)[!KU( f_.8,
                                               KDF(<~m1.155, adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                    $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                    aenc(~m2.153, pk(~ltkA.154))>)
                                          )] /* may loop */ )
                          case Sessk_reveal
                          by contradiction // from formulas
                        next
                          case cKDF
                          solve( KU((#vr.160, 0), ~m1.155) )
                            case Ephk_reveal
                            solve( KU((#vf.23, 0), MAC(KDF(<~m1.155, 
                                                            adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                            $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                            aenc(~m2.153, pk(~ltkA.154))>),
                                                       <'Resp', $R.17, $I.16, aenc(~m2.153, pk(~ltkA.154)), 
                                                        aenc(~m1.155, pk(~ltkA.156))>)) )
                              case cMAC
                              solve( KU((#vr.160, 0), adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152)) )
                                case cadec
                                solve( (#vr.206, 1)[!KU( f_.210, ~lkI.152 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          next
                            case Init_1
                            solve( (#vr.189, 1)[!KU( f_.194, ~ltkA.156 )] /* may loop */ )
                              case Ltk_reveal
                              solve( KU((#vf.23, 0), MAC(KDF(<~m1.155, 
                                                              adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                              $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                              aenc(~m2.153, pk(~ltkA.154))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.153, pk(~ltkA.154)), 
                                                          aenc(~m1.155, pk(~ltkA.156))>)) )
                                case cMAC
                                solve( KU((#vr.160, 0), adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152)) )
                                  case cadec
                                  solve( (#vr.242, 1)[!KU( f_.246, ~lkI.152 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case split_case_2
                        solve( (#i2.1, 0)[!KU( f_.8,
                                               KDF(<~m1.155, adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                    $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                    aenc(~m2.153, pk(~ltkA.154))>)
                                          )] /* may loop */ )
                          case Sessk_reveal
                          by contradiction // from formulas
                        next
                          case cKDF
                          solve( KU((#vr.161, 0), ~m1.155) )
                            case Ephk_reveal
                            solve( KU((#vf.23, 0), MAC(KDF(<~m1.155, 
                                                            adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                            $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                            aenc(~m2.153, pk(~ltkA.154))>),
                                                       <'Resp', $R.17, $I.16, aenc(~m2.153, pk(~ltkA.154)), 
                                                        aenc(~m1.155, pk(~ltkA.156))>)) )
                              case cMAC
                              solve( KU((#vr.161, 0), adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152)) )
                                case cadec
                                solve( (#vr.207, 1)[!KU( f_.211, ~lkI.152 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          next
                            case Init_1
                            solve( (#vr.190, 1)[!KU( f_.195, ~ltkA.156 )] /* may loop */ )
                              case Ltk_reveal
                              solve( KU((#vf.23, 0), MAC(KDF(<~m1.155, 
                                                              adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152), 
                                                              $I.16, $R.17, aenc(~m1.155, pk(~ltkA.156)), 
                                                              aenc(~m2.153, pk(~ltkA.154))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.153, pk(~ltkA.154)), 
                                                          aenc(~m1.155, pk(~ltkA.156))>)) )
                                case cMAC
                                solve( KU((#vr.161, 0), adec(aenc(~m2.153, pk(~ltkA.154)), ~lkI.152)) )
                                  case cadec
                                  solve( (#vr.243, 1)[!KU( f_.247, ~lkI.152 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case Resp_2
        by solve( (#i3.2, 0)[Resp_1( ~m1.19, $I.52, $R.53, ~lkR.54, m1.58,
                                     ~m1.19, c1.56, c2.57
                             )] )
      qed
    qed
  next
    case Resp_1
    solve( (#i1, 2)[!Ltk( $R.17, ~lkR.18 )] )
      case Register_pk
      solve( (#i1, 3)[!Pk( $I.16, pkI.21 )] )
        case Register_pk
        solve( Accept( ~m2.19, k.7 ) @ #i3.2 )
          case Init_2
          by solve( (#i3.2, 0)[Init_1( ~m2.19, $I.45, $R.46, ~lkI.47, ~m2.19, c1.49
                               )] )
        next
          case Resp_2
          solve( (#i3.2, 0)[Resp_1( ~m2.19, $I.45, $R.46, ~lkR.47, m1.51, ~m2.19,
                                    c1.49, c2.50
                            )] )
            case Resp_1
            solve( Sid( ss.9, C.12, D.13, ms.14 ) @ #i4.10 )
              case Init_1
              solve( (#i4.10, 1)[!Ltk( $I.87, ~lkI.89 )] )
                case Register_pk
                solve( (#i4.10, 2)[!Pk( $R.88, pkR.91 )] )
                  case Register_pk
                  solve( Match( ~m2.19, <$I.87, $R.88, 'Init', aenc(~m1.90, pk(~ltkA.109))>
                         ) @ #i5.11 )
                    case Resp_1
                    solve( splitEqs(1) )
                      case split_case_1
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<~z.123, ~m2.19, $I.16, $R.17, aenc(~z.123, pk(~lkR.122)), 
                                                  aenc(~m2.19, pk(~ltkA.42))>)
                                        )] /* may loop */ )
                        case Sessk_reveal_case_1
                        by contradiction // from formulas
                      next
                        case Sessk_reveal_case_2
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.127, 0), ~m2.19) )
                          case Ephk_reveal
                          solve( KU((#vr.127, 0), ~z.123) )
                            case Ephk_reveal
                            by contradiction // from formulas
                          next
                            case Init_1
                            solve( (#vr.190, 1)[!KU( f_.195, ~lkR.122 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          qed
                        next
                          case Resp_1
                          solve( KU((#vr.127, 0), ~z.123) )
                            case Ephk_reveal
                            solve( (#vr.166, 1)[!KU( f_.171, ~ltkA.42 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          next
                            case Init_1
                            solve( (#vr.166, 1)[!KU( f_.171, ~ltkA.42 )] /* may loop */ )
                              case Ltk_reveal
                              solve( (#vr.202, 1)[!KU( f_.207, ~lkR.122 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case split_case_2
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<adec(aenc(~m1.123, pk(~ltkA.124)), ~lkR.122), ~m2.19, 
                                                  $I.16, $R.17, aenc(~m1.123, pk(~ltkA.124)), 
                                                  aenc(~m2.19, pk(~ltkA.42))>)
                                        )] /* may loop */ )
                        case Sessk_reveal
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.128, 0), ~m2.19) )
                          case Ephk_reveal
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<adec(aenc(~m1.123, pk(~ltkA.124)), ~lkR.122), 
                                                           ~m2.19, $I.16, $R.17, 
                                                           aenc(~m1.123, pk(~ltkA.124)), 
                                                           aenc(~m2.19, pk(~ltkA.42))>),
                                                      <'Init', $I.16, $R.17, aenc(~m1.123, pk(~ltkA.124)), 
                                                       aenc(~m2.19, pk(~ltkA.42))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vr.128, 0), adec(aenc(~m1.123, pk(~ltkA.124)), ~lkR.122)) )
                              case cadec
                              solve( (#vr.178, 1)[!KU( f_.182, ~lkR.122 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          qed
                        next
                          case Resp_1
                          solve( (#vr.167, 1)[!KU( f_.172, ~ltkA.42 )] /* may loop */ )
                            case Ltk_reveal
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<adec(aenc(~m1.123, pk(~ltkA.124)), ~lkR.122), 
                                                             ~m2.19, $I.16, $R.17, 
                                                             aenc(~m1.123, pk(~ltkA.124)), 
                                                             aenc(~m2.19, pk(~ltkA.42))>),
                                                        <'Init', $I.16, $R.17, aenc(~m1.123, pk(~ltkA.124)), 
                                                         aenc(~m2.19, pk(~ltkA.42))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vr.128, 0), adec(aenc(~m1.123, pk(~ltkA.124)), ~lkR.122)) )
                                case cadec
                                solve( (#vr.207, 1)[!KU( f_.211, ~lkR.122 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case Init_2
              solve( (#i4.10, 0)[Init_1( ~m1.90, $I.87, $R.88, ~lkI.89, ~m1.90, c1.91
                                 )] )
                case Init_1
                solve( Match( ~m2.19,
                              <$I.87, $R.88, 'Init', aenc(~m1.90, pk(~ltkA.120)), c2.92>
                       ) @ #i5.11 )
                  case Resp_1_case_1
                  solve( splitEqs(1) )
                    case split_case_1
                    solve( (#i2.1, 0)[!KU( f_.8,
                                           KDF(<
                                                adec(<aenc(~m1.133, pk(~ltkA.135)), aenc(z.138, pk(~lkI.137))
                                                     >,
                                                     ~lkR.18), 
                                                ~m2.19, $I.16, $R.17, 
                                                <aenc(~m1.133, pk(~ltkA.135)), aenc(z.138, pk(~lkI.137))>, 
                                                aenc(~m2.19, pk(~ltkA.42))>)
                                      )] /* may loop */ )
                      case Sessk_reveal
                      by contradiction // from formulas
                    next
                      case cKDF
                      solve( KU((#vr.142, 0), ~m2.19) )
                        case Ephk_reveal
                        solve( KU((#vf.23, 0), aenc(z.138, pk(~lkI.137))) )
                          case Init_1
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<
                                                           adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                 aenc(~m1.195, pk(~lkI.137))>,
                                                                ~lkR.18), 
                                                           ~m2.19, $I.16, $R.17, 
                                                           <aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(~m1.195, pk(~lkI.137))>, 
                                                           aenc(~m2.19, pk(~ltkA.42))>),
                                                      <'Init', $I.16, $R.17, 
                                                       <aenc(~m1.133, pk(~ltkA.135)), 
                                                        aenc(~m1.195, pk(~lkI.137))>, 
                                                       aenc(~m2.19, pk(~ltkA.42))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m1.195, $I.16, $R.17, 
                                                            aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(~m1.195, pk(~lkI.137))>),
                                                       <'Resp', $R.17, $I.16, aenc(~m1.195, pk(~lkI.137)), 
                                                        aenc(~m1.133, pk(~ltkA.135))>)) )
                              case cMAC
                              solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(~m1.195, pk(~lkI.137))>,
                                                           ~lkR.18)) )
                                case cadec
                                solve( (#vr.230, 1)[!KU( f_.234, ~lkR.18 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        next
                          case Resp_1
                          solve( splitEqs(1) )
                            case split_case_1
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<
                                                             adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                   aenc(~m2.195, pk(~lkI.137))>,
                                                                  ~lkR.18), 
                                                             ~m2.19, $I.16, $R.17, 
                                                             <aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>, 
                                                             aenc(~m2.19, pk(~ltkA.42))>),
                                                        <'Init', $I.16, $R.17, 
                                                         <aenc(~m1.133, pk(~ltkA.135)), 
                                                          aenc(~m2.195, pk(~lkI.137))>, 
                                                         aenc(~m2.19, pk(~ltkA.42))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m2.195, $I.16, $R.17, 
                                                              aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.195, pk(~lkI.137)), 
                                                          aenc(~m1.133, pk(~ltkA.135))>)) )
                                case cMAC
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.242, 1)[!KU( f_.246, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          next
                            case split_case_2
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<
                                                             adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                   aenc(~m2.195, pk(~lkI.137))>,
                                                                  ~lkR.18), 
                                                             ~m2.19, $I.16, $R.17, 
                                                             <aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>, 
                                                             aenc(~m2.19, pk(~ltkA.42))>),
                                                        <'Init', $I.16, $R.17, 
                                                         <aenc(~m1.133, pk(~ltkA.135)), 
                                                          aenc(~m2.195, pk(~lkI.137))>, 
                                                         aenc(~m2.19, pk(~ltkA.42))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m2.195, $I.16, $R.17, 
                                                              aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.195, pk(~lkI.137)), 
                                                          aenc(~m1.133, pk(~ltkA.135))>)) )
                                case Resp_1
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~lkR.218)), 
                                                              aenc(~m2.195, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.274, 1)[!KU( f_.278, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              next
                                case cMAC
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m2.195, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.242, 1)[!KU( f_.246, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        next
                          case caenc
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<
                                                           adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                 aenc(z.138, pk(~lkI.137))>,
                                                                ~lkR.18), 
                                                           ~m2.19, $I.16, $R.17, 
                                                           <aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(z.138, pk(~lkI.137))>, 
                                                           aenc(~m2.19, pk(~ltkA.42))>),
                                                      <'Init', $I.16, $R.17, 
                                                       <aenc(~m1.133, pk(~ltkA.135)), 
                                                        aenc(z.138, pk(~lkI.137))>, 
                                                       aenc(~m2.19, pk(~ltkA.42))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, z.138, $I.16, $R.17, 
                                                            aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(z.138, pk(~lkI.137))>),
                                                       <'Resp', $R.17, $I.16, aenc(z.138, pk(~lkI.137)), 
                                                        aenc(~m1.133, pk(~ltkA.135))>)) )
                              case Resp_1
                              solve( (#vr.183, 0)[!KU( f_.186, ~m2.213 )] /* may loop */ )
                                case Ephk_reveal
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.237)), 
                                                              aenc(~m2.213, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.276, 1)[!KU( f_.280, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            next
                              case cMAC
                              solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(z.138, pk(~lkI.137))>,
                                                           ~lkR.18)) )
                                case cadec
                                solve( (#vr.210, 1)[!KU( f_.214, ~lkR.18 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        qed
                      next
                        case Resp_1
                        solve( (#vr.181, 1)[!KU( f_.186, ~ltkA.42 )] /* may loop */ )
                          case Ltk_reveal
                          solve( KU((#vf.23, 0), aenc(z.138, pk(~lkI.137))) )
                            case Init_1
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<
                                                             adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                   aenc(~m1.224, pk(~lkI.137))>,
                                                                  ~lkR.18), 
                                                             ~m2.19, $I.16, $R.17, 
                                                             <aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m1.224, pk(~lkI.137))>, 
                                                             aenc(~m2.19, pk(~ltkA.42))>),
                                                        <'Init', $I.16, $R.17, 
                                                         <aenc(~m1.133, pk(~ltkA.135)), 
                                                          aenc(~m1.224, pk(~lkI.137))>, 
                                                         aenc(~m2.19, pk(~ltkA.42))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m1.224, $I.16, $R.17, 
                                                              aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m1.224, pk(~lkI.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m1.224, pk(~lkI.137)), 
                                                          aenc(~m1.133, pk(~ltkA.135))>)) )
                                case cMAC
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(~m1.224, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.259, 1)[!KU( f_.263, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          next
                            case Resp_1
                            solve( splitEqs(1) )
                              case split_case_1
                              solve( (#vf.52, 0)[!KU( f_.53,
                                                      MAC(KDF(<
                                                               adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                     aenc(~m2.224, pk(~lkI.137))>,
                                                                    ~lkR.18), 
                                                               ~m2.19, $I.16, $R.17, 
                                                               <aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>, 
                                                               aenc(~m2.19, pk(~ltkA.42))>),
                                                          <'Init', $I.16, $R.17, 
                                                           <aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(~m2.224, pk(~lkI.137))>, 
                                                           aenc(~m2.19, pk(~ltkA.42))>)
                                                 )] /* may loop */ )
                                case cMAC
                                solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m2.224, $I.16, $R.17, 
                                                                aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>),
                                                           <'Resp', $R.17, $I.16, 
                                                            aenc(~m2.224, pk(~lkI.137)), 
                                                            aenc(~m1.133, pk(~ltkA.135))>)) )
                                  case cMAC
                                  solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>,
                                                               ~lkR.18)) )
                                    case cadec
                                    solve( (#vr.271, 1)[!KU( f_.275, ~lkR.18 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                qed
                              qed
                            next
                              case split_case_2
                              solve( (#vf.52, 0)[!KU( f_.53,
                                                      MAC(KDF(<
                                                               adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                     aenc(~m2.224, pk(~lkI.137))>,
                                                                    ~lkR.18), 
                                                               ~m2.19, $I.16, $R.17, 
                                                               <aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>, 
                                                               aenc(~m2.19, pk(~ltkA.42))>),
                                                          <'Init', $I.16, $R.17, 
                                                           <aenc(~m1.133, pk(~ltkA.135)), 
                                                            aenc(~m2.224, pk(~lkI.137))>, 
                                                           aenc(~m2.19, pk(~ltkA.42))>)
                                                 )] /* may loop */ )
                                case cMAC
                                solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, ~m2.224, $I.16, $R.17, 
                                                                aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>),
                                                           <'Resp', $R.17, $I.16, 
                                                            aenc(~m2.224, pk(~lkI.137)), 
                                                            aenc(~m1.133, pk(~ltkA.135))>)) )
                                  case Resp_1
                                  solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~lkR.247)), 
                                                                aenc(~m2.224, pk(~lkI.137))>,
                                                               ~lkR.18)) )
                                    case cadec
                                    solve( (#vr.303, 1)[!KU( f_.307, ~lkR.18 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                next
                                  case cMAC
                                  solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                aenc(~m2.224, pk(~lkI.137))>,
                                                               ~lkR.18)) )
                                    case cadec
                                    solve( (#vr.271, 1)[!KU( f_.275, ~lkR.18 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                qed
                              qed
                            qed
                          next
                            case caenc
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<
                                                             adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                                   aenc(z.138, pk(~lkI.137))>,
                                                                  ~lkR.18), 
                                                             ~m2.19, $I.16, $R.17, 
                                                             <aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(z.138, pk(~lkI.137))>, 
                                                             aenc(~m2.19, pk(~ltkA.42))>),
                                                        <'Init', $I.16, $R.17, 
                                                         <aenc(~m1.133, pk(~ltkA.135)), 
                                                          aenc(z.138, pk(~lkI.137))>, 
                                                         aenc(~m2.19, pk(~ltkA.42))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, z.138, $I.16, $R.17, 
                                                              aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(z.138, pk(~lkI.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(z.138, pk(~lkI.137)), 
                                                          aenc(~m1.133, pk(~ltkA.135))>)) )
                                case Resp_1
                                solve( (#vr.212, 0)[!KU( f_.215, ~m2.242 )] /* may loop */ )
                                  case Ephk_reveal
                                  solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.266)), 
                                                                aenc(~m2.242, pk(~lkI.137))>,
                                                               ~lkR.18)) )
                                    case cadec
                                    solve( (#vr.305, 1)[!KU( f_.309, ~lkR.18 )] /* may loop */ )
                                      case Ltk_reveal
                                      by contradiction // from formulas
                                    qed
                                  qed
                                qed
                              next
                                case cMAC
                                solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), 
                                                              aenc(z.138, pk(~lkI.137))>,
                                                             ~lkR.18)) )
                                  case cadec
                                  solve( (#vr.239, 1)[!KU( f_.243, ~lkR.18 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case split_case_2
                    solve( (#i2.1, 0)[!KU( f_.8,
                                           KDF(<adec(<aenc(~m1.133, pk(~ltkA.135)), c2.138>, ~lkR.18), 
                                                ~m2.19, $I.16, $R.17, <aenc(~m1.133, pk(~ltkA.135)), c2.138>, 
                                                aenc(~m2.19, pk(~ltkA.42))>)
                                      )] /* may loop */ )
                      case Sessk_reveal
                      by contradiction // from formulas
                    next
                      case cKDF
                      solve( KU((#vr.142, 0), ~m2.19) )
                        case Ephk_reveal
                        solve( (#vf.52, 0)[!KU( f_.53,
                                                MAC(KDF(<
                                                         adec(<aenc(~m1.133, pk(~ltkA.135)), c2.138>,
                                                              ~lkR.18), 
                                                         ~m2.19, $I.16, $R.17, 
                                                         <aenc(~m1.133, pk(~ltkA.135)), c2.138>, 
                                                         aenc(~m2.19, pk(~ltkA.42))>),
                                                    <'Init', $I.16, $R.17, 
                                                     <aenc(~m1.133, pk(~ltkA.135)), c2.138>, 
                                                     aenc(~m2.19, pk(~ltkA.42))>)
                                           )] /* may loop */ )
                          case cMAC
                          solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, adec(c2.138, ~lkI.137), $I.16, 
                                                          $R.17, aenc(~m1.133, pk(~ltkA.135)), c2.138>),
                                                     <'Resp', $R.17, $I.16, c2.138, 
                                                      aenc(~m1.133, pk(~ltkA.135))>)) )
                            case cMAC
                            solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), c2.138>,
                                                         ~lkR.18)) )
                              case cadec
                              solve( (#vr.201, 1)[!KU( f_.205, ~lkR.18 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          qed
                        qed
                      next
                        case Resp_1
                        solve( (#vr.181, 1)[!KU( f_.186, ~ltkA.42 )] /* may loop */ )
                          case Ltk_reveal
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<
                                                           adec(<aenc(~m1.133, pk(~ltkA.135)), c2.138>,
                                                                ~lkR.18), 
                                                           ~m2.19, $I.16, $R.17, 
                                                           <aenc(~m1.133, pk(~ltkA.135)), c2.138>, 
                                                           aenc(~m2.19, pk(~ltkA.42))>),
                                                      <'Init', $I.16, $R.17, 
                                                       <aenc(~m1.133, pk(~ltkA.135)), c2.138>, 
                                                       aenc(~m2.19, pk(~ltkA.42))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vf.94, 0), MAC(KDF(<~m1.133, adec(c2.138, ~lkI.137), $I.16, 
                                                            $R.17, aenc(~m1.133, pk(~ltkA.135)), c2.138>),
                                                       <'Resp', $R.17, $I.16, c2.138, 
                                                        aenc(~m1.133, pk(~ltkA.135))>)) )
                              case cMAC
                              solve( KU((#vr.142, 0), adec(<aenc(~m1.133, pk(~ltkA.135)), c2.138>,
                                                           ~lkR.18)) )
                                case cadec
                                solve( (#vr.230, 1)[!KU( f_.234, ~lkR.18 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                next
                  case Resp_1_case_2
                  solve( splitEqs(1) )
                    case split_case_1
                    solve( splitEqs(1) )
                      case split_case_1
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<~z.134, ~m2.135, $I.16, $R.17, aenc(~z.134, pk(~lkR.133)), 
                                                  aenc(~m2.135, pk(~ltkA.136))>)
                                        )] /* may loop */ )
                        case Sessk_reveal_case_1
                        by contradiction // from formulas
                      next
                        case Sessk_reveal_case_2
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.140, 0), ~z.134) )
                          case Ephk_reveal
                          solve( KU((#vr.140, 0), ~m2.135) )
                            case Ephk_reveal
                            by contradiction // from formulas
                          next
                            case Resp_1
                            solve( (#vr.209, 1)[!KU( f_.214, ~ltkA.136 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          qed
                        next
                          case Init_1
                          solve( KU((#vr.140, 0), ~m2.135) )
                            case Ephk_reveal
                            solve( (#vr.169, 1)[!KU( f_.174, ~lkR.133 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          next
                            case Resp_1
                            solve( (#vr.169, 1)[!KU( f_.174, ~lkR.133 )] /* may loop */ )
                              case Ltk_reveal
                              solve( (#vr.228, 1)[!KU( f_.233, ~ltkA.136 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case split_case_2
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<~z.134, ~m2.135, $I.16, $R.17, aenc(~z.134, pk(~lkR.133)), 
                                                  aenc(~m2.135, pk(~ltkA.136))>)
                                        )] /* may loop */ )
                        case Sessk_reveal
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.141, 0), ~z.134) )
                          case Ephk_reveal
                          solve( KU((#vr.141, 0), ~m2.135) )
                            case Ephk_reveal
                            by contradiction // from formulas
                          next
                            case Resp_1
                            solve( (#vr.210, 1)[!KU( f_.215, ~ltkA.136 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          qed
                        next
                          case Init_1
                          solve( KU((#vr.141, 0), ~m2.135) )
                            case Ephk_reveal
                            solve( (#vr.170, 1)[!KU( f_.175, ~lkR.133 )] /* may loop */ )
                              case Ltk_reveal
                              by contradiction // from formulas
                            qed
                          next
                            case Resp_1
                            solve( (#vr.170, 1)[!KU( f_.175, ~lkR.133 )] /* may loop */ )
                              case Ltk_reveal
                              solve( (#vr.229, 1)[!KU( f_.234, ~ltkA.136 )] /* may loop */ )
                                case Ltk_reveal
                                by contradiction // from formulas
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  next
                    case split_case_2
                    solve( splitEqs(1) )
                      case split_case_1
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), ~m2.136, 
                                                  $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                  aenc(~m2.136, pk(~ltkA.137))>)
                                        )] /* may loop */ )
                        case Sessk_reveal
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.141, 0), ~m2.136) )
                          case Ephk_reveal
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), 
                                                           ~m2.136, $I.16, $R.17, 
                                                           aenc(~m1.134, pk(~ltkA.135)), 
                                                           aenc(~m2.136, pk(~ltkA.137))>),
                                                      <'Init', $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                       aenc(~m2.136, pk(~ltkA.137))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vf.94, 0), MAC(KDF(<~m1.134, ~m2.136, $I.16, $R.17, 
                                                            aenc(~m1.134, pk(~ltkA.135)), 
                                                            aenc(~m2.136, pk(~ltkA.137))>),
                                                       <'Resp', $R.17, $I.16, aenc(~m2.136, pk(~ltkA.137)), 
                                                        aenc(~m1.134, pk(~ltkA.135))>)) )
                              case cMAC
                              solve( KU((#vr.141, 0), adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133)) )
                                case cadec
                                solve( (#vr.200, 1)[!KU( f_.204, ~lkR.133 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        next
                          case Resp_1
                          solve( (#vr.180, 1)[!KU( f_.185, ~ltkA.137 )] /* may loop */ )
                            case Ltk_reveal
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), 
                                                             ~m2.136, $I.16, $R.17, 
                                                             aenc(~m1.134, pk(~ltkA.135)), 
                                                             aenc(~m2.136, pk(~ltkA.137))>),
                                                        <'Init', $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                         aenc(~m2.136, pk(~ltkA.137))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.134, ~m2.136, $I.16, $R.17, 
                                                              aenc(~m1.134, pk(~ltkA.135)), 
                                                              aenc(~m2.136, pk(~ltkA.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.136, pk(~ltkA.137)), 
                                                          aenc(~m1.134, pk(~ltkA.135))>)) )
                                case cMAC
                                solve( KU((#vr.141, 0), adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133)) )
                                  case cadec
                                  solve( (#vr.232, 1)[!KU( f_.236, ~lkR.133 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    next
                      case split_case_2
                      solve( (#i2.1, 0)[!KU( f_.8,
                                             KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), ~m2.136, 
                                                  $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                  aenc(~m2.136, pk(~ltkA.137))>)
                                        )] /* may loop */ )
                        case Sessk_reveal
                        by contradiction // from formulas
                      next
                        case cKDF
                        solve( KU((#vr.142, 0), ~m2.136) )
                          case Ephk_reveal
                          solve( (#vf.52, 0)[!KU( f_.53,
                                                  MAC(KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), 
                                                           ~m2.136, $I.16, $R.17, 
                                                           aenc(~m1.134, pk(~ltkA.135)), 
                                                           aenc(~m2.136, pk(~ltkA.137))>),
                                                      <'Init', $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                       aenc(~m2.136, pk(~ltkA.137))>)
                                             )] /* may loop */ )
                            case cMAC
                            solve( KU((#vf.94, 0), MAC(KDF(<~m1.134, 
                                                            adec(aenc(~m2.136, pk(~ltkA.137)), ~lkI.138), 
                                                            $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                            aenc(~m2.136, pk(~ltkA.137))>),
                                                       <'Resp', $R.17, $I.16, aenc(~m2.136, pk(~ltkA.137)), 
                                                        aenc(~m1.134, pk(~ltkA.135))>)) )
                              case cMAC
                              solve( KU((#vr.142, 0), adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133)) )
                                case cadec
                                solve( (#vr.201, 1)[!KU( f_.205, ~lkR.133 )] /* may loop */ )
                                  case Ltk_reveal
                                  by contradiction // from formulas
                                qed
                              qed
                            qed
                          qed
                        next
                          case Resp_1
                          solve( (#vr.181, 1)[!KU( f_.186, ~ltkA.137 )] /* may loop */ )
                            case Ltk_reveal
                            solve( (#vf.52, 0)[!KU( f_.53,
                                                    MAC(KDF(<adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133), 
                                                             ~m2.136, $I.16, $R.17, 
                                                             aenc(~m1.134, pk(~ltkA.135)), 
                                                             aenc(~m2.136, pk(~ltkA.137))>),
                                                        <'Init', $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                         aenc(~m2.136, pk(~ltkA.137))>)
                                               )] /* may loop */ )
                              case cMAC
                              solve( KU((#vf.94, 0), MAC(KDF(<~m1.134, 
                                                              adec(aenc(~m2.136, pk(~ltkA.137)), ~lkI.138), 
                                                              $I.16, $R.17, aenc(~m1.134, pk(~ltkA.135)), 
                                                              aenc(~m2.136, pk(~ltkA.137))>),
                                                         <'Resp', $R.17, $I.16, aenc(~m2.136, pk(~ltkA.137)), 
                                                          aenc(~m1.134, pk(~ltkA.135))>)) )
                                case cMAC
                                solve( KU((#vr.142, 0), adec(aenc(~m1.134, pk(~ltkA.135)), ~lkR.133)) )
                                  case cadec
                                  solve( (#vr.233, 1)[!KU( f_.237, ~lkR.133 )] /* may loop */ )
                                    case Ltk_reveal
                                    by contradiction // from formulas
                                  qed
                                qed
                              qed
                            qed
                          qed
                        qed
                      qed
                    qed
                  qed
                qed
              qed
            next
              case Resp_1
              solve( (#i4.10, 2)[!Ltk( $R.88, ~lkR.89 )] )
                case Register_pk
                solve( (#i4.10, 3)[!Pk( $I.87, pkI.92 )] )
                  case Register_pk
                  solve( Match( ~m2.19,
                                <$R.88, $I.87, 'Resp', aenc(~m2.90, pk(~ltkA.113)), c1.91>
                         ) @ #i5.11 )
                    case Init_2
                    by solve( (#i5.11, 0)[Init_1( ~m2.19, $I.87, $R.88, ~lkI.118, ~m2.19,
                                                  c1.91
                                          )] )
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
next
  case case_2
  solve( Sid( s.3, A.4, B.5, minfo.6 ) @ #i1 )
    case Init_1
    solve( (#i1, 1)[!Ltk( $I.10, ~lkI.12 )] )
      case Register_pk
      solve( (#i1, 2)[!Pk( $R.11, pkR.14 )] )
        case Register_pk
        solve( Accept( ~m1.13, k.7 ) @ #i3.2 )
          case Init_2
          solve( (#i3.2, 0)[Init_1( ~m1.13, $I.35, $R.36, ~lkI.37, ~m1.13, c1.39
                            )] )
            case Init_1
            solve( splitEqs(1) )
              case split_case_1
              solve( (#i2.1, 0)[!KU( f_.8,
                                     KDF(<~m1.13, adec(c2.71, ~lkI.70), $I.10, $R.11, 
                                          aenc(~m1.13, pk(~ltkA.32)), c2.71>)
                                )] /* may loop */ )
                case Sessk_reveal
                by contradiction // from formulas
              next
                case cKDF
                solve( KU((#vr.75, 0), ~m1.13) )
                  case Ephk_reveal
                  by contradiction // from formulas
                next
                  case Init_1
                  solve( (#vr.104, 1)[!KU( f_.109, ~ltkA.32 )] /* may loop */ )
                    case Ltk_reveal
                    solve( KU((#vf.42, 0), MAC(KDF(<~m1.13, adec(c2.71, ~lkI.70), $I.10, 
                                                    $R.11, aenc(~m1.13, pk(~ltkA.32)), c2.71>),
                                               <'Resp', $R.11, $I.10, c2.71, aenc(~m1.13, pk(~ltkA.32))>)) )
                      case cMAC
                      by contradiction // cyclic
                    qed
                  qed
                qed
              qed
            next
              case split_case_2
              solve( (#i2.1, 0)[!KU( f_.8,
                                     KDF(<~m1.13, z.71, $I.10, $R.11, aenc(~m1.13, pk(~ltkA.32)), 
                                          aenc(z.71, pk(~lkI.70))>)
                                )] /* may loop */ )
                case Sessk_reveal_case_1
                by contradiction // from formulas
              next
                case Sessk_reveal_case_2
                by contradiction // from formulas
              next
                case cKDF
                solve( KU((#vr.75, 0), ~m1.13) )
                  case Ephk_reveal
                  by contradiction // from formulas
                next
                  case Init_1
                  solve( (#vr.104, 1)[!KU( f_.109, ~ltkA.32 )] /* may loop */ )
                    case Ltk_reveal
                    solve( KU((#vf.42, 0), MAC(KDF(<~m1.13, z.71, $I.10, $R.11, 
                                                    aenc(~m1.13, pk(~ltkA.32)), aenc(z.71, pk(~lkI.70))>),
                                               <'Resp', $R.11, $I.10, aenc(z.71, pk(~lkI.70)), 
                                                aenc(~m1.13, pk(~ltkA.32))>)) )
                      case Resp_1
                      solve( KU((#vr.75, 0), ~m2.157) )
                        case Ephk_reveal
                        by contradiction // from formulas
                      next
                        case Resp_1
                        solve( (#vr.218, 1)[!KU( f_.223, ~lkI.70 )] /* may loop */ )
                          case Ltk_reveal
                          by contradiction // from formulas
                        qed
                      qed
                    next
                      case cMAC
                      by contradiction // cyclic
                    qed
                  qed
                qed
              qed
            qed
          qed
        next
          case Resp_2
          by solve( (#i3.2, 0)[Resp_1( ~m1.13, $I.35, $R.36, ~lkR.37, m1.41,
                                       ~m1.13, c1.39, c2.40
                               )] )
        qed
      qed
    qed
  next
    case Init_2
    solve( (#i1, 0)[Init_1( ~m1.13, $I.10, $R.11, ~lkI.12, ~m1.13, c1.14 )] )
      case Init_1
      solve( Accept( ~m1.13, k.7 ) @ #i3.2 )
        case Init_2
        solve( (#i3.2, 0)[Init_1( ~m1.13, $I.46, $R.47, ~lkI.48, ~m1.13, c1.50
                          )] )
          case Init_1
          solve( splitEqs(1) )
            case split_case_1
            solve( (#i2.1, 0)[!KU( f_.8,
                                   KDF(<~m1.13, adec(c2.82, ~lkI.81), $I.10, $R.11, 
                                        aenc(~m1.13, pk(~ltkA.43)), c2.82>)
                              )] /* may loop */ )
              case Sessk_reveal
              by contradiction // from formulas
            next
              case cKDF
              solve( KU((#vr.86, 0), ~m1.13) )
                case Ephk_reveal
                by contradiction // from formulas
              next
                case Init_1
                solve( (#vr.115, 1)[!KU( f_.120, ~ltkA.43 )] /* may loop */ )
                  case Ltk_reveal
                  solve( KU((#vf.17, 0), MAC(KDF(<~m1.13, adec(c2.82, ~lkI.81), $I.10, 
                                                  $R.11, aenc(~m1.13, pk(~ltkA.43)), c2.82>),
                                             <'Resp', $R.11, $I.10, c2.82, aenc(~m1.13, pk(~ltkA.43))>)) )
                    case cMAC
                    by contradiction // cyclic
                  qed
                qed
              qed
            qed
          next
            case split_case_2
            solve( (#i2.1, 0)[!KU( f_.8,
                                   KDF(<~m1.13, z.82, $I.10, $R.11, aenc(~m1.13, pk(~ltkA.43)), 
                                        aenc(z.82, pk(~lkI.81))>)
                              )] /* may loop */ )
              case Sessk_reveal_case_1
              by contradiction // from formulas
            next
              case Sessk_reveal_case_2
              by contradiction // from formulas
            next
              case cKDF
              solve( KU((#vr.86, 0), ~m1.13) )
                case Ephk_reveal
                by contradiction // from formulas
              next
                case Init_1
                solve( (#vr.115, 1)[!KU( f_.120, ~ltkA.43 )] /* may loop */ )
                  case Ltk_reveal
                  solve( KU((#vf.17, 0), MAC(KDF(<~m1.13, z.82, $I.10, $R.11, 
                                                  aenc(~m1.13, pk(~ltkA.43)), aenc(z.82, pk(~lkI.81))>),
                                             <'Resp', $R.11, $I.10, aenc(z.82, pk(~lkI.81)), 
                                              aenc(~m1.13, pk(~ltkA.43))>)) )
                    case Resp_1
                    solve( KU((#vr.86, 0), ~m2.168) )
                      case Ephk_reveal
                      by contradiction // from formulas
                    next
                      case Resp_1
                      solve( (#vr.229, 1)[!KU( f_.234, ~lkI.81 )] /* may loop */ )
                        case Ltk_reveal
                        by contradiction // from formulas
                      qed
                    qed
                  next
                    case cMAC
                    by contradiction // cyclic
                  qed
                qed
              qed
            qed
          qed
        qed
      next
        case Resp_2
        by solve( (#i3.2, 0)[Resp_1( ~m1.13, $I.46, $R.47, ~lkR.48, m1.52,
                                     ~m1.13, c1.50, c2.51
                             )] )
      qed
    qed
  next
    case Resp_1
    solve( (#i1, 2)[!Ltk( $R.11, ~lkR.12 )] )
      case Register_pk
      solve( (#i1, 3)[!Pk( $I.10, pkI.15 )] )
        case Register_pk
        solve( Accept( ~m2.13, k.7 ) @ #i3.2 )
          case Init_2
          by solve( (#i3.2, 0)[Init_1( ~m2.13, $I.39, $R.40, ~lkI.41, ~m2.13, c1.43
                               )] )
        next
          case Resp_2
          solve( (#i3.2, 0)[Resp_1( ~m2.13, $I.39, $R.40, ~lkR.41, m1.45, ~m2.13,
                                    c1.43, c2.44
                            )] )
            case Resp_1
            solve( splitEqs(1) )
              case split_case_1
              solve( (#i2.1, 0)[!KU( f_.8,
                                     KDF(<adec(c1.81, ~lkR.80), ~m2.13, $I.10, $R.11, c1.81, 
                                          aenc(~m2.13, pk(~ltkA.36))>)
                                )] /* may loop */ )
                case Sessk_reveal
                by contradiction // from formulas
              next
                case cKDF
                solve( KU((#vr.85, 0), ~m2.13) )
                  case Ephk_reveal
                  by contradiction // from formulas
                next
                  case Resp_1
                  solve( (#vr.124, 1)[!KU( f_.129, ~ltkA.36 )] /* may loop */ )
                    case Ltk_reveal
                    solve( (#vf.46, 0)[!KU( f_.47,
                                            MAC(KDF(<adec(c1.81, ~lkR.80), ~m2.13, $I.10, $R.11, c1.81, 
                                                     aenc(~m2.13, pk(~ltkA.36))>),
                                                <'Init', $I.10, $R.11, c1.81, aenc(~m2.13, pk(~ltkA.36))>)
                                       )] /* may loop */ )
                      case cMAC
                      by contradiction // cyclic
                    qed
                  qed
                qed
              qed
            next
              case split_case_2
              solve( (#i2.1, 0)[!KU( f_.8,
                                     KDF(<z.81, ~m2.13, $I.10, $R.11, aenc(z.81, pk(~lkR.80)), 
                                          aenc(~m2.13, pk(~ltkA.36))>)
                                )] /* may loop */ )
                case Sessk_reveal_case_1
                by contradiction // from formulas
              next
                case Sessk_reveal_case_2
                by contradiction // from formulas
              next
                case cKDF
                solve( KU((#vr.85, 0), ~m2.13) )
                  case Ephk_reveal
                  by contradiction // from formulas
                next
                  case Resp_1
                  solve( (#vr.124, 1)[!KU( f_.129, ~ltkA.36 )] /* may loop */ )
                    case Ltk_reveal
                    solve( (#vf.17, 0)[!KU( f_.18, aenc(z.81, pk(~lkR.80))
                                       )] /* may loop */ )
                      case Init_1
                      solve( KU((#vr.85, 0), ~m1.167) )
                        case Ephk_reveal
                        solve( (#vf.46, 0)[!KU( f_.47,
                                                MAC(KDF(<~m1.167, ~m2.13, $I.10, $R.11, 
                                                         aenc(~m1.167, pk(~lkR.80)), 
                                                         aenc(~m2.13, pk(~ltkA.36))>),
                                                    <'Init', $I.10, $R.11, aenc(~m1.167, pk(~lkR.80)), 
                                                     aenc(~m2.13, pk(~ltkA.36))>)
                                           )] /* may loop */ )
                          case Init_2
                          by contradiction // from formulas
                        next
                          case cMAC
                          by contradiction // cyclic
                        qed
                      next
                        case Init_1
                        solve( (#vr.206, 1)[!KU( f_.211, ~lkR.80 )] /* may loop */ )
                          case Ltk_reveal
                          solve( (#vf.46, 0)[!KU( f_.47,
                                                  MAC(KDF(<~m1.167, ~m2.13, $I.10, $R.11, 
                                                           aenc(~m1.167, pk(~lkR.80)), 
                                                           aenc(~m2.13, pk(~ltkA.36))>),
                                                      <'Init', $I.10, $R.11, aenc(~m1.167, pk(~lkR.80)), 
                                                       aenc(~m2.13, pk(~ltkA.36))>)
                                             )] /* may loop */ )
                            case Init_2
                            by contradiction // from formulas
                          next
                            case cMAC
                            by contradiction // cyclic
                          qed
                        qed
                      qed
                    next
                      case Resp_1
                      solve( KU((#vr.85, 0), ~m2.167) )
                        case Ephk_reveal
                        solve( splitEqs(1) )
                          case split_case_1
                          solve( (#vf.46, 0)[!KU( f_.47,
                                                  MAC(KDF(<~m2.167, ~m2.13, $I.10, $R.11, 
                                                           aenc(~m2.167, pk(~lkR.80)), 
                                                           aenc(~m2.13, pk(~ltkA.36))>),
                                                      <'Init', $I.10, $R.11, aenc(~m2.167, pk(~lkR.80)), 
                                                       aenc(~m2.13, pk(~ltkA.36))>)
                                             )] /* may loop */ )
                            case cMAC
                            by contradiction // cyclic
                          qed
                        next
                          case split_case_2
                          solve( (#vf.46, 0)[!KU( f_.47,
                                                  MAC(KDF(<~m2.167, ~m2.13, $I.10, $R.11, 
                                                           aenc(~m2.167, pk(~lkR.80)), 
                                                           aenc(~m2.13, pk(~ltkA.36))>),
                                                      <'Init', $I.10, $R.11, aenc(~m2.167, pk(~lkR.80)), 
                                                       aenc(~m2.13, pk(~ltkA.36))>)
                                             )] /* may loop */ )
                            case cMAC
                            by contradiction // cyclic
                          qed
                        qed
                      next
                        case Resp_1
                        solve( (#vr.226, 1)[!KU( f_.231, ~lkR.80 )] /* may loop */ )
                          case Ltk_reveal
                          solve( splitEqs(1) )
                            case split_case_1
                            solve( (#vf.46, 0)[!KU( f_.47,
                                                    MAC(KDF(<~m2.167, ~m2.13, $I.10, $R.11, 
                                                             aenc(~m2.167, pk(~lkR.80)), 
                                                             aenc(~m2.13, pk(~ltkA.36))>),
                                                        <'Init', $I.10, $R.11, aenc(~m2.167, pk(~lkR.80)), 
                                                         aenc(~m2.13, pk(~ltkA.36))>)
                                               )] /* may loop */ )
                              case cMAC
                              by contradiction // cyclic
                            qed
                          next
                            case split_case_2
                            solve( (#vf.46, 0)[!KU( f_.47,
                                                    MAC(KDF(<~m2.167, ~m2.13, $I.10, $R.11, 
                                                             aenc(~m2.167, pk(~lkR.80)), 
                                                             aenc(~m2.13, pk(~ltkA.36))>),
                                                        <'Init', $I.10, $R.11, aenc(~m2.167, pk(~lkR.80)), 
                                                         aenc(~m2.13, pk(~ltkA.36))>)
                                               )] /* may loop */ )
                              case cMAC
                              by contradiction // cyclic
                            qed
                          qed
                        qed
                      qed
                    next
                      case caenc
                      solve( (#vf.46, 0)[!KU( f_.47,
                                              MAC(KDF(<z.81, ~m2.13, $I.10, $R.11, aenc(z.81, pk(~lkR.80)), 
                                                       aenc(~m2.13, pk(~ltkA.36))>),
                                                  <'Init', $I.10, $R.11, aenc(z.81, pk(~lkR.80)), 
                                                   aenc(~m2.13, pk(~ltkA.36))>)
                                         )] /* may loop */ )
                        case Init_2
                        solve( KU((#vr.85, 0), ~m1.176) )
                          case Ephk_reveal
                          by contradiction // from formulas
                        qed
                      next
                        case cMAC
                        by contradiction // cyclic
                      qed
                    qed
                  qed
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

/* All well-formedness checks were successful. */

end